{"version":3,"sources":["../../../../../src/lib/waku_relay/index.ts","messages.ts","../../../../../../src/proto/waku/v2/message.ts","App.tsx","crypto.ts","../../../../src/lib/waku_message.ts","../../../../../src/lib/waku_relay/constants.ts","../../../../../src/lib/waku_light_push/index.ts","../../../../../../src/proto/waku/v2/light_push.ts","../../../../src/lib/select_peer.ts","../../../../../src/lib/waku_relay/get_relay_peers.ts","../../../../../src/lib/waku_store/index.ts","../../../../../../src/proto/waku/v2/store.ts","../../../../../../src/proto/chat/v2/chat_message.ts","Messages.tsx","SendMessage.tsx","index.tsx","../../../../src/lib/discover.ts","../../../../src/lib/waku.ts","../../../../../src/lib/waku_relay/relay_heartbeat.ts","../../../../../src/lib/waku_light_push/push_rpc.ts","../../../../../src/lib/waku_store/history_rpc.ts","../../../../../src/lib/chat_message/index.ts","../../../../src/proto/index.ts","../../../src/index.ts"],"names":["encode","msg","jsonStr","JSON","stringify","Buffer","from","decode","bytes","str","toString","parse","message","global","PublicKeyContentTopic","DirectMessageContentTopic","a","Waku","create","waku","getNodes","nodes","Promise","all","map","addr","dial","process","NODE_ENV","getStatusFleetNodes","Environment","Test","Prod","encodePublicKeyWakuMessage","ethDmMsg","payload","WakuMessage","fromBytes","handlePublicKeyMessage","setter","publicKeyMsg","res","validatePublicKeyMessage","console","log","prevPks","set","ethAddress","ethDmPublicKey","Map","handleDirectMessage","privateKey","wakuMsg","directMessage","EthCrypto","encMessage","text","timestamp","Date","prevMsgs","copy","slice","push","App","useState","setWaku","provider","setProvider","ethDmKeyPair","setEthDmKeyPair","setPublicKeyMsg","publicKeys","setPublicKeys","messages","setMessages","useEffect","window","ethereum","enable","_provider","ethers","providers","Web3Provider","e","error","initWaku","then","wakuNode","catch","observerPublicKeyMessage","bind","observerDirectMessage","undefined","relay","addObserver","deleteObserver","wakuReady","className","style","display","alignItems","flexWrap","variant","color","onClick","generateEthDmKeyPair","getSigner","keyPair","disabled","lightPush","createPublicKeyMessage","publicKey","recipients","Salt","web3Signer","signMessage","signature","sigBuf","entropy","concat","keys","getAddress","formatPublicKeyForSignature","sig","utils","verifyMessage","exports","writer","i","globalThis","Messages","props","toLocaleString","month","day","hour","minute","hour12","useStyles","makeStyles","theme","formControl","margin","spacing","minWidth","selectEmpty","marginTop","SendMessage","classes","recipient","setRecipient","setMessage","items","Array","value","keyDownHandler","event","key","altKey","ctrlKey","shiftKey","get","sendMessage","id","labelId","onChange","target","label","onKeyDown","address","encryptedMsg","directMsg","toAddress","recipientAddress","recipientPublicKey","callback","encodeEncryptedWakuMessage","isSuccess","ReactDOM","render","StrictMode","document","getElementById","gossipsub","outbound"],"mappings":"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","file":"static/js/main.818af64d.chunk.js","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WakuRelay = exports.DefaultPubsubTopic = exports.RelayCodec = void 0;\nconst libp2p_gossipsub_1 = __importDefault(require(\"libp2p-gossipsub\"));\nconst utils_1 = require(\"libp2p-gossipsub/src/utils\");\nconst signature_policy_1 = require(\"libp2p-interfaces/src/pubsub/signature-policy\");\nconst peer_id_1 = __importDefault(require(\"peer-id\"));\nconst waku_message_1 = require(\"../waku_message\");\nconst constants = __importStar(require(\"./constants\"));\nconst constants_1 = require(\"./constants\");\nObject.defineProperty(exports, \"DefaultPubsubTopic\", { enumerable: true, get: function () { return constants_1.DefaultPubsubTopic; } });\nObject.defineProperty(exports, \"RelayCodec\", { enumerable: true, get: function () { return constants_1.RelayCodec; } });\nconst get_relay_peers_1 = require(\"./get_relay_peers\");\nconst relay_heartbeat_1 = require(\"./relay_heartbeat\");\n/**\n * Implements the [Waku v2 Relay protocol]{@link https://rfc.vac.dev/spec/11/}.\n * Must be passed as a `pubsub` module to a {Libp2p} instance.\n *\n * @implements {Pubsub}\n * @noInheritDoc\n */\nclass WakuRelay extends libp2p_gossipsub_1.default {\n    constructor(libp2p, options) {\n        super(libp2p, Object.assign(options, {\n            // Ensure that no signature is included nor expected in the messages.\n            globalSignaturePolicy: signature_policy_1.SignaturePolicy.StrictNoSign,\n        }));\n        this.heartbeat = new relay_heartbeat_1.RelayHeartbeat(this);\n        this.observers = {};\n        const multicodecs = [constants.RelayCodec];\n        Object.assign(this, { multicodecs });\n        if (options === null || options === void 0 ? void 0 : options.pubsubTopic) {\n            this.pubsubTopic = options.pubsubTopic;\n        }\n        else {\n            this.pubsubTopic = constants.DefaultPubsubTopic;\n        }\n    }\n    /**\n     * Mounts the gossipsub protocol onto the libp2p node\n     * and subscribes to the default topic.\n     *\n     * @override\n     * @returns {void}\n     */\n    start() {\n        super.start();\n        this.subscribe(this.pubsubTopic);\n    }\n    /**\n     * Send Waku message.\n     *\n     * @param {WakuMessage} message\n     * @returns {Promise<void>}\n     */\n    async send(message) {\n        const msg = message.encode();\n        await super.publish(this.pubsubTopic, Buffer.from(msg));\n    }\n    /**\n     * Register an observer of new messages received via waku relay\n     *\n     * @param callback called when a new message is received via waku relay\n     * @param contentTopics Content Topics for which the callback with be called,\n     * all of them if undefined, [] or [\"\",..] is passed.\n     * @returns {void}\n     */\n    addObserver(callback, contentTopics = []) {\n        if (contentTopics.length === 0) {\n            if (!this.observers['']) {\n                this.observers[''] = new Set();\n            }\n            this.observers[''].add(callback);\n        }\n        else {\n            contentTopics.forEach((contentTopic) => {\n                if (!this.observers[contentTopic]) {\n                    this.observers[contentTopic] = new Set();\n                }\n                this.observers[contentTopic].add(callback);\n            });\n        }\n    }\n    /**\n     * Remove an observer of new messages received via waku relay.\n     * Useful to ensure the same observer is not registered several time\n     * (e.g when loading React components)\n     */\n    deleteObserver(callback, contentTopics = []) {\n        if (contentTopics.length === 0) {\n            if (this.observers['']) {\n                this.observers[''].delete(callback);\n            }\n        }\n        else {\n            contentTopics.forEach((contentTopic) => {\n                if (this.observers[contentTopic]) {\n                    this.observers[contentTopic].delete(callback);\n                }\n            });\n        }\n    }\n    /**\n     * Return the relay peers we are connected to and we would publish a message to\n     */\n    getPeers() {\n        return get_relay_peers_1.getRelayPeers(this, this.pubsubTopic, this._options.D, (id) => {\n            // Filter peers we would not publish to\n            return (this.score.score(id) >= this._options.scoreThresholds.publishThreshold);\n        });\n    }\n    /**\n     * Subscribe to a pubsub topic and start emitting Waku messages to observers.\n     *\n     * @override\n     */\n    subscribe(pubsubTopic) {\n        this.on(pubsubTopic, (event) => {\n            const wakuMsg = waku_message_1.WakuMessage.decode(event.data);\n            if (this.observers['']) {\n                this.observers[''].forEach((callbackFn) => {\n                    callbackFn(wakuMsg);\n                });\n            }\n            if (wakuMsg.contentTopic) {\n                if (this.observers[wakuMsg.contentTopic]) {\n                    this.observers[wakuMsg.contentTopic].forEach((callbackFn) => {\n                        callbackFn(wakuMsg);\n                    });\n                }\n            }\n        });\n        super.subscribe(pubsubTopic);\n    }\n    /**\n     * Join pubsub topic.\n     * This is present to override the behavior of Gossipsub and should not\n     * be used by API Consumers\n     *\n     * @internal\n     * @param {string} topic\n     * @returns {void}\n     * @override\n     */\n    join(topic) {\n        var _a;\n        if (!this.started) {\n            throw new Error('WakuRelayPubsub has not started');\n        }\n        const fanoutPeers = this.fanout.get(topic);\n        if (fanoutPeers) {\n            // these peers have a score above the publish threshold, which may be negative\n            // so drop the ones with a negative score\n            fanoutPeers.forEach((id) => {\n                if (this.score.score(id) < 0) {\n                    fanoutPeers.delete(id);\n                }\n            });\n            if (fanoutPeers.size < this._options.D) {\n                // we need more peers; eager, as this would get fixed in the next heartbeat\n                get_relay_peers_1.getRelayPeers(this, topic, this._options.D - fanoutPeers.size, (id) => {\n                    // filter our current peers, direct peers, and peers with negative scores\n                    return (!fanoutPeers.has(id) &&\n                        !this.direct.has(id) &&\n                        this.score.score(id) >= 0);\n                }).forEach((id) => fanoutPeers.add(id));\n            }\n            this.mesh.set(topic, fanoutPeers);\n            this.fanout.delete(topic);\n            this.lastpub.delete(topic);\n        }\n        else {\n            const peers = get_relay_peers_1.getRelayPeers(this, topic, this._options.D, (id) => {\n                // filter direct peers and peers with negative score\n                return !this.direct.has(id) && this.score.score(id) >= 0;\n            });\n            this.mesh.set(topic, peers);\n        }\n        (_a = this.mesh.get(topic)) === null || _a === void 0 ? void 0 : _a.forEach((id) => {\n            this.log('JOIN: Add mesh link to %s in %s', id, topic);\n            this._sendGraft(id, topic);\n        });\n    }\n    /**\n     * Publish messages.\n     * This is present to override the behavior of Gossipsub and should not\n     * be used by API Consumers\n     *\n     * @ignore\n     * @override\n     * @param {InMessage} msg\n     * @returns {void}\n     */\n    async _publish(msg) {\n        if (msg.receivedFrom !== this.peerId.toB58String()) {\n            this.score.deliverMessage(msg);\n            this.gossipTracer.deliverMessage(msg);\n        }\n        const msgID = this.getMsgId(msg);\n        const msgIdStr = utils_1.messageIdToString(msgID);\n        // put in seen cache\n        this.seenCache.put(msgIdStr);\n        this.messageCache.put(msg);\n        const toSend = new Set();\n        msg.topicIDs.forEach((topic) => {\n            const peersInTopic = this.topics.get(topic);\n            if (!peersInTopic) {\n                return;\n            }\n            // direct peers\n            this.direct.forEach((id) => {\n                toSend.add(id);\n            });\n            let meshPeers = this.mesh.get(topic);\n            if (!meshPeers || !meshPeers.size) {\n                // We are not in the mesh for topic, use fanout peers\n                meshPeers = this.fanout.get(topic);\n                if (!meshPeers) {\n                    // If we are not in the fanout, then pick peers in topic above the publishThreshold\n                    const peers = get_relay_peers_1.getRelayPeers(this, topic, this._options.D, (id) => {\n                        return (this.score.score(id) >=\n                            this._options.scoreThresholds.publishThreshold);\n                    });\n                    if (peers.size > 0) {\n                        meshPeers = peers;\n                        this.fanout.set(topic, peers);\n                    }\n                    else {\n                        meshPeers = new Set();\n                    }\n                }\n                // Store the latest publishing time\n                this.lastpub.set(topic, this._now());\n            }\n            meshPeers === null || meshPeers === void 0 ? void 0 : meshPeers.forEach((peer) => {\n                toSend.add(peer);\n            });\n        });\n        // Publish messages to peers\n        const rpc = utils_1.createGossipRpc([libp2p_gossipsub_1.default.utils.normalizeOutRpcMessage(msg)]);\n        toSend.forEach((id) => {\n            if (id === msg.from) {\n                return;\n            }\n            this._sendRpc(id, rpc);\n        });\n    }\n    /**\n     * Emits gossip to peers in a particular topic.\n     *\n     * This is present to override the behavior of Gossipsub and should not\n     * be used by API Consumers\n     *\n     * @ignore\n     * @override\n     * @param {string} topic\n     * @param {Set<string>} exclude peers to exclude\n     * @returns {void}\n     */\n    _emitGossip(topic, exclude) {\n        const messageIDs = this.messageCache.getGossipIDs(topic);\n        if (!messageIDs.length) {\n            return;\n        }\n        // shuffle to emit in random order\n        utils_1.shuffle(messageIDs);\n        // if we are emitting more than GossipsubMaxIHaveLength ids, truncate the list\n        if (messageIDs.length > constants.RelayMaxIHaveLength) {\n            // we do the truncation (with shuffling) per peer below\n            this.log('too many messages for gossip; will truncate IHAVE list (%d messages)', messageIDs.length);\n        }\n        // Send gossip to GossipFactor peers above threshold with a minimum of D_lazy\n        // First we collect the peers above gossipThreshold that are not in the exclude set\n        // and then randomly select from that set\n        // We also exclude direct peers, as there is no reason to emit gossip to them\n        const peersToGossip = [];\n        const topicPeers = this.topics.get(topic);\n        if (!topicPeers) {\n            // no topic peers, no gossip\n            return;\n        }\n        topicPeers.forEach((id) => {\n            const peerStreams = this.peers.get(id);\n            if (!peerStreams) {\n                return;\n            }\n            if (!exclude.has(id) &&\n                !this.direct.has(id) &&\n                peerStreams.protocol == constants.RelayCodec &&\n                this.score.score(id) >= this._options.scoreThresholds.gossipThreshold) {\n                peersToGossip.push(id);\n            }\n        });\n        let target = this._options.Dlazy;\n        const factor = constants.RelayGossipFactor * peersToGossip.length;\n        if (factor > target) {\n            target = factor;\n        }\n        if (target > peersToGossip.length) {\n            target = peersToGossip.length;\n        }\n        else {\n            utils_1.shuffle(peersToGossip);\n        }\n        // Emit the IHAVE gossip to the selected peers up to the target\n        peersToGossip.slice(0, target).forEach((id) => {\n            let peerMessageIDs = messageIDs;\n            if (messageIDs.length > constants.RelayMaxIHaveLength) {\n                // shuffle and slice message IDs per peer so that we emit a different set for each peer\n                // we have enough redundancy in the system that this will significantly increase the message\n                // coverage when we do truncate\n                peerMessageIDs = utils_1.shuffle(peerMessageIDs.slice()).slice(0, constants.RelayMaxIHaveLength);\n            }\n            this._pushGossip(id, {\n                topicID: topic,\n                messageIDs: peerMessageIDs,\n            });\n        });\n    }\n    /**\n     * Make a PRUNE control message for a peer in a topic.\n     * This is present to override the behavior of Gossipsub and should not\n     * be used by API Consumers\n     *\n     * @ignore\n     * @override\n     * @param {string} id\n     * @param {string} topic\n     * @param {boolean} doPX\n     * @returns {RPC.IControlPrune}\n     */\n    _makePrune(id, topic, doPX) {\n        // backoff is measured in seconds\n        // RelayPruneBackoff is measured in milliseconds\n        const backoff = constants.RelayPruneBackoff / 1000;\n        const px = [];\n        if (doPX) {\n            // select peers for Peer eXchange\n            const peers = get_relay_peers_1.getRelayPeers(this, topic, constants.RelayPrunePeers, (xid) => {\n                return xid !== id && this.score.score(xid) >= 0;\n            });\n            peers.forEach((p) => {\n                // see if we have a signed record to send back; if we don't, just send\n                // the peer ID and let the pruned peer find them in the DHT -- we can't trust\n                // unsigned address records through PX anyways\n                // Finding signed records in the DHT is not supported at the time of writing in js-libp2p\n                const peerId = peer_id_1.default.createFromB58String(p);\n                px.push({\n                    peerID: peerId.toBytes(),\n                    signedPeerRecord: this._libp2p.peerStore.addressBook.getRawEnvelope(peerId),\n                });\n            });\n        }\n        return {\n            topicID: topic,\n            peers: px,\n            backoff: backoff,\n        };\n    }\n}\nexports.WakuRelay = WakuRelay;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL3dha3VfcmVsYXkvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUNBLHdFQUF5QztBQVF6QyxzREFJb0M7QUFFcEMsb0ZBQWdGO0FBQ2hGLHNEQUE2QjtBQUc3QixrREFBOEM7QUFFOUMsdURBQXlDO0FBQ3pDLDJDQUE2RDtBQUl4QyxtR0FKWiw4QkFBa0IsT0FJWTtBQUE5QiwyRkFKb0Isc0JBQVUsT0FJcEI7QUFIbkIsdURBQWtEO0FBQ2xELHVEQUFtRDtBQTRCbkQ7Ozs7OztHQU1HO0FBQ0gsTUFBYSxTQUFVLFNBQVEsMEJBQVM7SUFXdEMsWUFDRSxNQUFjLEVBQ2QsT0FBZ0Q7UUFFaEQsS0FBSyxDQUNILE1BQU0sRUFDTixNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRTtZQUNyQixxRUFBcUU7WUFDckUscUJBQXFCLEVBQUUsa0NBQWUsQ0FBQyxZQUFZO1NBQ3BELENBQUMsQ0FDSCxDQUFDO1FBRUYsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLGdDQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7UUFFcEIsTUFBTSxXQUFXLEdBQUcsQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFM0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsRUFBRSxXQUFXLEVBQUUsQ0FBQyxDQUFDO1FBRXJDLElBQUksT0FBTyxhQUFQLE9BQU8sdUJBQVAsT0FBTyxDQUFFLFdBQVcsRUFBRTtZQUN4QixJQUFJLENBQUMsV0FBVyxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUM7U0FDeEM7YUFBTTtZQUNMLElBQUksQ0FBQyxXQUFXLEdBQUcsU0FBUyxDQUFDLGtCQUFrQixDQUFDO1NBQ2pEO0lBQ0gsQ0FBQztJQUVEOzs7Ozs7T0FNRztJ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","import * as EthCrypto from 'eth-crypto';\n\n/**\n * Message used to communicate the Eth-Dm public key linked to a given Ethereum account\n */\nexport interface PublicKeyMessage {\n  ethDmPublicKey: string;\n  ethAddress: string;\n  sig: string;\n}\n\n/**\n * Direct Encrypted Message used for private communication over the Waku network.\n */\nexport interface DirectMessage {\n  toAddress: string;\n  encMessage: EthCrypto.Encrypted;\n}\n\nexport function encode<T>(msg: T): Buffer {\n  const jsonStr = JSON.stringify(msg);\n  return Buffer.from(jsonStr, 'utf-8');\n}\n\nexport function decode<T>(bytes: Uint8Array): T {\n  const buf = Buffer.from(bytes);\n  const str = buf.toString('utf-8');\n  return JSON.parse(str);\n}\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WakuMessage = exports.protobufPackage = void 0;\n/* eslint-disable */\nconst long_1 = __importDefault(require(\"long\"));\nconst minimal_1 = __importDefault(require(\"protobufjs/minimal\"));\nexports.protobufPackage = 'waku.v2';\nconst baseWakuMessage = {};\nexports.WakuMessage = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        if (message.payload !== undefined) {\n            writer.uint32(10).bytes(message.payload);\n        }\n        if (message.contentTopic !== undefined) {\n            writer.uint32(18).string(message.contentTopic);\n        }\n        if (message.version !== undefined) {\n            writer.uint32(24).uint32(message.version);\n        }\n        if (message.timestamp !== undefined) {\n            writer.uint32(33).double(message.timestamp);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, baseWakuMessage);\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.payload = reader.bytes();\n                    break;\n                case 2:\n                    message.contentTopic = reader.string();\n                    break;\n                case 3:\n                    message.version = reader.uint32();\n                    break;\n                case 4:\n                    message.timestamp = reader.double();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, baseWakuMessage);\n        if (object.payload !== undefined && object.payload !== null) {\n            message.payload = bytesFromBase64(object.payload);\n        }\n        if (object.contentTopic !== undefined && object.contentTopic !== null) {\n            message.contentTopic = String(object.contentTopic);\n        }\n        else {\n            message.contentTopic = undefined;\n        }\n        if (object.version !== undefined && object.version !== null) {\n            message.version = Number(object.version);\n        }\n        else {\n            message.version = undefined;\n        }\n        if (object.timestamp !== undefined && object.timestamp !== null) {\n            message.timestamp = Number(object.timestamp);\n        }\n        else {\n            message.timestamp = undefined;\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.payload !== undefined &&\n            (obj.payload =\n                message.payload !== undefined\n                    ? base64FromBytes(message.payload)\n                    : undefined);\n        message.contentTopic !== undefined &&\n            (obj.contentTopic = message.contentTopic);\n        message.version !== undefined && (obj.version = message.version);\n        message.timestamp !== undefined && (obj.timestamp = message.timestamp);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, baseWakuMessage);\n        if (object.payload !== undefined && object.payload !== null) {\n            message.payload = object.payload;\n        }\n        else {\n            message.payload = undefined;\n        }\n        if (object.contentTopic !== undefined && object.contentTopic !== null) {\n            message.contentTopic = object.contentTopic;\n        }\n        else {\n            message.contentTopic = undefined;\n        }\n        if (object.version !== undefined && object.version !== null) {\n            message.version = object.version;\n        }\n        else {\n            message.version = undefined;\n        }\n        if (object.timestamp !== undefined && object.timestamp !== null) {\n            message.timestamp = object.timestamp;\n        }\n        else {\n            message.timestamp = undefined;\n        }\n        return message;\n    },\n};\nvar globalThis = (() => {\n    if (typeof globalThis !== 'undefined')\n        return globalThis;\n    if (typeof self !== 'undefined')\n        return self;\n    if (typeof window !== 'undefined')\n        return window;\n    if (typeof global !== 'undefined')\n        return global;\n    throw 'Unable to locate global object';\n})();\nconst atob = globalThis.atob ||\n    ((b64) => globalThis.Buffer.from(b64, 'base64').toString('binary'));\nfunction bytesFromBase64(b64) {\n    const bin = atob(b64);\n    const arr = new Uint8Array(bin.length);\n    for (let i = 0; i < bin.length; ++i) {\n        arr[i] = bin.charCodeAt(i);\n    }\n    return arr;\n}\nconst btoa = globalThis.btoa ||\n    ((bin) => globalThis.Buffer.from(bin, 'binary').toString('base64'));\nfunction base64FromBytes(arr) {\n    const bin = [];\n    for (const byte of arr) {\n        bin.push(String.fromCharCode(byte));\n    }\n    return btoa(bin.join(''));\n}\nif (minimal_1.default.util.Long !== long_1.default) {\n    minimal_1.default.util.Long = long_1.default;\n    minimal_1.default.configure();\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9wcm90by93YWt1L3YyL21lc3NhZ2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsb0JBQW9CO0FBQ3BCLGdEQUF3QjtBQUN4QixpRUFBcUM7QUFFeEIsUUFBQSxlQUFlLEdBQUcsU0FBUyxDQUFDO0FBU3pDLE1BQU0sZUFBZSxHQUFXLEVBQUUsQ0FBQztBQUV0QixRQUFBLFdBQVcsR0FBRztJQUN6QixNQUFNLENBQ0osT0FBb0IsRUFDcEIsU0FBcUIsaUJBQUcsQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFO1FBRXhDLElBQUksT0FBTyxDQUFDLE9BQU8sS0FBSyxTQUFTLEVBQUU7WUFDakMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzFDO1FBQ0QsSUFBSSxPQUFPLENBQUMsWUFBWSxLQUFLLFNBQVMsRUFBRTtZQUN0QyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUM7U0FDaEQ7UUFDRCxJQUFJLE9BQU8sQ0FBQyxPQUFPLEtBQUssU0FBUyxFQUFFO1lBQ2pDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUMzQztRQUNELElBQUksT0FBTyxDQUFDLFNBQVMsS0FBSyxTQUFTLEVBQUU7WUFDbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1NBQzdDO1FBQ0QsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztJQUVELE1BQU0sQ0FBQyxLQUE4QixFQUFFLE1BQWU7UUFDcEQsTUFBTSxNQUFNLEdBQUcsS0FBSyxZ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","import '@ethersproject/shims';\n\nimport React, { Dispatch, SetStateAction, useEffect, useState } from 'react';\nimport './App.css';\nimport { Environment, getStatusFleetNodes, Waku, WakuMessage } from 'js-waku';\nimport { ethers } from 'ethers';\nimport { Web3Provider } from '@ethersproject/providers';\nimport {\n  createPublicKeyMessage,\n  generateEthDmKeyPair,\n  KeyPair,\n  validatePublicKeyMessage,\n} from './crypto';\nimport * as EthCrypto from 'eth-crypto';\nimport { decode, DirectMessage, encode, PublicKeyMessage } from './messages';\nimport { Message, Messages } from './Messages';\nimport 'fontsource-roboto';\nimport { Button } from '@material-ui/core';\nimport { SendMessage } from './SendMessage';\n\nexport const PublicKeyContentTopic = '/eth-dm/1/public-key/json';\nexport const DirectMessageContentTopic = '/eth-dm/1/direct-message/json';\n\ndeclare let window: any;\n\nfunction App() {\n  const [waku, setWaku] = useState<Waku>();\n  const [provider, setProvider] = useState<Web3Provider>();\n  const [ethDmKeyPair, setEthDmKeyPair] = useState<KeyPair>();\n  const [publicKeyMsg, setPublicKeyMsg] = useState<PublicKeyMessage>();\n  const [publicKeys, setPublicKeys] = useState<Map<string, string>>(new Map());\n  const [messages, setMessages] = useState<Message[]>([]);\n\n  useEffect(() => {\n    if (provider) return;\n    try {\n      window.ethereum.enable();\n      const _provider = new ethers.providers.Web3Provider(window.ethereum);\n      setProvider(_provider);\n    } catch (e) {\n      console.error('No web3 provider available');\n    }\n  }, [provider]);\n\n  useEffect(() => {\n    if (waku) return;\n    initWaku()\n      .then((wakuNode) => {\n        console.log('waku: ready');\n        setWaku(wakuNode);\n      })\n      .catch((e) => {\n        console.error('Failed to initiate Waku', e);\n      });\n  }, [waku]);\n\n  const generateKeyPair = () => {\n    if (ethDmKeyPair) return;\n    if (!provider) return;\n\n    generateEthDmKeyPair(provider.getSigner())\n      .then((keyPair) => {\n        setEthDmKeyPair(keyPair);\n      })\n      .catch((e) => {\n        console.error('Failed to generate Key Pair', e);\n      });\n  };\n\n  const observerPublicKeyMessage = handlePublicKeyMessage.bind(\n    {},\n    setPublicKeys\n  );\n\n  const observerDirectMessage = ethDmKeyPair\n    ? handleDirectMessage.bind({}, setMessages, ethDmKeyPair.privateKey)\n    : undefined;\n\n  useEffect(() => {\n    if (!waku) return;\n    waku.relay.addObserver(observerPublicKeyMessage, [PublicKeyContentTopic]);\n\n    return function cleanUp() {\n      if (!waku) return;\n      waku.relay.deleteObserver(observerPublicKeyMessage, [\n        PublicKeyContentTopic,\n      ]);\n    };\n  });\n\n  useEffect(() => {\n    if (!waku) return;\n    if (!observerDirectMessage) return;\n    waku.relay.addObserver(observerDirectMessage, [DirectMessageContentTopic]);\n\n    return function cleanUp() {\n      if (!waku) return;\n      if (!observerDirectMessage) return;\n      waku.relay.deleteObserver(observerDirectMessage, [\n        DirectMessageContentTopic,\n      ]);\n    };\n  });\n\n  const broadcastPublicKey = () => {\n    if (!ethDmKeyPair) return;\n    if (!provider) return;\n    if (!waku) return;\n\n    if (publicKeyMsg) {\n      const wakuMsg = encodePublicKeyWakuMessage(publicKeyMsg);\n      waku.lightPush.push(wakuMsg).catch((e) => {\n        console.error('Failed to send Public Key Message');\n      });\n    } else {\n      createPublicKeyMessage(provider.getSigner(), ethDmKeyPair.publicKey)\n        .then((msg) => {\n          setPublicKeyMsg(msg);\n          const wakuMsg = encodePublicKeyWakuMessage(msg);\n          waku.lightPush.push(wakuMsg).catch((e) => {\n            console.error('Failed to send Public Key Message');\n          });\n        })\n        .catch((e) => {\n          console.error('Failed to creat Eth-Dm Publication message', e);\n        });\n    }\n  };\n\n  const wakuReady = !!waku ? 'Waku is ready' : 'Waku is loading';\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        {wakuReady}\n        <div\n          style={{\n            display: 'flex',\n            alignItems: 'center',\n            flexWrap: 'wrap',\n          }}\n        >\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={generateKeyPair}\n            disabled={!provider}\n          >\n            Generate Eth-DM Key Pair\n          </Button>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={broadcastPublicKey}\n            disabled={!ethDmKeyPair || !waku}\n          >\n            Broadcast Eth-DM Public Key\n          </Button>\n        </div>\n        <SendMessage recipients={publicKeys} waku={waku} />\n        <Messages messages={messages} />\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n\nasync function initWaku(): Promise<Waku> {\n  const waku = await Waku.create({});\n\n  const nodes = await getNodes();\n  await Promise.all(\n    nodes.map((addr) => {\n      return waku.dial(addr);\n    })\n  );\n\n  return waku;\n}\n\nfunction getNodes() {\n  // Works with react-scripts\n  if (process?.env?.NODE_ENV === 'development') {\n    return getStatusFleetNodes(Environment.Test);\n  } else {\n    return getStatusFleetNodes(Environment.Prod);\n  }\n}\n\nfunction encodePublicKeyWakuMessage(ethDmMsg: PublicKeyMessage): WakuMessage {\n  const payload = encode(ethDmMsg);\n  return WakuMessage.fromBytes(payload, PublicKeyContentTopic);\n}\n\nfunction handlePublicKeyMessage(\n  setter: Dispatch<SetStateAction<Map<string, string>>>,\n  msg: WakuMessage\n) {\n  if (!msg.payload) return;\n  const publicKeyMsg: PublicKeyMessage = decode(msg.payload);\n  const res = validatePublicKeyMessage(publicKeyMsg);\n  console.log(`Public Key Message Received, valid: ${res}`, publicKeyMsg);\n\n  setter((prevPks: Map<string, string>) => {\n    prevPks.set(publicKeyMsg.ethAddress, publicKeyMsg.ethDmPublicKey);\n    return new Map(prevPks);\n  });\n}\n\nasync function handleDirectMessage(\n  setter: Dispatch<SetStateAction<Message[]>>,\n  privateKey: string,\n  wakuMsg: WakuMessage\n) {\n  console.log('Waku Message received:', wakuMsg);\n  if (!wakuMsg.payload) return;\n  const directMessage: DirectMessage = decode(wakuMsg.payload);\n  const text = await EthCrypto.decryptWithPrivateKey(\n    privateKey,\n    directMessage.encMessage\n  );\n\n  const timestamp = wakuMsg.timestamp ? wakuMsg.timestamp : new Date();\n\n  console.log('Message decrypted:', text);\n  setter((prevMsgs: Message[]) => {\n    const copy = prevMsgs.slice();\n    copy.push({\n      text: text,\n      timestamp: timestamp,\n    });\n    return copy;\n  });\n}\n","import '@ethersproject/shims';\n\nimport * as EthCrypto from 'eth-crypto';\nimport { ethers } from 'ethers';\nimport { Signer } from '@ethersproject/abstract-signer';\nimport { PublicKeyMessage } from './messages';\n\nconst Salt =\n  'Salt for Eth-Dm, do not share a signature of this message or others could decrypt your messages';\n\nexport interface KeyPair {\n  privateKey: string;\n  publicKey: string;\n  address: string;\n}\n\n/**\n * Use the signature of the Salt (\"Salt for eth-dm...\") as\n * the entropy for the EthCrypto keypair. Note that the entropy is hashed with keccak256\n * to make the private key.\n */\nexport async function generateEthDmKeyPair(\n  web3Signer: Signer\n): Promise<KeyPair> {\n  const signature = await web3Signer.signMessage(Salt);\n  // Need to remove '0x' prefix to allow buffer to decode the hex string.\n  const sigBuf = Buffer.from(signature.slice(2), 'hex');\n  const entropy = Buffer.concat([sigBuf, sigBuf]);\n  const keys = EthCrypto.createIdentity(entropy);\n  return keys;\n}\n\n/**\n * Sign the Eth-DM public key with Web3. This can then be published to let other\n * users know to use this Eth-DM public key to encrypt messages for the\n * Ethereum Address holder.\n */\nexport async function createPublicKeyMessage(\n  web3Signer: Signer,\n  ethDmPublicKey: string\n): Promise<PublicKeyMessage> {\n  const ethAddress = await web3Signer.getAddress();\n  const sig = await web3Signer.signMessage(\n    formatPublicKeyForSignature(ethDmPublicKey)\n  );\n  return { ethDmPublicKey, ethAddress, sig };\n}\n\n/**\n * Validate that the EthDm Public Key was signed by the holder of the given Ethereum address.\n */\nexport function validatePublicKeyMessage(msg: PublicKeyMessage): boolean {\n  try {\n    const sigAddress = ethers.utils.verifyMessage(\n      formatPublicKeyForSignature(msg.ethDmPublicKey),\n      msg.sig\n    );\n    return sigAddress === msg.ethAddress;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Prepare Eth-Dm Public key to be signed for publication.\n * The public key is set in on Object `{ ethDmPublicKey: string; }`, converted\n * to JSON and then hashed with Keccak256.\n * The usage of the object helps ensure the signature is only used in an Eth-DM\n * context.\n */\nfunction formatPublicKeyForSignature(ethDmPublicKey: string): string {\n  const txt = JSON.stringify({\n    ethDmPublicKey,\n  });\n  return txt;\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WakuMessage = exports.DefaultContentTopic = void 0;\n// Ensure that this class matches the proto interface while\nconst minimal_1 = require(\"protobufjs/minimal\");\n// Protecting the user from protobuf oddities\nconst proto = __importStar(require(\"../proto/waku/v2/message\"));\nexports.DefaultContentTopic = '/waku/2/default-content/proto';\nconst DefaultVersion = 0;\nclass WakuMessage {\n    constructor(proto) {\n        this.proto = proto;\n    }\n    /**\n     * Create Message with a utf-8 string as payload.\n     */\n    static fromUtf8String(utf8, contentTopic = exports.DefaultContentTopic, timestamp = new Date()) {\n        const payload = Buffer.from(utf8, 'utf-8');\n        return new WakuMessage({\n            payload,\n            version: DefaultVersion,\n            contentTopic,\n            timestamp: timestamp.valueOf() / 1000,\n        });\n    }\n    /**\n     * Create Message with a byte array as payload.\n     */\n    static fromBytes(payload, contentTopic = exports.DefaultContentTopic, timestamp = new Date()) {\n        return new WakuMessage({\n            payload,\n            timestamp: timestamp.valueOf() / 1000,\n            version: DefaultVersion,\n            contentTopic,\n        });\n    }\n    static decode(bytes) {\n        const wakuMsg = proto.WakuMessage.decode(minimal_1.Reader.create(bytes));\n        return new WakuMessage(wakuMsg);\n    }\n    encode() {\n        return proto.WakuMessage.encode(this.proto).finish();\n    }\n    get payloadAsUtf8() {\n        if (!this.proto.payload) {\n            return '';\n        }\n        return Array.from(this.proto.payload)\n            .map((char) => {\n            return String.fromCharCode(char);\n        })\n            .join('');\n    }\n    get payload() {\n        return this.proto.payload;\n    }\n    get contentTopic() {\n        return this.proto.contentTopic;\n    }\n    get version() {\n        return this.proto.version;\n    }\n    get timestamp() {\n        if (this.proto.timestamp) {\n            return new Date(this.proto.timestamp * 1000);\n        }\n        return;\n    }\n}\nexports.WakuMessage = WakuMessage;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2FrdV9tZXNzYWdlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2xpYi93YWt1X21lc3NhZ2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJEQUEyRDtBQUMzRCxnREFBNEM7QUFFNUMsNkNBQTZDO0FBQzdDLGdFQUFrRDtBQUVyQyxRQUFBLG1CQUFtQixHQUFHLCtCQUErQixDQUFDO0FBQ25FLE1BQU0sY0FBYyxHQUFHLENBQUMsQ0FBQztBQUV6QixNQUFhLFdBQVc7SUFDdEIsWUFBMEIsS0FBd0I7UUFBeEIsVUFBSyxHQUFMLEtBQUssQ0FBbUI7SUFBRyxDQUFDO0lBRXREOztPQUVHO0lBQ0gsTUFBTSxDQUFDLGNBQWMsQ0FDbkIsSUFBWSxFQUNaLGVBQXVCLDJCQUFtQixFQUMxQyxZQUFrQixJQUFJLElBQUksRUFBRTtRQUU1QixNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztRQUMzQyxPQUFPLElBQUksV0FBVyxDQUFDO1lBQ3JCLE9BQU87WUFDUCxPQUFPLEVBQUUsY0FBYztZQUN2QixZQUFZO1lBQ1osU0FBUyxFQUFFLFNBQVMsQ0FBQyxPQUFPLEVBQUUsR0FBRyxJQUFJO1NBQ3RDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7T0FFRztJQUNILE1BQU0sQ0FBQyxTQUFTLENBQ2QsT0FBbUIsRUFDbkIsZUFBdUIsMkJBQW1CLEVBQzFDLFlBQWtCLElBQUksSUFBSSxFQUFFO1FBRTVCLE9BQU8sSUFBSSxXQUFXLENBQUM7WUFDckIsT0FBTztZQUNQLFNBQVMsRUFBRSxTQUFTLENBQUMsT0FBTyxFQUFFLEdBQUcsSUFBSTtZQUNyQyxPQUFPLEVBQUUsY0FBYztZQUN2QixZQUFZO1NBQ2IsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBaUI7UUFDN0IsTUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsZ0JBQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUMvRCxPQUFPLElBQUksV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRCxNQUFNO1FBQ0osT0FBTyxLQUFLLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDdkQsQ0FBQztJQUVELElBQUksYUFBYTtRQUNmLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRTtZQUN2QixPQUFPLEVBQUUsQ0FBQztTQUNYO1FBRUQsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDO2FBQ2xDLEdBQUcsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO1lBQ1osT0FBTyxNQUFNLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ25DLENBQUMsQ0FBQzthQUNELElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNkLENBQUM7SUFFRCxJQUFJLE9BQU87UUFDVCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDO0lBQzVCLENBQUM7SUFFRCxJQUFJLFlBQVk7UUFDZCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDO0lBQ2pDLENBQUM7SUFFRCxJQUFJLE9BQU87UUFDVCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDO0lBQzVCLENBQUM7SUFFRCxJQUFJLFNBQVM7UUFDWCxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFO1lBQ3hCLE9BQU8sSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLENBQUM7U0FDOUM7UUFDRCxPQUFPO0lBQ1QsQ0FBQztDQUNGO0FBM0VELGtDQTJFQyJ9","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RelayMaxIHaveLength = exports.RelayOpportunisticGraftPeers = exports.RelayOpportunisticGraftTicks = exports.RelayFanoutTTL = exports.RelayPruneBackoff = exports.RelayPrunePeers = exports.RelayHeartbeatInterval = exports.RelayHeartbeatInitialDelay = exports.RelayGossipFactor = exports.DefaultPubsubTopic = exports.RelayCodec = exports.minute = exports.second = void 0;\nexports.second = 1000;\nexports.minute = 60 * exports.second;\n/**\n * RelayCodec is the libp2p identifier for the waku relay protocol\n */\nexports.RelayCodec = '/vac/waku/relay/2.0.0-beta2';\n/**\n * RelayDefaultTopic is the default gossipsub topic to use for waku relay\n */\nexports.DefaultPubsubTopic = '/waku/2/default-waku/proto';\n/**\n * RelayGossipFactor affects how many peers we will emit gossip to at each heartbeat.\n * We will send gossip to RelayGossipFactor * (total number of non-mesh peers), or\n * RelayDlazy, whichever is greater.\n */\nexports.RelayGossipFactor = 0.25;\n/**\n * GossipsubHeartbeatInitialDelay is the short delay before the heartbeat timer begins\n * after the router is initialized.\n */\nexports.RelayHeartbeatInitialDelay = 100;\n/**\n * RelayHeartbeatInterval controls the time between heartbeats.\n */\nexports.RelayHeartbeatInterval = exports.second;\n/**\n * RelayPrunePeers controls the number of peers to include in prune Peer eXchange.\n * When we prune a peer that's eligible for PX (has a good score, etc), we will try to\n * send them signed peer records for up to RelayPrunePeers other peers that we\n * know of.\n */\nexports.RelayPrunePeers = 16;\n/**\n * RelayPruneBackoff controls the backoff time for pruned peers. This is how long\n * a peer must wait before attempting to graft into our mesh again after being pruned.\n * When pruning a peer, we send them our value of RelayPruneBackoff so they know\n * the minimum time to wait. Peers running older versions may not send a backoff time,\n * so if we receive a prune message without one, we will wait at least RelayPruneBackoff\n * before attempting to re-graft.\n */\nexports.RelayPruneBackoff = exports.minute;\n/**\n * RelayFanoutTTL controls how long we keep track of the fanout state. If it's been\n * RelayFanoutTTL since we've published to a topic that we're not subscribed to,\n * we'll delete the fanout map for that topic.\n */\nexports.RelayFanoutTTL = exports.minute;\n/**\n * RelayOpportunisticGraftTicks is the number of heartbeat ticks for attempting to improve the mesh\n * with opportunistic grafting. Every RelayOpportunisticGraftTicks we will attempt to select some\n * high-scoring mesh peers to replace lower-scoring ones, if the median score of our mesh peers falls\n * below a threshold\n */\nexports.RelayOpportunisticGraftTicks = 60;\n/**\n * RelayOpportunisticGraftPeers is the number of peers to opportunistically graft.\n */\nexports.RelayOpportunisticGraftPeers = 2;\n/**\n * RelayMaxIHaveLength is the maximum number of messages to include in an IHAVE message.\n * Also controls the maximum number of IHAVE ids we will accept and request with IWANT from a\n * peer within a heartbeat, to protect from IHAVE floods. You should adjust this value from the\n * default if your system is pushing more than 5000 messages in GossipsubHistoryGossip heartbeats;\n * with the defaults this is 1666 messages/s.\n */\nexports.RelayMaxIHaveLength = 5000;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uc3RhbnRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi93YWt1X3JlbGF5L2NvbnN0YW50cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBYSxRQUFBLE1BQU0sR0FBRyxJQUFJLENBQUM7QUFDZCxRQUFBLE1BQU0sR0FBRyxFQUFFLEdBQUcsY0FBTSxDQUFDO0FBRWxDOztHQUVHO0FBQ1UsUUFBQSxVQUFVLEdBQUcsNkJBQTZCLENBQUM7QUFFeEQ7O0dBRUc7QUFDVSxRQUFBLGtCQUFrQixHQUFHLDRCQUE0QixDQUFDO0FBRS9EOzs7O0dBSUc7QUFDVSxRQUFBLGlCQUFpQixHQUFHLElBQUksQ0FBQztBQUV0Qzs7O0dBR0c7QUFDVSxRQUFBLDBCQUEwQixHQUFHLEdBQUcsQ0FBQztBQUU5Qzs7R0FFRztBQUNVLFFBQUEsc0JBQXNCLEdBQUcsY0FBTSxDQUFDO0FBRTdDOzs7OztHQUtHO0FBQ1UsUUFBQSxlQUFlLEdBQUcsRUFBRSxDQUFDO0FBRWxDOzs7Ozs7O0dBT0c7QUFDVSxRQUFBLGlCQUFpQixHQUFHLGNBQU0sQ0FBQztBQUV4Qzs7OztHQUlHO0FBQ1UsUUFBQSxjQUFjLEdBQUcsY0FBTSxDQUFDO0FBRXJDOzs7OztHQUtHO0FBQ1UsUUFBQSw0QkFBNEIsR0FBRyxFQUFFLENBQUM7QUFFL0M7O0dBRUc7QUFDVSxRQUFBLDRCQUE0QixHQUFHLENBQUMsQ0FBQztBQUU5Qzs7Ozs7O0dBTUc7QUFDVSxRQUFBLG1CQUFtQixHQUFHLElBQUksQ0FBQyJ9","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WakuLightPush = exports.PushResponse = exports.LightPushCodec = void 0;\nconst it_concat_1 = __importDefault(require(\"it-concat\"));\nconst it_length_prefixed_1 = __importDefault(require(\"it-length-prefixed\"));\nconst it_pipe_1 = __importDefault(require(\"it-pipe\"));\nconst light_push_1 = require(\"../../proto/waku/v2/light_push\");\nObject.defineProperty(exports, \"PushResponse\", { enumerable: true, get: function () { return light_push_1.PushResponse; } });\nconst select_peer_1 = require(\"../select_peer\");\nconst waku_relay_1 = require(\"../waku_relay\");\nconst push_rpc_1 = require(\"./push_rpc\");\nexports.LightPushCodec = '/vac/waku/lightpush/2.0.0-beta1';\n/**\n * Implements the [Waku v2 Light Push protocol](https://rfc.vac.dev/spec/19/).\n */\nclass WakuLightPush {\n    constructor(libp2p, options) {\n        this.libp2p = libp2p;\n        if (options === null || options === void 0 ? void 0 : options.pubsubTopic) {\n            this.pubsubTopic = options.pubsubTopic;\n        }\n        else {\n            this.pubsubTopic = waku_relay_1.DefaultPubsubTopic;\n        }\n    }\n    async push(message, opts) {\n        let peer;\n        if (opts === null || opts === void 0 ? void 0 : opts.peerId) {\n            peer = this.libp2p.peerStore.get(opts.peerId);\n            if (!peer)\n                throw 'Peer is unknown';\n        }\n        else {\n            peer = select_peer_1.selectRandomPeer(this.libp2p, exports.LightPushCodec);\n        }\n        if (!peer)\n            throw 'No peer available';\n        if (!peer.protocols.includes(exports.LightPushCodec))\n            throw 'Peer does not register waku light push protocol';\n        const connection = this.libp2p.connectionManager.get(peer.id);\n        if (!connection)\n            throw 'Failed to get a connection to the peer';\n        const { stream } = await connection.newStream(exports.LightPushCodec);\n        try {\n            const pubsubTopic = (opts === null || opts === void 0 ? void 0 : opts.pubsubTopic)\n                ? opts.pubsubTopic\n                : this.pubsubTopic;\n            const query = push_rpc_1.PushRPC.createRequest(message, pubsubTopic);\n            const res = await it_pipe_1.default([query.encode()], it_length_prefixed_1.default.encode(), stream, it_length_prefixed_1.default.decode(), it_concat_1.default);\n            try {\n                const response = push_rpc_1.PushRPC.decode(res.slice()).response;\n                if (!response) {\n                    console.log('No response in PushRPC');\n                    return null;\n                }\n                return response;\n            }\n            catch (err) {\n                console.log('Failed to decode push reply', err);\n            }\n        }\n        catch (err) {\n            console.log('Failed to send waku light push request', err);\n        }\n        return null;\n    }\n}\nexports.WakuLightPush = WakuLightPush;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL3dha3VfbGlnaHRfcHVzaC9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSwwREFBK0I7QUFDL0IsNEVBQW9DO0FBQ3BDLHNEQUEyQjtBQUkzQiwrREFBOEQ7QUFRckQsNkZBUkEseUJBQVksT0FRQTtBQVByQixnREFBa0Q7QUFFbEQsOENBQW1EO0FBRW5ELHlDQUFxQztBQUV4QixRQUFBLGNBQWMsR0FBRyxpQ0FBaUMsQ0FBQztBQW9CaEU7O0dBRUc7QUFDSCxNQUFhLGFBQWE7SUFHeEIsWUFBbUIsTUFBYyxFQUFFLE9BQXVCO1FBQXZDLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDL0IsSUFBSSxPQUFPLGFBQVAsT0FBTyx1QkFBUCxPQUFPLENBQUUsV0FBVyxFQUFFO1lBQ3hCLElBQUksQ0FBQyxXQUFXLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQztTQUN4QzthQUFNO1lBQ0wsSUFBSSxDQUFDLFdBQVcsR0FBRywrQkFBa0IsQ0FBQztTQUN2QztJQUNILENBQUM7SUFFRCxLQUFLLENBQUMsSUFBSSxDQUNSLE9BQW9CLEVBQ3BCLElBQWtCO1FBRWxCLElBQUksSUFBSSxDQUFDO1FBQ1QsSUFBSSxJQUFJLGFBQUosSUFBSSx1QkFBSixJQUFJLENBQUUsTUFBTSxFQUFFO1lBQ2hCLElBQUksR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQzlDLElBQUksQ0FBQyxJQUFJO2dCQUFFLE1BQU0saUJBQWlCLENBQUM7U0FDcEM7YUFBTTtZQUNMLElBQUksR0FBRyw4QkFBZ0IsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLHNCQUFjLENBQUMsQ0FBQztTQUN0RDtRQUNELElBQUksQ0FBQyxJQUFJO1lBQUUsTUFBTSxtQkFBbUIsQ0FBQztRQUNyQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsc0JBQWMsQ0FBQztZQUMxQyxNQUFNLGlEQUFpRCxDQUFDO1FBRTFELE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUM5RCxJQUFJLENBQUMsVUFBVTtZQUFFLE1BQU0sd0NBQXdDLENBQUM7UUFFaEUsTUFBTSxFQUFFLE1BQU0sRUFBRSxHQUFHLE1BQU0sVUFBVSxDQUFDLFNBQVMsQ0FBQyxzQkFBYyxDQUFDLENBQUM7UUFDOUQsSUFBSTtZQUNGLE1BQU0sV0FBVyxHQUFHLENBQUEsSUFBSSxhQUFKLElBQUksdUJBQUosSUFBSSxDQUFFLFdBQVc7Z0JBQ25DLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVztnQkFDbEIsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUM7WUFDckIsTUFBTSxLQUFLLEdBQUcsa0JBQU8sQ0FBQyxhQUFhLENBQUMsT0FBTyxFQUFFLFdBQVcsQ0FBQyxDQUFDO1lBQzFELE1BQU0sR0FBRyxHQUFHLE1BQU0saUJBQUksQ0FDcEIsQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsRUFDaEIsNEJBQUUsQ0FBQyxNQUFNLEVBQUUsRUFDWCxNQUFNLEVBQ04sNEJBQUUsQ0FBQyxNQUFNLEVBQUUsRUFDWCxtQkFBTSxDQUNQLENBQUM7WUFDRixJQUFJO2dCQUNGLE1BQU0sUUFBUSxHQUFHLGtCQUFPLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQztnQkFFdEQsSUFBSSxDQUFDLFFBQVEsRUFBRTtvQkFDYixPQUFPLENBQUMsR0FBRyxDQUFDLHdCQUF3QixDQUFDLENBQUM7b0JBQ3RDLE9BQU8sSUFBSSxDQUFDO2lCQUNiO2dCQUVELE9BQU8sUUFBUSxDQUFDO2FBQ2pCO1lBQUMsT0FBTyxHQUFHLEVBQUU7Z0JBQ1osT0FBTyxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLENBQUMsQ0FBQzthQUNqRDtTQUNGO1FBQUMsT0FBTyxHQUFHLEVBQUU7WUFDWixPQUFPLENBQUMsR0FBRyxDQUFDLHdDQUF3QyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1NBQzVEO1FBQ0QsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0NBQ0Y7QUEzREQsc0NBMkRDIn0=","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PushRPC = exports.PushResponse = exports.PushRequest = exports.protobufPackage = void 0;\n/* eslint-disable */\nconst long_1 = __importDefault(require(\"long\"));\nconst minimal_1 = __importDefault(require(\"protobufjs/minimal\"));\nconst message_1 = require(\"../../waku/v2/message\");\nexports.protobufPackage = 'waku.v2';\nconst basePushRequest = { pubsubTopic: '' };\nexports.PushRequest = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        if (message.pubsubTopic !== '') {\n            writer.uint32(10).string(message.pubsubTopic);\n        }\n        if (message.message !== undefined) {\n            message_1.WakuMessage.encode(message.message, writer.uint32(18).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, basePushRequest);\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.pubsubTopic = reader.string();\n                    break;\n                case 2:\n                    message.message = message_1.WakuMessage.decode(reader, reader.uint32());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, basePushRequest);\n        if (object.pubsubTopic !== undefined && object.pubsubTopic !== null) {\n            message.pubsubTopic = String(object.pubsubTopic);\n        }\n        else {\n            message.pubsubTopic = '';\n        }\n        if (object.message !== undefined && object.message !== null) {\n            message.message = message_1.WakuMessage.fromJSON(object.message);\n        }\n        else {\n            message.message = undefined;\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.pubsubTopic !== undefined &&\n            (obj.pubsubTopic = message.pubsubTopic);\n        message.message !== undefined &&\n            (obj.message = message.message\n                ? message_1.WakuMessage.toJSON(message.message)\n                : undefined);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, basePushRequest);\n        if (object.pubsubTopic !== undefined && object.pubsubTopic !== null) {\n            message.pubsubTopic = object.pubsubTopic;\n        }\n        else {\n            message.pubsubTopic = '';\n        }\n        if (object.message !== undefined && object.message !== null) {\n            message.message = message_1.WakuMessage.fromPartial(object.message);\n        }\n        else {\n            message.message = undefined;\n        }\n        return message;\n    },\n};\nconst basePushResponse = { isSuccess: false, info: '' };\nexports.PushResponse = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        if (message.isSuccess === true) {\n            writer.uint32(8).bool(message.isSuccess);\n        }\n        if (message.info !== '') {\n            writer.uint32(18).string(message.info);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, basePushResponse);\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.isSuccess = reader.bool();\n                    break;\n                case 2:\n                    message.info = reader.string();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, basePushResponse);\n        if (object.isSuccess !== undefined && object.isSuccess !== null) {\n            message.isSuccess = Boolean(object.isSuccess);\n        }\n        else {\n            message.isSuccess = false;\n        }\n        if (object.info !== undefined && object.info !== null) {\n            message.info = String(object.info);\n        }\n        else {\n            message.info = '';\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.isSuccess !== undefined && (obj.isSuccess = message.isSuccess);\n        message.info !== undefined && (obj.info = message.info);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, basePushResponse);\n        if (object.isSuccess !== undefined && object.isSuccess !== null) {\n            message.isSuccess = object.isSuccess;\n        }\n        else {\n            message.isSuccess = false;\n        }\n        if (object.info !== undefined && object.info !== null) {\n            message.info = object.info;\n        }\n        else {\n            message.info = '';\n        }\n        return message;\n    },\n};\nconst basePushRPC = { requestId: '' };\nexports.PushRPC = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        if (message.requestId !== '') {\n            writer.uint32(10).string(message.requestId);\n        }\n        if (message.request !== undefined) {\n            exports.PushRequest.encode(message.request, writer.uint32(18).fork()).ldelim();\n        }\n        if (message.response !== undefined) {\n            exports.PushResponse.encode(message.response, writer.uint32(26).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, basePushRPC);\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.requestId = reader.string();\n                    break;\n                case 2:\n                    message.request = exports.PushRequest.decode(reader, reader.uint32());\n                    break;\n                case 3:\n                    message.response = exports.PushResponse.decode(reader, reader.uint32());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, basePushRPC);\n        if (object.requestId !== undefined && object.requestId !== null) {\n            message.requestId = String(object.requestId);\n        }\n        else {\n            message.requestId = '';\n        }\n        if (object.request !== undefined && object.request !== null) {\n            message.request = exports.PushRequest.fromJSON(object.request);\n        }\n        else {\n            message.request = undefined;\n        }\n        if (object.response !== undefined && object.response !== null) {\n            message.response = exports.PushResponse.fromJSON(object.response);\n        }\n        else {\n            message.response = undefined;\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.requestId !== undefined && (obj.requestId = message.requestId);\n        message.request !== undefined &&\n            (obj.request = message.request\n                ? exports.PushRequest.toJSON(message.request)\n                : undefined);\n        message.response !== undefined &&\n            (obj.response = message.response\n                ? exports.PushResponse.toJSON(message.response)\n                : undefined);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, basePushRPC);\n        if (object.requestId !== undefined && object.requestId !== null) {\n            message.requestId = object.requestId;\n        }\n        else {\n            message.requestId = '';\n        }\n        if (object.request !== undefined && object.request !== null) {\n            message.request = exports.PushRequest.fromPartial(object.request);\n        }\n        else {\n            message.request = undefined;\n        }\n        if (object.response !== undefined && object.response !== null) {\n            message.response = exports.PushResponse.fromPartial(object.response);\n        }\n        else {\n            message.response = undefined;\n        }\n        return message;\n    },\n};\nif (minimal_1.default.util.Long !== long_1.default) {\n    minimal_1.default.util.Long = long_1.default;\n    minimal_1.default.configure();\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlnaHRfcHVzaC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9wcm90by93YWt1L3YyL2xpZ2h0X3B1c2gudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsb0JBQW9CO0FBQ3BCLGdEQUF3QjtBQUN4QixpRUFBcUM7QUFDckMsbURBQW9EO0FBRXZDLFFBQUEsZUFBZSxHQUFHLFNBQVMsQ0FBQztBQWtCekMsTUFBTSxlQUFlLEdBQVcsRUFBRSxXQUFXLEVBQUUsRUFBRSxFQUFFLENBQUM7QUFFdkMsUUFBQSxXQUFXLEdBQUc7SUFDekIsTUFBTSxDQUNKLE9BQW9CLEVBQ3BCLFNBQXFCLGlCQUFHLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRTtRQUV4QyxJQUFJLE9BQU8sQ0FBQyxXQUFXLEtBQUssRUFBRSxFQUFFO1lBQzlCLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztTQUMvQztRQUNELElBQUksT0FBTyxDQUFDLE9BQU8sS0FBSyxTQUFTLEVBQUU7WUFDakMscUJBQVcsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7U0FDeEU7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBRUQsTUFBTSxDQUFDLEtBQThCLEVBQUUsTUFBZTtRQUNwRCxNQUFNLE1BQU0sR0FBRyxLQUFLLFlBQVksaUJBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxpQkFBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMzRSxJQUFJLEdBQUcsR0FBRyxNQUFNLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxD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","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.selectRandomPeer = void 0;\n/**\n * Returns a pseudo-random peer that supports the given protocol.\n * Useful for protocols such as store and light push\n */\nfunction selectRandomPeer(libp2p, protocol) {\n    const allPeers = Array.from(libp2p.peerStore.peers.values());\n    const size = allPeers.length;\n    const peers = allPeers.filter((peer) => peer.protocols.includes(protocol));\n    if (peers.length === 0)\n        return;\n    const index = Math.round(Math.random() * (size - 1));\n    return allPeers[index];\n}\nexports.selectRandomPeer = selectRandomPeer;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0X3BlZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbGliL3NlbGVjdF9wZWVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUdBOzs7R0FHRztBQUNILFNBQWdCLGdCQUFnQixDQUM5QixNQUFjLEVBQ2QsUUFBZ0I7SUFFaEIsTUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO0lBQzdELE1BQU0sSUFBSSxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUM7SUFDN0IsTUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztJQUMzRSxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQztRQUFFLE9BQU87SUFDL0IsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNyRCxPQUFPLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUN6QixDQUFDO0FBVkQsNENBVUMifQ==","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getRelayPeers = void 0;\nconst utils_1 = require(\"libp2p-gossipsub/src/utils\");\nconst index_1 = require(\"./index\");\n/**\n * Given a topic, returns up to count peers subscribed to that topic\n * that pass an optional filter function\n *\n * @param {Gossipsub} router\n * @param {String} topic\n * @param {Number} count\n * @param {Function} [filter] a function to filter acceptable peers\n * @returns {Set<string>}\n *\n */\nfunction getRelayPeers(router, topic, count, filter = () => true) {\n    const peersInTopic = router.topics.get(topic);\n    if (!peersInTopic) {\n        return new Set();\n    }\n    // Adds all peers using our protocol\n    // that also pass the filter function\n    let peers = [];\n    peersInTopic.forEach((id) => {\n        const peerStreams = router.peers.get(id);\n        if (!peerStreams) {\n            return;\n        }\n        if (peerStreams.protocol == index_1.RelayCodec && filter(id)) {\n            peers.push(id);\n        }\n    });\n    // Pseudo-randomly shuffles peers\n    peers = utils_1.shuffle(peers);\n    if (count > 0 && peers.length > count) {\n        peers = peers.slice(0, count);\n    }\n    return new Set(peers);\n}\nexports.getRelayPeers = getRelayPeers;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0X3JlbGF5X3BlZXJzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi93YWt1X3JlbGF5L2dldF9yZWxheV9wZWVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSxzREFBcUQ7QUFFckQsbUNBQXFDO0FBRXJDOzs7Ozs7Ozs7O0dBVUc7QUFDSCxTQUFnQixhQUFhLENBQzNCLE1BQWlCLEVBQ2pCLEtBQWEsRUFDYixLQUFhLEVBQ2IsU0FBa0MsR0FBWSxFQUFFLENBQUMsSUFBSTtJQUVyRCxNQUFNLFlBQVksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM5QyxJQUFJLENBQUMsWUFBWSxFQUFFO1FBQ2pCLE9BQU8sSUFBSSxHQUFHLEVBQUUsQ0FBQztLQUNsQjtJQUVELG9DQUFvQztJQUNwQyxxQ0FBcUM7SUFDckMsSUFBSSxLQUFLLEdBQWEsRUFBRSxDQUFDO0lBQ3pCLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFVLEVBQUUsRUFBRTtRQUNsQyxNQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUN6QyxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2hCLE9BQU87U0FDUjtRQUNELElBQUksV0FBVyxDQUFDLFFBQVEsSUFBSSxrQkFBVSxJQUFJLE1BQU0sQ0FBQyxFQUFFLENBQUMsRUFBRTtZQUNwRCxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1NBQ2hCO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFSCxpQ0FBaUM7SUFDakMsS0FBSyxHQUFHLGVBQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN2QixJQUFJLEtBQUssR0FBRyxDQUFDLElBQUksS0FBSyxDQUFDLE1BQU0sR0FBRyxLQUFLLEVBQUU7UUFDckMsS0FBSyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO0tBQy9CO0lBRUQsT0FBTyxJQUFJLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUN4QixDQUFDO0FBL0JELHNDQStCQyJ9","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WakuStore = exports.Direction = exports.StoreCodec = void 0;\nconst it_concat_1 = __importDefault(require(\"it-concat\"));\nconst it_length_prefixed_1 = __importDefault(require(\"it-length-prefixed\"));\nconst it_pipe_1 = __importDefault(require(\"it-pipe\"));\nconst select_peer_1 = require(\"../select_peer\");\nconst waku_message_1 = require(\"../waku_message\");\nconst waku_relay_1 = require(\"../waku_relay\");\nconst history_rpc_1 = require(\"./history_rpc\");\nObject.defineProperty(exports, \"Direction\", { enumerable: true, get: function () { return history_rpc_1.Direction; } });\nexports.StoreCodec = '/vac/waku/store/2.0.0-beta3';\n/**\n * Implements the [Waku v2 Store protocol](https://rfc.vac.dev/spec/13/).\n */\nclass WakuStore {\n    constructor(libp2p, options) {\n        this.libp2p = libp2p;\n        if (options === null || options === void 0 ? void 0 : options.pubsubTopic) {\n            this.pubsubTopic = options.pubsubTopic;\n        }\n        else {\n            this.pubsubTopic = waku_relay_1.DefaultPubsubTopic;\n        }\n    }\n    /**\n     * Query given peer using Waku Store.\n     *\n     * @param options\n     * @param options.peerId The peer to query.Options\n     * @param options.contentTopics The content topics to pass to the query, leave empty to\n     * retrieve all messages.\n     * @param options.pubsubTopic The pubsub topic to pass to the query. Defaults\n     * to the value set at creation. See [Waku v2 Topic Usage Recommendations](https://rfc.vac.dev/spec/23/).\n     * @param options.callback Callback called on page of stored messages as they are retrieved\n     * @throws If not able to reach the peer to query.\n     */\n    async queryHistory(options) {\n        var _a, _b, _c, _d;\n        const opts = Object.assign({\n            pubsubTopic: this.pubsubTopic,\n            direction: history_rpc_1.Direction.BACKWARD,\n            pageSize: 10,\n        }, options);\n        let peer;\n        if (opts.peerId) {\n            peer = this.libp2p.peerStore.get(opts.peerId);\n            if (!peer)\n                throw 'Peer is unknown';\n        }\n        else {\n            peer = select_peer_1.selectRandomPeer(this.libp2p, exports.StoreCodec);\n        }\n        if (!peer)\n            throw 'No peer available';\n        if (!peer.protocols.includes(exports.StoreCodec))\n            throw 'Peer does not register waku store protocol';\n        const connection = this.libp2p.connectionManager.get(peer.id);\n        if (!connection)\n            throw 'Failed to get a connection to the peer';\n        const messages = [];\n        let cursor = undefined;\n        while (true) {\n            try {\n                const { stream } = await connection.newStream(exports.StoreCodec);\n                try {\n                    const queryOpts = Object.assign(opts, { cursor });\n                    const historyRpcQuery = history_rpc_1.HistoryRPC.createQuery(queryOpts);\n                    const res = await it_pipe_1.default([historyRpcQuery.encode()], it_length_prefixed_1.default.encode(), stream, it_length_prefixed_1.default.decode(), it_concat_1.default);\n                    try {\n                        const reply = history_rpc_1.HistoryRPC.decode(res.slice());\n                        const response = reply.response;\n                        if (!response) {\n                            console.log('No response in HistoryRPC');\n                            return null;\n                        }\n                        if (!response.messages || !response.messages.length) {\n                            // No messages left (or stored)\n                            console.log('No messages present in HistoryRPC response');\n                            return messages;\n                        }\n                        const pageMessages = response.messages.map((protoMsg) => {\n                            return new waku_message_1.WakuMessage(protoMsg);\n                        });\n                        if (opts.callback) {\n                            // TODO: Test the callback feature\n                            opts.callback(pageMessages);\n                        }\n                        pageMessages.forEach((wakuMessage) => {\n                            messages.push(wakuMessage);\n                        });\n                        const responsePageSize = (_a = response.pagingInfo) === null || _a === void 0 ? void 0 : _a.pageSize;\n                        const queryPageSize = (_c = (_b = historyRpcQuery.query) === null || _b === void 0 ? void 0 : _b.pagingInfo) === null || _c === void 0 ? void 0 : _c.pageSize;\n                        if (responsePageSize &&\n                            queryPageSize &&\n                            responsePageSize < queryPageSize) {\n                            // Response page size smaller than query, meaning this is the last page\n                            return messages;\n                        }\n                        cursor = (_d = response.pagingInfo) === null || _d === void 0 ? void 0 : _d.cursor;\n                        if (cursor === undefined) {\n                            // If the server does not return cursor then there is an issue,\n                            // Need to abort or we end up in an infinite loop\n                            console.log('No cursor returned by peer.');\n                            return messages;\n                        }\n                    }\n                    catch (err) {\n                        console.log('Failed to decode store reply', err);\n                    }\n                }\n                catch (err) {\n                    console.log('Failed to send waku store query', err);\n                }\n            }\n            catch (err) {\n                console.log('Failed to negotiate waku store protocol stream with peer', err);\n            }\n        }\n    }\n}\nexports.WakuStore = WakuStore;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL3dha3Vfc3RvcmUvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsMERBQStCO0FBQy9CLDRFQUFvQztBQUNwQyxzREFBMkI7QUFJM0IsZ0RBQWtEO0FBQ2xELGtEQUE4QztBQUM5Qyw4Q0FBbUQ7QUFFbkQsK0NBQXNEO0FBSTdDLDBGQUpBLHVCQUFTLE9BSUE7QUFGTCxRQUFBLFVBQVUsR0FBRyw2QkFBNkIsQ0FBQztBQXlCeEQ7O0dBRUc7QUFDSCxNQUFhLFNBQVM7SUFHcEIsWUFBbUIsTUFBYyxFQUFFLE9BQXVCO1FBQXZDLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDL0IsSUFBSSxPQUFPLGFBQVAsT0FBTyx1QkFBUCxPQUFPLENBQUUsV0FBVyxFQUFFO1lBQ3hCLElBQUksQ0FBQyxXQUFXLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQztTQUN4QzthQUFNO1lBQ0wsSUFBSSxDQUFDLFdBQVcsR0FBRywrQkFBa0IsQ0FBQztTQUN2QztJQUNILENBQUM7SUFFRDs7Ozs7Ozs7Ozs7T0FXRztJQUNILEtBQUssQ0FBQyxZQUFZLENBQUMsT0FBcUI7O1FBQ3RDLE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQ3hCO1lBQ0UsV0FBVyxFQUFFLElBQUksQ0FBQyxXQUFXO1lBQzdCLFNBQVMsRUFBRSx1QkFBUyxDQUFDLFFBQVE7WUFDN0IsUUFBUSxFQUFFLEVBQUU7U0FDYixFQUNELE9BQU8sQ0FDUixDQUFDO1FBRUYsSUFBSSxJQUFJLENBQUM7UUFDVCxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDZixJQUFJLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUM5QyxJQUFJLENBQUMsSUFBSTtnQkFBRSxNQUFNLGlCQUFpQixDQUFDO1NBQ3BD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","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HistoryRPC = exports.HistoryResponse = exports.HistoryQuery = exports.ContentFilter = exports.PagingInfo = exports.Index = exports.pagingInfo_DirectionToJSON = exports.pagingInfo_DirectionFromJSON = exports.PagingInfo_Direction = exports.protobufPackage = void 0;\n/* eslint-disable */\nconst long_1 = __importDefault(require(\"long\"));\nconst minimal_1 = __importDefault(require(\"protobufjs/minimal\"));\nconst message_1 = require(\"../../waku/v2/message\");\nexports.protobufPackage = 'waku.v2';\nvar PagingInfo_Direction;\n(function (PagingInfo_Direction) {\n    PagingInfo_Direction[PagingInfo_Direction[\"DIRECTION_BACKWARD_UNSPECIFIED\"] = 0] = \"DIRECTION_BACKWARD_UNSPECIFIED\";\n    PagingInfo_Direction[PagingInfo_Direction[\"DIRECTION_FORWARD\"] = 1] = \"DIRECTION_FORWARD\";\n    PagingInfo_Direction[PagingInfo_Direction[\"UNRECOGNIZED\"] = -1] = \"UNRECOGNIZED\";\n})(PagingInfo_Direction = exports.PagingInfo_Direction || (exports.PagingInfo_Direction = {}));\nfunction pagingInfo_DirectionFromJSON(object) {\n    switch (object) {\n        case 0:\n        case 'DIRECTION_BACKWARD_UNSPECIFIED':\n            return PagingInfo_Direction.DIRECTION_BACKWARD_UNSPECIFIED;\n        case 1:\n        case 'DIRECTION_FORWARD':\n            return PagingInfo_Direction.DIRECTION_FORWARD;\n        case -1:\n        case 'UNRECOGNIZED':\n        default:\n            return PagingInfo_Direction.UNRECOGNIZED;\n    }\n}\nexports.pagingInfo_DirectionFromJSON = pagingInfo_DirectionFromJSON;\nfunction pagingInfo_DirectionToJSON(object) {\n    switch (object) {\n        case PagingInfo_Direction.DIRECTION_BACKWARD_UNSPECIFIED:\n            return 'DIRECTION_BACKWARD_UNSPECIFIED';\n        case PagingInfo_Direction.DIRECTION_FORWARD:\n            return 'DIRECTION_FORWARD';\n        default:\n            return 'UNKNOWN';\n    }\n}\nexports.pagingInfo_DirectionToJSON = pagingInfo_DirectionToJSON;\nconst baseIndex = { receivedTime: 0 };\nexports.Index = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        if (message.digest.length !== 0) {\n            writer.uint32(10).bytes(message.digest);\n        }\n        if (message.receivedTime !== 0) {\n            writer.uint32(17).double(message.receivedTime);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, baseIndex);\n        message.digest = new Uint8Array();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.digest = reader.bytes();\n                    break;\n                case 2:\n                    message.receivedTime = reader.double();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, baseIndex);\n        message.digest = new Uint8Array();\n        if (object.digest !== undefined && object.digest !== null) {\n            message.digest = bytesFromBase64(object.digest);\n        }\n        if (object.receivedTime !== undefined && object.receivedTime !== null) {\n            message.receivedTime = Number(object.receivedTime);\n        }\n        else {\n            message.receivedTime = 0;\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.digest !== undefined &&\n            (obj.digest = base64FromBytes(message.digest !== undefined ? message.digest : new Uint8Array()));\n        message.receivedTime !== undefined &&\n            (obj.receivedTime = message.receivedTime);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, baseIndex);\n        if (object.digest !== undefined && object.digest !== null) {\n            message.digest = object.digest;\n        }\n        else {\n            message.digest = new Uint8Array();\n        }\n        if (object.receivedTime !== undefined && object.receivedTime !== null) {\n            message.receivedTime = object.receivedTime;\n        }\n        else {\n            message.receivedTime = 0;\n        }\n        return message;\n    },\n};\nconst basePagingInfo = { pageSize: 0, direction: 0 };\nexports.PagingInfo = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        if (message.pageSize !== 0) {\n            writer.uint32(8).uint64(message.pageSize);\n        }\n        if (message.cursor !== undefined) {\n            exports.Index.encode(message.cursor, writer.uint32(18).fork()).ldelim();\n        }\n        if (message.direction !== 0) {\n            writer.uint32(24).int32(message.direction);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, basePagingInfo);\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.pageSize = longToNumber(reader.uint64());\n                    break;\n                case 2:\n                    message.cursor = exports.Index.decode(reader, reader.uint32());\n                    break;\n                case 3:\n                    message.direction = reader.int32();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, basePagingInfo);\n        if (object.pageSize !== undefined && object.pageSize !== null) {\n            message.pageSize = Number(object.pageSize);\n        }\n        else {\n            message.pageSize = 0;\n        }\n        if (object.cursor !== undefined && object.cursor !== null) {\n            message.cursor = exports.Index.fromJSON(object.cursor);\n        }\n        else {\n            message.cursor = undefined;\n        }\n        if (object.direction !== undefined && object.direction !== null) {\n            message.direction = pagingInfo_DirectionFromJSON(object.direction);\n        }\n        else {\n            message.direction = 0;\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.pageSize !== undefined && (obj.pageSize = message.pageSize);\n        message.cursor !== undefined &&\n            (obj.cursor = message.cursor ? exports.Index.toJSON(message.cursor) : undefined);\n        message.direction !== undefined &&\n            (obj.direction = pagingInfo_DirectionToJSON(message.direction));\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, basePagingInfo);\n        if (object.pageSize !== undefined && object.pageSize !== null) {\n            message.pageSize = object.pageSize;\n        }\n        else {\n            message.pageSize = 0;\n        }\n        if (object.cursor !== undefined && object.cursor !== null) {\n            message.cursor = exports.Index.fromPartial(object.cursor);\n        }\n        else {\n            message.cursor = undefined;\n        }\n        if (object.direction !== undefined && object.direction !== null) {\n            message.direction = object.direction;\n        }\n        else {\n            message.direction = 0;\n        }\n        return message;\n    },\n};\nconst baseContentFilter = { contentTopic: '' };\nexports.ContentFilter = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        if (message.contentTopic !== '') {\n            writer.uint32(10).string(message.contentTopic);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, baseContentFilter);\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.contentTopic = reader.string();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, baseContentFilter);\n        if (object.contentTopic !== undefined && object.contentTopic !== null) {\n            message.contentTopic = String(object.contentTopic);\n        }\n        else {\n            message.contentTopic = '';\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.contentTopic !== undefined &&\n            (obj.contentTopic = message.contentTopic);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, baseContentFilter);\n        if (object.contentTopic !== undefined && object.contentTopic !== null) {\n            message.contentTopic = object.contentTopic;\n        }\n        else {\n            message.contentTopic = '';\n        }\n        return message;\n    },\n};\nconst baseHistoryQuery = {};\nexports.HistoryQuery = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        if (message.pubsubTopic !== undefined) {\n            writer.uint32(18).string(message.pubsubTopic);\n        }\n        for (const v of message.contentFilters) {\n            exports.ContentFilter.encode(v, writer.uint32(26).fork()).ldelim();\n        }\n        if (message.pagingInfo !== undefined) {\n            exports.PagingInfo.encode(message.pagingInfo, writer.uint32(34).fork()).ldelim();\n        }\n        if (message.startTime !== undefined) {\n            writer.uint32(41).double(message.startTime);\n        }\n        if (message.endTime !== undefined) {\n            writer.uint32(49).double(message.endTime);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, baseHistoryQuery);\n        message.contentFilters = [];\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 2:\n                    message.pubsubTopic = reader.string();\n                    break;\n                case 3:\n                    message.contentFilters.push(exports.ContentFilter.decode(reader, reader.uint32()));\n                    break;\n                case 4:\n                    message.pagingInfo = exports.PagingInfo.decode(reader, reader.uint32());\n                    break;\n                case 5:\n                    message.startTime = reader.double();\n                    break;\n                case 6:\n                    message.endTime = reader.double();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, baseHistoryQuery);\n        message.contentFilters = [];\n        if (object.pubsubTopic !== undefined && object.pubsubTopic !== null) {\n            message.pubsubTopic = String(object.pubsubTopic);\n        }\n        else {\n            message.pubsubTopic = undefined;\n        }\n        if (object.contentFilters !== undefined && object.contentFilters !== null) {\n            for (const e of object.contentFilters) {\n                message.contentFilters.push(exports.ContentFilter.fromJSON(e));\n            }\n        }\n        if (object.pagingInfo !== undefined && object.pagingInfo !== null) {\n            message.pagingInfo = exports.PagingInfo.fromJSON(object.pagingInfo);\n        }\n        else {\n            message.pagingInfo = undefined;\n        }\n        if (object.startTime !== undefined && object.startTime !== null) {\n            message.startTime = Number(object.startTime);\n        }\n        else {\n            message.startTime = undefined;\n        }\n        if (object.endTime !== undefined && object.endTime !== null) {\n            message.endTime = Number(object.endTime);\n        }\n        else {\n            message.endTime = undefined;\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.pubsubTopic !== undefined &&\n            (obj.pubsubTopic = message.pubsubTopic);\n        if (message.contentFilters) {\n            obj.contentFilters = message.contentFilters.map((e) => e ? exports.ContentFilter.toJSON(e) : undefined);\n        }\n        else {\n            obj.contentFilters = [];\n        }\n        message.pagingInfo !== undefined &&\n            (obj.pagingInfo = message.pagingInfo\n                ? exports.PagingInfo.toJSON(message.pagingInfo)\n                : undefined);\n        message.startTime !== undefined && (obj.startTime = message.startTime);\n        message.endTime !== undefined && (obj.endTime = message.endTime);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, baseHistoryQuery);\n        message.contentFilters = [];\n        if (object.pubsubTopic !== undefined && object.pubsubTopic !== null) {\n            message.pubsubTopic = object.pubsubTopic;\n        }\n        else {\n            message.pubsubTopic = undefined;\n        }\n        if (object.contentFilters !== undefined && object.contentFilters !== null) {\n            for (const e of object.contentFilters) {\n                message.contentFilters.push(exports.ContentFilter.fromPartial(e));\n            }\n        }\n        if (object.pagingInfo !== undefined && object.pagingInfo !== null) {\n            message.pagingInfo = exports.PagingInfo.fromPartial(object.pagingInfo);\n        }\n        else {\n            message.pagingInfo = undefined;\n        }\n        if (object.startTime !== undefined && object.startTime !== null) {\n            message.startTime = object.startTime;\n        }\n        else {\n            message.startTime = undefined;\n        }\n        if (object.endTime !== undefined && object.endTime !== null) {\n            message.endTime = object.endTime;\n        }\n        else {\n            message.endTime = undefined;\n        }\n        return message;\n    },\n};\nconst baseHistoryResponse = {};\nexports.HistoryResponse = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        for (const v of message.messages) {\n            message_1.WakuMessage.encode(v, writer.uint32(10).fork()).ldelim();\n        }\n        if (message.pagingInfo !== undefined) {\n            exports.PagingInfo.encode(message.pagingInfo, writer.uint32(18).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, baseHistoryResponse);\n        message.messages = [];\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.messages.push(message_1.WakuMessage.decode(reader, reader.uint32()));\n                    break;\n                case 2:\n                    message.pagingInfo = exports.PagingInfo.decode(reader, reader.uint32());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, baseHistoryResponse);\n        message.messages = [];\n        if (object.messages !== undefined && object.messages !== null) {\n            for (const e of object.messages) {\n                message.messages.push(message_1.WakuMessage.fromJSON(e));\n            }\n        }\n        if (object.pagingInfo !== undefined && object.pagingInfo !== null) {\n            message.pagingInfo = exports.PagingInfo.fromJSON(object.pagingInfo);\n        }\n        else {\n            message.pagingInfo = undefined;\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        if (message.messages) {\n            obj.messages = message.messages.map((e) => e ? message_1.WakuMessage.toJSON(e) : undefined);\n        }\n        else {\n            obj.messages = [];\n        }\n        message.pagingInfo !== undefined &&\n            (obj.pagingInfo = message.pagingInfo\n                ? exports.PagingInfo.toJSON(message.pagingInfo)\n                : undefined);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, baseHistoryResponse);\n        message.messages = [];\n        if (object.messages !== undefined && object.messages !== null) {\n            for (const e of object.messages) {\n                message.messages.push(message_1.WakuMessage.fromPartial(e));\n            }\n        }\n        if (object.pagingInfo !== undefined && object.pagingInfo !== null) {\n            message.pagingInfo = exports.PagingInfo.fromPartial(object.pagingInfo);\n        }\n        else {\n            message.pagingInfo = undefined;\n        }\n        return message;\n    },\n};\nconst baseHistoryRPC = { requestId: '' };\nexports.HistoryRPC = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        if (message.requestId !== '') {\n            writer.uint32(10).string(message.requestId);\n        }\n        if (message.query !== undefined) {\n            exports.HistoryQuery.encode(message.query, writer.uint32(18).fork()).ldelim();\n        }\n        if (message.response !== undefined) {\n            exports.HistoryResponse.encode(message.response, writer.uint32(26).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, baseHistoryRPC);\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.requestId = reader.string();\n                    break;\n                case 2:\n                    message.query = exports.HistoryQuery.decode(reader, reader.uint32());\n                    break;\n                case 3:\n                    message.response = exports.HistoryResponse.decode(reader, reader.uint32());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, baseHistoryRPC);\n        if (object.requestId !== undefined && object.requestId !== null) {\n            message.requestId = String(object.requestId);\n        }\n        else {\n            message.requestId = '';\n        }\n        if (object.query !== undefined && object.query !== null) {\n            message.query = exports.HistoryQuery.fromJSON(object.query);\n        }\n        else {\n            message.query = undefined;\n        }\n        if (object.response !== undefined && object.response !== null) {\n            message.response = exports.HistoryResponse.fromJSON(object.response);\n        }\n        else {\n            message.response = undefined;\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.requestId !== undefined && (obj.requestId = message.requestId);\n        message.query !== undefined &&\n            (obj.query = message.query\n                ? exports.HistoryQuery.toJSON(message.query)\n                : undefined);\n        message.response !== undefined &&\n            (obj.response = message.response\n                ? exports.HistoryResponse.toJSON(message.response)\n                : undefined);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, baseHistoryRPC);\n        if (object.requestId !== undefined && object.requestId !== null) {\n            message.requestId = object.requestId;\n        }\n        else {\n            message.requestId = '';\n        }\n        if (object.query !== undefined && object.query !== null) {\n            message.query = exports.HistoryQuery.fromPartial(object.query);\n        }\n        else {\n            message.query = undefined;\n        }\n        if (object.response !== undefined && object.response !== null) {\n            message.response = exports.HistoryResponse.fromPartial(object.response);\n        }\n        else {\n            message.response = undefined;\n        }\n        return message;\n    },\n};\nvar globalThis = (() => {\n    if (typeof globalThis !== 'undefined')\n        return globalThis;\n    if (typeof self !== 'undefined')\n        return self;\n    if (typeof window !== 'undefined')\n        return window;\n    if (typeof global !== 'undefined')\n        return global;\n    throw 'Unable to locate global object';\n})();\nconst atob = globalThis.atob ||\n    ((b64) => globalThis.Buffer.from(b64, 'base64').toString('binary'));\nfunction bytesFromBase64(b64) {\n    const bin = atob(b64);\n    const arr = new Uint8Array(bin.length);\n    for (let i = 0; i < bin.length; ++i) {\n        arr[i] = bin.charCodeAt(i);\n    }\n    return arr;\n}\nconst btoa = globalThis.btoa ||\n    ((bin) => globalThis.Buffer.from(bin, 'binary').toString('base64'));\nfunction base64FromBytes(arr) {\n    const bin = [];\n    for (const byte of arr) {\n        bin.push(String.fromCharCode(byte));\n    }\n    return btoa(bin.join(''));\n}\nfunction longToNumber(long) {\n    if (long.gt(Number.MAX_SAFE_INTEGER)) {\n        throw new globalThis.Error('Value is larger than Number.MAX_SAFE_INTEGER');\n    }\n    return long.toNumber();\n}\nif (minimal_1.default.util.Long !== long_1.default) {\n    minimal_1.default.util.Long = long_1.default;\n    minimal_1.default.configure();\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RvcmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvcHJvdG8vd2FrdS92Mi9zdG9yZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxvQkFBb0I7QUFDcEIsZ0RBQXdCO0FBQ3hCLGlFQUFxQztBQUNyQyxtREFBb0Q7QUFFdkMsUUFBQSxlQUFlLEdBQUcsU0FBUyxDQUFDO0FBYXpDLElBQVksb0JBSVg7QUFKRCxXQUFZLG9CQUFvQjtJQUM5QixtSEFBa0MsQ0FBQTtJQUNsQyx5RkFBcUIsQ0FBQTtJQUNyQixnRkFBaUIsQ0FBQTtBQUNuQixDQUFDLEVBSlcsb0JBQW9CLEdBQXBCLDRCQUFvQixLQUFwQiw0QkFBb0IsUUFJL0I7QUFFRCxTQUFnQiw0QkFBNEIsQ0FDMUMsTUFBVztJQUVYLFFBQVEsTUFBTSxFQUFFO1FBQ2QsS0FBSyxDQUFDLENBQUM7UUFDUCxLQUFLLGdDQUFnQztZQUNuQyxPQUFPLG9CQUFvQixDQUFDLDhCQUE4QixDQUFDO1FBQzdELEtBQUssQ0FBQyxDQUFDO1FBQ1AsS0FBSyxtQkFBbUI7WUFDdEIsT0FBTyxvQkFBb0IsQ0FBQyxpQkFBaUIsQ0FBQztRQUNoRCxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ1IsS0FBSyxjQUFjLENBQUM7UUFDcEI7WUFDRSxPQUFPLG9CQUFvQixDQUFDLFlBQVksQ0FBQztLQUM1QztBQUNILENBQUM7QUFmRCxvRUFlQztBQUVELFNBQWdCLDBCQUEwQixDQUN4QyxNQUE0QjtJQUU1QixRQUFRLE1BQU0sRUFBRTtRQUNkLEtBQUssb0JBQW9CLENBQUMsOEJBQThCO1lBQ3RELE9BQU8sZ0NBQWdDLENBQUM7UUFDMUMsS0FBSyxvQkFBb0IsQ0FBQyxpQkFBaUI7WUFDekMsT0FBTyxtQkFBbUIsQ0FBQztRQUM3QjtZQUNFLE9BQU8sU0FBUyxDQUFDO0tBQ3BCO0FBQ0gsQ0FBQztBQVhELGdFQVdDO0FBeUJELE1BQU0sU0FBUyxHQUFXLEVBQUUsWUFB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","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ChatMessage = exports.protobufPackage = void 0;\n/* eslint-disable */\nconst long_1 = __importDefault(require(\"long\"));\nconst minimal_1 = __importDefault(require(\"protobufjs/minimal\"));\nexports.protobufPackage = 'chat.v2';\nconst baseChatMessage = { timestamp: 0, nick: '' };\nexports.ChatMessage = {\n    encode(message, writer = minimal_1.default.Writer.create()) {\n        if (message.timestamp !== 0) {\n            writer.uint32(8).uint64(message.timestamp);\n        }\n        if (message.nick !== '') {\n            writer.uint32(18).string(message.nick);\n        }\n        if (message.payload.length !== 0) {\n            writer.uint32(26).bytes(message.payload);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof minimal_1.default.Reader ? input : new minimal_1.default.Reader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = Object.assign({}, baseChatMessage);\n        message.payload = new Uint8Array();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.timestamp = longToNumber(reader.uint64());\n                    break;\n                case 2:\n                    message.nick = reader.string();\n                    break;\n                case 3:\n                    message.payload = reader.bytes();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const message = Object.assign({}, baseChatMessage);\n        message.payload = new Uint8Array();\n        if (object.timestamp !== undefined && object.timestamp !== null) {\n            message.timestamp = Number(object.timestamp);\n        }\n        else {\n            message.timestamp = 0;\n        }\n        if (object.nick !== undefined && object.nick !== null) {\n            message.nick = String(object.nick);\n        }\n        else {\n            message.nick = '';\n        }\n        if (object.payload !== undefined && object.payload !== null) {\n            message.payload = bytesFromBase64(object.payload);\n        }\n        return message;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.timestamp !== undefined && (obj.timestamp = message.timestamp);\n        message.nick !== undefined && (obj.nick = message.nick);\n        message.payload !== undefined &&\n            (obj.payload = base64FromBytes(message.payload !== undefined ? message.payload : new Uint8Array()));\n        return obj;\n    },\n    fromPartial(object) {\n        const message = Object.assign({}, baseChatMessage);\n        if (object.timestamp !== undefined && object.timestamp !== null) {\n            message.timestamp = object.timestamp;\n        }\n        else {\n            message.timestamp = 0;\n        }\n        if (object.nick !== undefined && object.nick !== null) {\n            message.nick = object.nick;\n        }\n        else {\n            message.nick = '';\n        }\n        if (object.payload !== undefined && object.payload !== null) {\n            message.payload = object.payload;\n        }\n        else {\n            message.payload = new Uint8Array();\n        }\n        return message;\n    },\n};\nvar globalThis = (() => {\n    if (typeof globalThis !== 'undefined')\n        return globalThis;\n    if (typeof self !== 'undefined')\n        return self;\n    if (typeof window !== 'undefined')\n        return window;\n    if (typeof global !== 'undefined')\n        return global;\n    throw 'Unable to locate global object';\n})();\nconst atob = globalThis.atob ||\n    ((b64) => globalThis.Buffer.from(b64, 'base64').toString('binary'));\nfunction bytesFromBase64(b64) {\n    const bin = atob(b64);\n    const arr = new Uint8Array(bin.length);\n    for (let i = 0; i < bin.length; ++i) {\n        arr[i] = bin.charCodeAt(i);\n    }\n    return arr;\n}\nconst btoa = globalThis.btoa ||\n    ((bin) => globalThis.Buffer.from(bin, 'binary').toString('base64'));\nfunction base64FromBytes(arr) {\n    const bin = [];\n    for (const byte of arr) {\n        bin.push(String.fromCharCode(byte));\n    }\n    return btoa(bin.join(''));\n}\nfunction longToNumber(long) {\n    if (long.gt(Number.MAX_SAFE_INTEGER)) {\n        throw new globalThis.Error('Value is larger than Number.MAX_SAFE_INTEGER');\n    }\n    return long.toNumber();\n}\nif (minimal_1.default.util.Long !== long_1.default) {\n    minimal_1.default.util.Long = long_1.default;\n    minimal_1.default.configure();\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhdF9tZXNzYWdlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL3Byb3RvL2NoYXQvdjIvY2hhdF9tZXNzYWdlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLG9CQUFvQjtBQUNwQixnREFBd0I7QUFDeEIsaUVBQXFDO0FBRXhCLFFBQUEsZUFBZSxHQUFHLFNBQVMsQ0FBQztBQVF6QyxNQUFNLGVBQWUsR0FBVyxFQUFFLFNBQVMsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxDQUFDO0FBRTlDLFFBQUEsV0FBVyxHQUFHO0lBQ3pCLE1BQU0sQ0FDSixPQUFvQixFQUNwQixTQUFxQixpQkFBRyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUU7UUFFeEMsSUFBSSxPQUFPLENBQUMsU0FBUyxLQUFLLENBQUMsRUFBRTtZQUMzQixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDNUM7UUFDRCxJQUFJLE9BQU8sQ0FBQyxJQUFJLEtBQUssRUFBRSxFQUFFO1lBQ3ZCLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUN4QztRQUNELElBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQ2hDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUMxQztRQUNELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFRCxNQUFNLENBQUMsS0FBOEIsRUFBRSxNQUFlO1FBQ3BELE1BQU0sTUFBTSxHQUFHLEtBQUssWUFBWSxpQkFBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLGlC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","export interface Message {\n  text: string;\n  timestamp: Date;\n}\n\nexport interface Props {\n  messages: Message[];\n}\n\nexport function Messages(props: Props) {\n  const messages = props.messages.map((msg) => {\n    return (\n      <li>\n        {formatDisplayDate(msg.timestamp)} {msg.text}\n      </li>\n    );\n  });\n\n  return <ul>{messages}</ul>;\n}\n\nfunction formatDisplayDate(timestamp: Date): string {\n  return timestamp.toLocaleString([], {\n    month: 'short',\n    day: 'numeric',\n    hour: 'numeric',\n    minute: '2-digit',\n    hour12: false,\n  });\n}\n","import {\n  FormControl,\n  InputLabel,\n  makeStyles,\n  MenuItem,\n  Select,\n  TextField,\n} from '@material-ui/core';\nimport React, { ChangeEvent, useState, KeyboardEvent } from 'react';\nimport { Waku, WakuMessage } from 'js-waku';\nimport * as EthCrypto from 'eth-crypto';\nimport { DirectMessage, encode } from './messages';\nimport { DirectMessageContentTopic } from './App';\n\nconst useStyles = makeStyles((theme) => ({\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120,\n  },\n  selectEmpty: {\n    marginTop: theme.spacing(2),\n  },\n}));\n\nexport interface Props {\n  waku: Waku | undefined;\n  // address, public key\n  recipients: Map<string, string>;\n}\n\nexport function SendMessage(props: Props) {\n  const classes = useStyles();\n  const [recipient, setRecipient] = useState<string>('');\n  const [message, setMessage] = useState<string>();\n\n  const waku = props.waku;\n\n  const handleRecipientChange = (\n    event: ChangeEvent<{ name?: string; value: unknown }>\n  ) => {\n    setRecipient(event.target.value as string);\n  };\n\n  const handleMessageChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setMessage(event.target.value);\n  };\n\n  const items = Array.from(props.recipients.keys()).map((recipient) => {\n    return (\n      <MenuItem key={recipient} value={recipient}>\n        {recipient}\n      </MenuItem>\n    );\n  });\n\n  const keyDownHandler = async (event: KeyboardEvent<HTMLInputElement>) => {\n    if (\n      event.key === 'Enter' &&\n      !event.altKey &&\n      !event.ctrlKey &&\n      !event.shiftKey\n    ) {\n      if (!waku) return;\n      if (!recipient) return;\n      if (!message) return;\n      const publicKey = props.recipients.get(recipient);\n      if (!publicKey) return;\n\n      sendMessage(waku, recipient, publicKey, message, (res) => {\n        if (res) {\n          console.log('callback called with', res);\n          setMessage('');\n        }\n      });\n    }\n  };\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        alignItems: 'center',\n        flexWrap: 'wrap',\n      }}\n    >\n      <FormControl className={classes.formControl}>\n        <InputLabel id=\"select-recipient-label\">Recipient</InputLabel>\n        <Select\n          labelId=\"select-recipient\"\n          id=\"select-recipient\"\n          value={recipient}\n          onChange={handleRecipientChange}\n        >\n          {items}\n        </Select>\n      </FormControl>\n      <TextField\n        id=\"message-input\"\n        label=\"Message\"\n        variant=\"filled\"\n        onChange={handleMessageChange}\n        onKeyDown={keyDownHandler}\n        value={message}\n      />\n    </div>\n  );\n}\n\nasync function encodeEncryptedWakuMessage(\n  message: string,\n  publicKey: string,\n  address: string\n): Promise<WakuMessage> {\n  const encryptedMsg = await EthCrypto.encryptWithPublicKey(publicKey, message);\n\n  const directMsg: DirectMessage = {\n    toAddress: address,\n    encMessage: encryptedMsg,\n  };\n\n  const payload = encode(directMsg);\n  return WakuMessage.fromBytes(payload, DirectMessageContentTopic);\n}\n\nfunction sendMessage(\n  waku: Waku,\n  recipientAddress: string,\n  recipientPublicKey: string,\n  message: string,\n  callback: (res: boolean) => void\n) {\n  encodeEncryptedWakuMessage(message, recipientPublicKey, recipientAddress)\n    .then((msg) => {\n      console.log('pushing');\n      waku.lightPush\n        .push(msg)\n        .then((res) => {\n          console.log('Message sent', res);\n          callback(res ? res.isSuccess : false);\n        })\n        .catch((e) => {\n          console.error('Failed to send message', e);\n          callback(false);\n        });\n    })\n    .catch((e) => {\n      console.error('Cannot encode & encrypt message', e);\n      callback(false);\n    });\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getStatusFleetNodes = exports.Environment = exports.Protocol = void 0;\n/**\n * Returns multiaddrs (inc. ip) of nim-waku nodes ran by Status.\n * Used as a temporary discovery helper until more parties run their own nodes.\n */\nconst axios_1 = __importDefault(require(\"axios\"));\nvar Protocol;\n(function (Protocol) {\n    Protocol[\"websocket\"] = \"websocket\";\n    Protocol[\"tcp\"] = \"tcp\";\n})(Protocol = exports.Protocol || (exports.Protocol = {}));\nvar Environment;\n(function (Environment) {\n    Environment[\"Test\"] = \"test\";\n    Environment[\"Prod\"] = \"prod\";\n})(Environment = exports.Environment || (exports.Environment = {}));\nasync function getStatusFleetNodes(env = Environment.Prod, protocol = Protocol.websocket) {\n    const res = await axios_1.default.get('https://fleets.status.im/', {\n        headers: { 'Content-Type': 'application/json' },\n    });\n    const wakuFleet = res.data.fleets[`wakuv2.${env}`];\n    switch (protocol) {\n        case Protocol.tcp:\n            return Object.values(wakuFleet['waku']);\n        default:\n            return Object.values(wakuFleet['waku-websocket']);\n    }\n}\nexports.getStatusFleetNodes = getStatusFleetNodes;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlzY292ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbGliL2Rpc2NvdmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7R0FHRztBQUNILGtEQUEwQjtBQUUxQixJQUFZLFFBR1g7QUFIRCxXQUFZLFFBQVE7SUFDbEIsbUNBQXVCLENBQUE7SUFDdkIsdUJBQVcsQ0FBQTtBQUNiLENBQUMsRUFIVyxRQUFRLEdBQVIsZ0JBQVEsS0FBUixnQkFBUSxRQUduQjtBQUVELElBQVksV0FHWDtBQUhELFdBQVksV0FBVztJQUNyQiw0QkFBYSxDQUFBO0lBQ2IsNEJBQWEsQ0FBQTtBQUNmLENBQUMsRUFIVyxXQUFXLEdBQVgsbUJBQVcsS0FBWCxtQkFBVyxRQUd0QjtBQUVNLEtBQUssVUFBVSxtQkFBbUIsQ0FDdkMsTUFBbUIsV0FBVyxDQUFDLElBQUksRUFDbkMsV0FBcUIsUUFBUSxDQUFDLFNBQVM7SUFFdkMsTUFBTSxHQUFHLEdBQUcsTUFBTSxlQUFLLENBQUMsR0FBRyxDQUFDLDJCQUEyQixFQUFFO1FBQ3ZELE9BQU8sRUFBRSxFQUFFLGNBQWMsRUFBRSxrQkFBa0IsRUFBRTtLQUNoRCxDQUFDLENBQUM7SUFFSCxNQUFNLFNBQVMsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFFbkQsUUFBUSxRQUFRLEVBQUU7UUFDaEIsS0FBSyxRQUFRLENBQUMsR0FBRztZQUNmLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUMxQztZQUNFLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDO0tBQ3JEO0FBQ0gsQ0FBQztBQWhCRCxrREFnQkMifQ==","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Waku = void 0;\nconst libp2p_1 = __importDefault(require(\"libp2p\"));\nconst libp2p_mplex_1 = __importDefault(require(\"libp2p-mplex\"));\nconst noise_1 = require(\"libp2p-noise/dist/src/noise\");\nconst libp2p_websockets_1 = __importDefault(require(\"libp2p-websockets\"));\nconst filters_1 = __importDefault(require(\"libp2p-websockets/src/filters\"));\nconst ping_1 = __importDefault(require(\"libp2p/src/ping\"));\nconst multiaddr_1 = require(\"multiaddr\");\nconst peer_id_1 = __importDefault(require(\"peer-id\"));\nconst waku_light_push_1 = require(\"./waku_light_push\");\nconst waku_relay_1 = require(\"./waku_relay\");\nconst waku_store_1 = require(\"./waku_store\");\nconst websocketsTransportKey = libp2p_websockets_1.default.prototype[Symbol.toStringTag];\nclass Waku {\n    constructor(options, libp2p, store, lightPush) {\n        this.libp2p = libp2p;\n        this.relay = libp2p.pubsub;\n        this.store = store;\n        this.lightPush = lightPush;\n        this.keepAliveTimers = {};\n        const keepAlive = options.keepAlive ? options.keepAlive : 10;\n        libp2p.connectionManager.on('peer:connect', (connection) => {\n            this.startKeepAlive(connection.remotePeer, keepAlive);\n        });\n        libp2p.connectionManager.on('peer:disconnect', (connection) => {\n            this.stopKeepAlive(connection.remotePeer);\n        });\n    }\n    /**\n     * Create new waku node\n     *\n     * @param options Takes the same options than `Libp2p`.\n     */\n    static async create(options) {\n        var _a, _b, _c;\n        // Get an object in case options or libp2p are undefined\n        const libp2pOpts = Object.assign({}, options === null || options === void 0 ? void 0 : options.libp2p);\n        // Default for Websocket filter is `all`:\n        // Returns all TCP and DNS based addresses, both with ws or wss.\n        libp2pOpts.config = Object.assign({\n            transport: {\n                [websocketsTransportKey]: {\n                    filter: filters_1.default.all,\n                },\n            },\n        }, (_a = options === null || options === void 0 ? void 0 : options.libp2p) === null || _a === void 0 ? void 0 : _a.config);\n        // Pass pubsub topic to relay\n        if (options === null || options === void 0 ? void 0 : options.pubsubTopic) {\n            libp2pOpts.config.pubsub = Object.assign({ pubsubTopic: options.pubsubTopic }, libp2pOpts.config.pubsub);\n        }\n        libp2pOpts.modules = Object.assign({}, (_b = options === null || options === void 0 ? void 0 : options.libp2p) === null || _b === void 0 ? void 0 : _b.modules);\n        // Default transport for libp2p is Websockets\n        libp2pOpts.modules = Object.assign({\n            transport: [libp2p_websockets_1.default],\n        }, (_c = options === null || options === void 0 ? void 0 : options.libp2p) === null || _c === void 0 ? void 0 : _c.modules);\n        // streamMuxer, connection encryption and pubsub are overridden\n        // as those are the only ones currently supported by Waku nodes.\n        libp2pOpts.modules = Object.assign(libp2pOpts.modules, {\n            streamMuxer: [libp2p_mplex_1.default],\n            connEncryption: [new noise_1.Noise(options === null || options === void 0 ? void 0 : options.staticNoiseKey)],\n            pubsub: waku_relay_1.WakuRelay,\n        });\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore: modules property is correctly set thanks to voodoo\n        const libp2p = await libp2p_1.default.create(libp2pOpts);\n        const wakuStore = new waku_store_1.WakuStore(libp2p, {\n            pubsubTopic: options === null || options === void 0 ? void 0 : options.pubsubTopic,\n        });\n        const wakuLightPush = new waku_light_push_1.WakuLightPush(libp2p);\n        await libp2p.start();\n        return new Waku(options ? options : {}, libp2p, wakuStore, wakuLightPush);\n    }\n    /**\n     * Dials to the provided peer.\n     *\n     * @param peer The peer to dial\n     */\n    async dial(peer) {\n        return this.libp2p.dialProtocol(peer, [waku_relay_1.RelayCodec, waku_store_1.StoreCodec]);\n    }\n    /**\n     * Add peer to address book, it will be auto-dialed in the background.\n     */\n    addPeerToAddressBook(peerId, multiaddrs) {\n        let peer;\n        if (typeof peerId === 'string') {\n            peer = peer_id_1.default.createFromB58String(peerId);\n        }\n        else {\n            peer = peerId;\n        }\n        const addresses = multiaddrs.map((addr) => {\n            if (typeof addr === 'string') {\n                return multiaddr_1.multiaddr(addr);\n            }\n            else {\n                return addr;\n            }\n        });\n        this.libp2p.peerStore.addressBook.set(peer, addresses);\n    }\n    async stop() {\n        return this.libp2p.stop();\n    }\n    /**\n     * Return the local multiaddr with peer id on which libp2p is listening.\n     * @throws if libp2p is not listening on localhost\n     */\n    getLocalMultiaddrWithID() {\n        const localMultiaddr = this.libp2p.multiaddrs.find((addr) => addr.toString().match(/127\\.0\\.0\\.1/));\n        if (!localMultiaddr || localMultiaddr.toString() === '') {\n            throw 'Not listening on localhost';\n        }\n        return localMultiaddr + '/p2p/' + this.libp2p.peerId.toB58String();\n    }\n    startKeepAlive(peerId, periodSecs) {\n        // Just in case a timer already exist for this peer\n        this.stopKeepAlive(peerId);\n        const peerIdStr = peerId.toB58String();\n        this.keepAliveTimers[peerIdStr] = setInterval(() => {\n            ping_1.default(this.libp2p, peerId);\n        }, periodSecs * 1000);\n    }\n    stopKeepAlive(peerId) {\n        const peerIdStr = peerId.toB58String();\n        if (this.keepAliveTimers[peerIdStr]) {\n            clearInterval(this.keepAliveTimers[peerIdStr]);\n            delete this.keepAliveTimers[peerIdStr];\n        }\n    }\n}\nexports.Waku = Waku;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2FrdS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9saWIvd2FrdS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxvREFBMEU7QUFDMUUsZ0VBQWlDO0FBRWpDLHVEQUFvRDtBQUNwRCwwRUFBMkM7QUFDM0MsNEVBQW9EO0FBQ3BELDJEQUFtQztBQUNuQyx5Q0FBaUQ7QUFDakQsc0RBQTZCO0FBRTdCLHVEQUFrRDtBQUNsRCw2Q0FBcUQ7QUFDckQsNkNBQXFEO0FBRXJELE1BQU0sc0JBQXNCLEdBQUcsMkJBQVUsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBMEN4RSxNQUFhLElBQUk7SUFVZixZQUNFLE9BQXNCLEVBQ3RCLE1BQWMsRUFDZCxLQUFnQixFQUNoQixTQUF3QjtRQUV4QixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztRQUNyQixJQUFJLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQyxNQUE4QixDQUFDO1FBQ25ELElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ25CLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQyxlQUFlLEdBQUcsRUFBRSxDQUFDO1FBRTFCLE1BQU0sU0FBUyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUU3RCxNQUFNLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDLFVBQXNCLEVBQUUsRUFBRTtZQUNyRSxJQUFJLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxVQUFVLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDeEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxNQUFNLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDLGlCQUFpQixFQUFFLENBQUMsVUFBc0IsRUFBRSxFQUFFO1lBQ3hF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","\"use strict\";\n/**\n * @hidden\n * @module\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RelayHeartbeat = void 0;\nconst heartbeat_1 = require(\"libp2p-gossipsub/src/heartbeat\");\nconst utils_1 = require(\"libp2p-gossipsub/src/utils\");\nconst constants = __importStar(require(\"./constants\"));\nconst get_relay_peers_1 = require(\"./get_relay_peers\");\nclass RelayHeartbeat extends heartbeat_1.Heartbeat {\n    /**\n     * @param {Object} gossipsub\n     * @constructor\n     */\n    constructor(gossipsub) {\n        super(gossipsub);\n    }\n    start() {\n        if (this._heartbeatTimer) {\n            return;\n        }\n        const heartbeat = this._heartbeat.bind(this);\n        const timeout = setTimeout(() => {\n            var _a;\n            heartbeat();\n            (_a = this._heartbeatTimer) === null || _a === void 0 ? void 0 : _a.runPeriodically(heartbeat, constants.RelayHeartbeatInterval);\n        }, constants.RelayHeartbeatInitialDelay);\n        this._heartbeatTimer = {\n            _intervalId: undefined,\n            runPeriodically: (fn, period) => {\n                // this._heartbeatTimer cannot be null, it is being assigned.\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                this._heartbeatTimer._intervalId = setInterval(fn, period);\n            },\n            cancel: () => {\n                var _a;\n                clearTimeout(timeout);\n                clearInterval((_a = this._heartbeatTimer) === null || _a === void 0 ? void 0 : _a._intervalId);\n            },\n        };\n    }\n    /**\n     * Unmounts the gossipsub protocol and shuts down every connection\n     * @override\n     * @returns {void}\n     */\n    stop() {\n        if (!this._heartbeatTimer) {\n            return;\n        }\n        this._heartbeatTimer.cancel();\n        this._heartbeatTimer = null;\n    }\n    /**\n     * Maintains the mesh and fanout maps in gossipsub.\n     *\n     * @returns {void}\n     */\n    _heartbeat() {\n        const { D, Dlo, Dhi, Dscore, Dout } = this.gossipsub._options;\n        this.gossipsub.heartbeatTicks++;\n        // cache scores through the heartbeat\n        const scores = new Map();\n        const getScore = (id) => {\n            let s = scores.get(id);\n            if (s === undefined) {\n                s = this.gossipsub.score.score(id);\n                scores.set(id, s);\n            }\n            return s;\n        };\n        // peer id => topic[]\n        const toGraft = new Map();\n        // peer id => topic[]\n        const toPrune = new Map();\n        // peer id => don't px\n        const noPX = new Map();\n        // clean up expired backoffs\n        this.gossipsub._clearBackoff();\n        // clean up peerhave/iasked counters\n        this.gossipsub.peerhave.clear();\n        this.gossipsub.iasked.clear();\n        // apply IWANT request penalties\n        this.gossipsub._applyIwantPenalties();\n        // ensure direct peers are connected\n        this.gossipsub._directConnect();\n        // maintain the mesh for topics we have joined\n        this.gossipsub.mesh.forEach((peers, topic) => {\n            // prune/graft helper functions (defined per topic)\n            const prunePeer = (id) => {\n                this.gossipsub.log('HEARTBEAT: Remove mesh link to %s in %s', id, topic);\n                // update peer score\n                this.gossipsub.score.prune(id, topic);\n                // add prune backoff record\n                this.gossipsub._addBackoff(id, topic);\n                // remove peer from mesh\n                peers.delete(id);\n                // add to toPrune\n                const topics = toPrune.get(id);\n                if (!topics) {\n                    toPrune.set(id, [topic]);\n                }\n                else {\n                    topics.push(topic);\n                }\n            };\n            const graftPeer = (id) => {\n                this.gossipsub.log('HEARTBEAT: Add mesh link to %s in %s', id, topic);\n                // update peer score\n                this.gossipsub.score.graft(id, topic);\n                // add peer to mesh\n                peers.add(id);\n                // add to toGraft\n                const topics = toGraft.get(id);\n                if (!topics) {\n                    toGraft.set(id, [topic]);\n                }\n                else {\n                    topics.push(topic);\n                }\n            };\n            // drop all peers with negative score, without PX\n            peers.forEach((id) => {\n                const score = getScore(id);\n                if (score < 0) {\n                    this.gossipsub.log('HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s', id, score, topic);\n                    prunePeer(id);\n                    noPX.set(id, true);\n                }\n            });\n            // do we have enough peers?\n            if (peers.size < Dlo) {\n                const backoff = this.gossipsub.backoff.get(topic);\n                const ineed = D - peers.size;\n                const peersSet = get_relay_peers_1.getRelayPeers(this.gossipsub, topic, ineed, (id) => {\n                    // filter out mesh peers, direct peers, peers we are backing off, peers with negative score\n                    return (!peers.has(id) &&\n                        !this.gossipsub.direct.has(id) &&\n                        (!backoff || !backoff.has(id)) &&\n                        getScore(id) >= 0);\n                });\n                peersSet.forEach(graftPeer);\n            }\n            // do we have to many peers?\n            if (peers.size > Dhi) {\n                let peersArray = Array.from(peers);\n                // sort by score\n                peersArray.sort((a, b) => getScore(b) - getScore(a));\n                // We keep the first D_score peers by score and the remaining up to D randomly\n                // under the constraint that we keep D_out peers in the mesh (if we have that many)\n                peersArray = peersArray\n                    .slice(0, Dscore)\n                    .concat(utils_1.shuffle(peersArray.slice(Dscore)));\n                // count the outbound peers we are keeping\n                let outbound = 0;\n                peersArray.slice(0, D).forEach((p) => {\n                    if (this.gossipsub.outbound.get(p)) {\n                        outbound++;\n                    }\n                });\n                // if it's less than D_out, bubble up some outbound peers from the random selection\n                if (outbound < Dout) {\n                    const rotate = (i) => {\n                        // rotate the peersArray to the right and put the ith peer in the front\n                        const p = peersArray[i];\n                        for (let j = i; j > 0; j--) {\n                            peersArray[j] = peersArray[j - 1];\n                        }\n                        peersArray[0] = p;\n                    };\n                    // first bubble up all outbound peers already in the selection to the front\n                    if (outbound > 0) {\n                        let ihave = outbound;\n                        for (let i = 1; i < D && ihave > 0; i++) {\n                            if (this.gossipsub.outbound.get(peersArray[i])) {\n                                rotate(i);\n                                ihave--;\n                            }\n                        }\n                    }\n                    // now bubble up enough outbound peers outside the selection to the front\n                    let ineed = D - outbound;\n                    for (let i = D; i < peersArray.length && ineed > 0; i++) {\n                        if (this.gossipsub.outbound.get(peersArray[i])) {\n                            rotate(i);\n                            ineed--;\n                        }\n                    }\n                }\n                // prune the excess peers\n                peersArray.slice(D).forEach(prunePeer);\n            }\n            // do we have enough outbound peers?\n            if (peers.size >= Dlo) {\n                // count the outbound peers we have\n                let outbound = 0;\n                peers.forEach((p) => {\n                    if (this.gossipsub.outbound.get(p)) {\n                        outbound++;\n                    }\n                });\n                // if it's less than D_out, select some peers with outbound connections and graft them\n                if (outbound < Dout) {\n                    const ineed = Dout - outbound;\n                    const backoff = this.gossipsub.backoff.get(topic);\n                    get_relay_peers_1.getRelayPeers(this.gossipsub, topic, ineed, (id) => {\n                        // filter our current mesh peers, direct peers, peers we are backing off, peers with negative score\n                        return (!peers.has(id) &&\n                            !this.gossipsub.direct.has(id) &&\n                            (!backoff || !backoff.has(id)) &&\n                            getScore(id) >= 0);\n                    }).forEach(graftPeer);\n                }\n            }\n            // should we try to improve the mesh with opportunistic grafting?\n            if (this.gossipsub.heartbeatTicks %\n                constants.RelayOpportunisticGraftTicks ===\n                0 &&\n                peers.size > 1) {\n                // Opportunistic grafting works as follows: we check the median score of peers in the\n                // mesh; if this score is below the opportunisticGraftThreshold, we select a few peers at\n                // random with score over the median.\n                // The intention is to (slowly) improve an under performing mesh by introducing good\n                // scoring peers that may have been gossiping at us. This allows us to get out of sticky\n                // situations where we are stuck with poor peers and also recover from churn of good peers.\n                // now compute the median peer score in the mesh\n                const peersList = Array.from(peers).sort((a, b) => getScore(a) - getScore(b));\n                const medianIndex = peers.size / 2;\n                const medianScore = getScore(peersList[medianIndex]);\n                // if the median score is below the threshold, select a better peer (if any) and GRAFT\n                if (medianScore <\n                    this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold) {\n                    const backoff = this.gossipsub.backoff.get(topic);\n                    const peersToGraft = get_relay_peers_1.getRelayPeers(this.gossipsub, topic, constants.RelayOpportunisticGraftPeers, (id) => {\n                        // filter out current mesh peers, direct peers, peers we are backing off, peers below or at threshold\n                        return (peers.has(id) &&\n                            !this.gossipsub.direct.has(id) &&\n                            (!backoff || !backoff.has(id)) &&\n                            getScore(id) > medianScore);\n                    });\n                    peersToGraft.forEach((id) => {\n                        this.gossipsub.log('HEARTBEAT: Opportunistically graft peer %s on topic %s', id, topic);\n                        graftPeer(id);\n                    });\n                }\n            }\n            // 2nd arg are mesh peers excluded from gossip. We have already pushed\n            // messages to them, so its redundant to gossip IHAVEs.\n            this.gossipsub._emitGossip(topic, peers);\n        });\n        // expire fanout for topics we haven't published to in a while\n        const now = this.gossipsub._now();\n        this.gossipsub.lastpub.forEach((lastpub, topic) => {\n            if (lastpub + constants.RelayFanoutTTL < now) {\n                this.gossipsub.fanout.delete(topic);\n                this.gossipsub.lastpub.delete(topic);\n            }\n        });\n        // maintain our fanout for topics we are publishing but we have not joined\n        this.gossipsub.fanout.forEach((fanoutPeers, topic) => {\n            // checks whether our peers are still in the topic and have a score above the publish threshold\n            const topicPeers = this.gossipsub.topics.get(topic);\n            fanoutPeers.forEach((id) => {\n                if (!(topicPeers === null || topicPeers === void 0 ? void 0 : topicPeers.has(id)) ||\n                    getScore(id) <\n                        this.gossipsub._options.scoreThresholds.publishThreshold) {\n                    fanoutPeers.delete(id);\n                }\n            });\n            // do we need more peers?\n            if (fanoutPeers.size < D) {\n                const ineed = D - fanoutPeers.size;\n                const peersSet = get_relay_peers_1.getRelayPeers(this.gossipsub, topic, ineed, (id) => {\n                    // filter out existing fanout peers, direct peers, and peers with score above the publish threshold\n                    return (!fanoutPeers.has(id) &&\n                        !this.gossipsub.direct.has(id) &&\n                        getScore(id) >=\n                            this.gossipsub._options.scoreThresholds.publishThreshold);\n                });\n                peersSet.forEach((id) => {\n                    fanoutPeers.add(id);\n                });\n            }\n            // 2nd arg are fanout peers excluded from gossip.\n            // We have already pushed messages to them, so its redundant to gossip IHAVEs\n            this.gossipsub._emitGossip(topic, fanoutPeers);\n        });\n        // send coalesced GRAFT/PRUNE messages (will piggyback gossip)\n        this.gossipsub._sendGraftPrune(toGraft, toPrune, noPX);\n        // flush pending gossip that wasn't piggybacked above\n        this.gossipsub._flush();\n        // advance the message history window\n        this.gossipsub.messageCache.shift();\n        this.gossipsub.emit('gossipsub:heartbeat');\n    }\n}\nexports.RelayHeartbeat = RelayHeartbeat;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVsYXlfaGVhcnRiZWF0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi93YWt1X3JlbGF5L3JlbGF5X2hlYXJ0YmVhdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBR0gsOERBQTJEO0FBQzNELHNEQUFxRDtBQUVyRCx1REFBeUM7QUFDekMsdURBQWtEO0FBRWxELE1BQWEsY0FBZSxTQUFRLHFCQUFTO0lBQzNDOzs7T0FHRztJQUNILFlBQVksU0FBb0I7UUFDOUIsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ25CLENBQUM7SUFFRCxLQUFLO1FBQ0gsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO1lBQ3hCLE9BQU87U0FDUjtRQUVELE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRTdDLE1BQU0sT0FBTyxHQUFHLFVBQVUsQ0FBQyxHQUFHLEVBQUU7O1lBQzlCLFNBQVMsRUFBRSxDQUFDO1lBQ1osTUFBQSxJQUFJLENBQUMsZUFBZSwwQ0FBRSxlQUFlLENBQ25DLFNBQVMsRUFDVCxTQUFTLENBQUMsc0JBQXNCLENBQ2pDLENBQUM7UUFDSixDQUFDLEVBQUUsU0FBUyxDQUFDLDBCQUEwQixDQUFDLENBQUM7UUFFekMsSUFBSSxDQUFDLGVBQWUsR0FBRztZQUNyQixXQUFXLEVBQUUsU0FBUztZQUN0QixlQUFlLEVBQUUsQ0FBQyxFQUFFLEVBQUUsTUFBTSxFQUFRLEVBQUU7Z0JBQ3BDLDZEQUE2RDtnQkFDN0Qsb0VBQW9FO2dCQUNwRSxJQUFJLENBQUMsZUFBZ0IsQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUM5RCxDQUFDO1lBQ0QsTUFBTSxFQUFFLEdBQVMsRUFBRTs7Z0JBQ2pCLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQztnQkFD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","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PushRPC = void 0;\nconst minimal_1 = require(\"protobufjs/minimal\");\nconst uuid_1 = require(\"uuid\");\nconst proto = __importStar(require(\"../../proto/waku/v2/light_push\"));\nconst waku_relay_1 = require(\"../waku_relay\");\nclass PushRPC {\n    constructor(proto) {\n        this.proto = proto;\n    }\n    static createRequest(message, pubsubTopic = waku_relay_1.DefaultPubsubTopic) {\n        return new PushRPC({\n            requestId: uuid_1.v4(),\n            request: {\n                message: message.proto,\n                pubsubTopic,\n            },\n            response: undefined,\n        });\n    }\n    static decode(bytes) {\n        const res = proto.PushRPC.decode(minimal_1.Reader.create(bytes));\n        return new PushRPC(res);\n    }\n    encode() {\n        return proto.PushRPC.encode(this.proto).finish();\n    }\n    get query() {\n        return this.proto.request;\n    }\n    get response() {\n        return this.proto.response;\n    }\n}\nexports.PushRPC = PushRPC;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHVzaF9ycGMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL3dha3VfbGlnaHRfcHVzaC9wdXNoX3JwYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsZ0RBQTRDO0FBQzVDLCtCQUFrQztBQUVsQyxzRUFBd0Q7QUFFeEQsOENBQW1EO0FBRW5ELE1BQWEsT0FBTztJQUNsQixZQUEwQixLQUFvQjtRQUFwQixVQUFLLEdBQUwsS0FBSyxDQUFlO0lBQUcsQ0FBQztJQUVsRCxNQUFNLENBQUMsYUFBYSxDQUNsQixPQUFvQixFQUNwQixjQUFzQiwrQkFBa0I7UUFFeEMsT0FBTyxJQUFJLE9BQU8sQ0FBQztZQUNqQixTQUFTLEVBQUUsU0FBSSxFQUFFO1lBQ2pCLE9BQU8sRUFBRTtnQkFDUCxPQUFPLEVBQUUsT0FBTyxDQUFDLEtBQUs7Z0JBQ3RCLFdBQVc7YUFDWjtZQUNELFFBQVEsRUFBRSxTQUFTO1NBQ3BCLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQWlCO1FBQzdCLE1BQU0sR0FBRyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLGdCQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDdkQsT0FBTyxJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUMxQixDQUFDO0lBRUQsTUFBTTtRQUNKLE9BQU8sS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQ25ELENBQUM7SUFFRCxJQUFJLEtBQUs7UUFDUCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDO0lBQzVCLENBQUM7SUFFRCxJQUFJLFFBQVE7UUFDVixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDO0lBQzdCLENBQUM7Q0FDRjtBQWpDRCwwQkFpQ0MifQ==","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HistoryRPC = exports.Direction = void 0;\nconst minimal_1 = require(\"protobufjs/minimal\");\nconst uuid_1 = require(\"uuid\");\nconst proto = __importStar(require(\"../../proto/waku/v2/store\"));\nvar Direction;\n(function (Direction) {\n    Direction[\"BACKWARD\"] = \"backward\";\n    Direction[\"FORWARD\"] = \"forward\";\n})(Direction = exports.Direction || (exports.Direction = {}));\nclass HistoryRPC {\n    constructor(proto) {\n        this.proto = proto;\n    }\n    /**\n     * Create History Query.\n     */\n    static createQuery(options) {\n        const direction = directionToProto(options.direction);\n        const pagingInfo = {\n            pageSize: options.pageSize,\n            cursor: options.cursor,\n            direction,\n        };\n        const contentFilters = options.contentTopics.map((contentTopic) => {\n            return { contentTopic };\n        });\n        return new HistoryRPC({\n            requestId: uuid_1.v4(),\n            query: {\n                pubsubTopic: options.pubsubTopic,\n                contentFilters,\n                pagingInfo,\n                startTime: undefined,\n                endTime: undefined,\n            },\n            response: undefined,\n        });\n    }\n    static decode(bytes) {\n        const res = proto.HistoryRPC.decode(minimal_1.Reader.create(bytes));\n        return new HistoryRPC(res);\n    }\n    encode() {\n        return proto.HistoryRPC.encode(this.proto).finish();\n    }\n    get query() {\n        return this.proto.query;\n    }\n    get response() {\n        return this.proto.response;\n    }\n}\nexports.HistoryRPC = HistoryRPC;\nfunction directionToProto(direction) {\n    switch (direction) {\n        case Direction.BACKWARD:\n            return proto.PagingInfo_Direction.DIRECTION_BACKWARD_UNSPECIFIED;\n        case Direction.FORWARD:\n            return proto.PagingInfo_Direction.DIRECTION_FORWARD;\n        default:\n            return proto.PagingInfo_Direction.DIRECTION_BACKWARD_UNSPECIFIED;\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlzdG9yeV9ycGMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL3dha3Vfc3RvcmUvaGlzdG9yeV9ycGMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLGdEQUE0QztBQUM1QywrQkFBa0M7QUFFbEMsaUVBQW1EO0FBRW5ELElBQVksU0FHWDtBQUhELFdBQVksU0FBUztJQUNuQixrQ0FBcUIsQ0FBQTtJQUNyQixnQ0FBbUIsQ0FBQTtBQUNyQixDQUFDLEVBSFcsU0FBUyxHQUFULGlCQUFTLEtBQVQsaUJBQVMsUUFHcEI7QUFVRCxNQUFhLFVBQVU7SUFDckIsWUFBMEIsS0FBdUI7UUFBdkIsVUFBSyxHQUFMLEtBQUssQ0FBa0I7SUFBRyxDQUFDO0lBRXJEOztPQUVHO0lBQ0gsTUFBTSxDQUFDLFdBQVcsQ0FBQyxPQUFnQjtRQUNqQyxNQUFNLFNBQVMsR0FBRyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDdEQsTUFBTSxVQUFVLEdBQUc7WUFDakIsUUFBUSxFQUFFLE9BQU8sQ0FBQyxRQUFRO1lBQzFCLE1BQU0sRUFBRSxPQUFPLENBQUMsTUFBTTtZQUN0QixTQUFTO1NBQ1YsQ0FBQztRQUVGLE1BQU0sY0FBYyxHQUFHLE9BQU8sQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUMsWUFBWSxFQUFFLEVBQUU7WUFDaEUsT0FBTyxFQUFFLFlBQVksRUFBRSxDQUFDO1FBQzFCLENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxJQUFJLFVBQVUsQ0FBQztZQUNwQixTQUFTLEVBQUUsU0FBSSxFQUFFO1lBQ2pCLEtBQUssRUFBRTtnQkFDTCxXQUFXLEVBQUUsT0FBTyxDQUFDLFdBQVc7Z0JBQ2hDLGNBQWM7Z0JBQ2QsVUFBVTtnQkFDVixTQUFTLEVBQUUsU0FBUztnQkFDcEIsT0FBTyxFQUFFLFNBQVM7YUFDbkI7WUFDRCxRQUFRLEVBQUUsU0FBUztTQUNwQixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFpQjtRQUM3QixNQUFNLEdBQUcsR0FBRyxLQUFLLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxnQkFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzFELE9BQU8sSUFBSSxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVELE1BQU07UUFDSixPQUFPLEtBQUssQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUN0RCxDQUFDO0lBRUQsSUFBSSxLQUFLO1FBQ1AsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQztJQUMxQixDQUFDO0lBRUQsSUFBSSxRQUFRO1FBQ1YsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQztJQUM3QixDQUFDO0NBQ0Y7QUEvQ0QsZ0NBK0NDO0FBRUQsU0FBUyxnQkFBZ0IsQ0FBQyxTQUFvQjtJQUM1QyxRQUFRLFNBQVMsRUFBRTtRQUNqQixLQUFLLFNBQVMsQ0FBQyxRQUFRO1lBQ3JCLE9BQU8sS0FBSyxDQUFDLG9CQUFvQixDQUFDLDhCQUE4QixDQUFDO1FBQ25FLEtBQUssU0FBUyxDQUFDLE9BQU87WUFDcEIsT0FBTyxLQUFLLENBQUMsb0JBQW9CLENBQUMsaUJBQWlCLENBQUM7UUFDdEQ7WUFDRSxPQUFPLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyw4QkFBOEIsQ0FBQztLQUNwRTtBQUNILENBQUMifQ==","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ChatMessage = void 0;\nconst minimal_1 = require(\"protobufjs/minimal\");\nconst proto = __importStar(require(\"../../proto/chat/v2/chat_message\"));\n/**\n * ChatMessage is used by the various show case waku apps that demonstrates\n * waku used as the network layer for chat group applications.\n *\n * This is included to help building PoC and MVPs. Apps that aim to be\n * production ready should use a more appropriate data structure.\n */\nclass ChatMessage {\n    constructor(proto) {\n        this.proto = proto;\n    }\n    /**\n     * Create Chat Message with a utf-8 string as payload.\n     */\n    static fromUtf8String(timestamp, nick, text) {\n        const timestampNumber = Math.floor(timestamp.valueOf() / 1000);\n        const payload = Buffer.from(text, 'utf-8');\n        return new ChatMessage({\n            timestamp: timestampNumber,\n            nick,\n            payload,\n        });\n    }\n    /**\n     * Decode a protobuf payload to a ChatMessage.\n     * @param bytes The payload to decode.\n     */\n    static decode(bytes) {\n        const protoMsg = proto.ChatMessage.decode(minimal_1.Reader.create(bytes));\n        return new ChatMessage(protoMsg);\n    }\n    /**\n     * Encode this ChatMessage to a byte array, to be used as a protobuf payload.\n     * @returns The encoded payload.\n     */\n    encode() {\n        return proto.ChatMessage.encode(this.proto).finish();\n    }\n    get timestamp() {\n        return new Date(this.proto.timestamp * 1000);\n    }\n    get nick() {\n        return this.proto.nick;\n    }\n    get payloadAsUtf8() {\n        if (!this.proto.payload) {\n            return '';\n        }\n        return Array.from(this.proto.payload)\n            .map((char) => {\n            return String.fromCharCode(char);\n        })\n            .join('');\n    }\n}\nexports.ChatMessage = ChatMessage;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL2NoYXRfbWVzc2FnZS9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsZ0RBQTRDO0FBRTVDLHdFQUEwRDtBQUUxRDs7Ozs7O0dBTUc7QUFDSCxNQUFhLFdBQVc7SUFDdEIsWUFBMEIsS0FBd0I7UUFBeEIsVUFBSyxHQUFMLEtBQUssQ0FBbUI7SUFBRyxDQUFDO0lBRXREOztPQUVHO0lBQ0gsTUFBTSxDQUFDLGNBQWMsQ0FDbkIsU0FBZSxFQUNmLElBQVksRUFDWixJQUFZO1FBRVosTUFBTSxlQUFlLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUM7UUFDL0QsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFM0MsT0FBTyxJQUFJLFdBQVcsQ0FBQztZQUNyQixTQUFTLEVBQUUsZUFBZTtZQUMxQixJQUFJO1lBQ0osT0FBTztTQUNSLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7O09BR0c7SUFDSCxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQWlCO1FBQzdCLE1BQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLGdCQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDaEUsT0FBTyxJQUFJLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNuQyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsTUFBTTtRQUNKLE9BQU8sS0FBSyxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQ3ZELENBQUM7SUFFRCxJQUFJLFNBQVM7UUFDWCxPQUFPLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxDQUFDO0lBQy9DLENBQUM7SUFFRCxJQUFJLElBQUk7UUFDTixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxJQUFJLGFBQWE7UUFDZixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUU7WUFDdkIsT0FBTyxFQUFFLENBQUM7U0FDWDtRQUVELE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQzthQUNsQyxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUNaLE9BQU8sTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNuQyxDQUFDLENBQUM7YUFDRCxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDZCxDQUFDO0NBQ0Y7QUF6REQsa0NBeURDIn0=","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HistoryRPC = exports.HistoryResponse = exports.HistoryQuery = exports.ContentFilter = exports.PagingInfo_Direction = exports.PagingInfo = exports.Index = exports.WakuMessage = exports.ChatMessage = void 0;\nvar chat_message_1 = require(\"./chat/v2/chat_message\");\nObject.defineProperty(exports, \"ChatMessage\", { enumerable: true, get: function () { return chat_message_1.ChatMessage; } });\nvar message_1 = require(\"./waku/v2/message\");\nObject.defineProperty(exports, \"WakuMessage\", { enumerable: true, get: function () { return message_1.WakuMessage; } });\nvar store_1 = require(\"./waku/v2/store\");\nObject.defineProperty(exports, \"Index\", { enumerable: true, get: function () { return store_1.Index; } });\nObject.defineProperty(exports, \"PagingInfo\", { enumerable: true, get: function () { return store_1.PagingInfo; } });\nObject.defineProperty(exports, \"PagingInfo_Direction\", { enumerable: true, get: function () { return store_1.PagingInfo_Direction; } });\nObject.defineProperty(exports, \"ContentFilter\", { enumerable: true, get: function () { return store_1.ContentFilter; } });\nObject.defineProperty(exports, \"HistoryQuery\", { enumerable: true, get: function () { return store_1.HistoryQuery; } });\nObject.defineProperty(exports, \"HistoryResponse\", { enumerable: true, get: function () { return store_1.HistoryResponse; } });\nObject.defineProperty(exports, \"HistoryRPC\", { enumerable: true, get: function () { return store_1.HistoryRPC; } });\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvcHJvdG8vaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsdURBQXFEO0FBQTVDLDJHQUFBLFdBQVcsT0FBQTtBQUVwQiw2Q0FBZ0Q7QUFBdkMsc0dBQUEsV0FBVyxPQUFBO0FBRXBCLHlDQVF5QjtBQVB2Qiw4RkFBQSxLQUFLLE9BQUE7QUFDTCxtR0FBQSxVQUFVLE9BQUE7QUFDViw2R0FBQSxvQkFBb0IsT0FBQTtBQUNwQixzR0FBQSxhQUFhLE9BQUE7QUFDYixxR0FBQSxZQUFZLE9BQUE7QUFDWix3R0FBQSxlQUFlLE9BQUE7QUFDZixtR0FBQSxVQUFVLE9BQUEifQ==","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.proto = exports.StoreCodec = exports.WakuStore = exports.Direction = exports.RelayCodec = exports.WakuRelay = exports.PushResponse = exports.LightPushCodec = exports.WakuLightPush = exports.ChatMessage = exports.WakuMessage = exports.Waku = exports.Protocol = exports.Environment = exports.getStatusFleetNodes = void 0;\nvar discover_1 = require(\"./lib/discover\");\nObject.defineProperty(exports, \"getStatusFleetNodes\", { enumerable: true, get: function () { return discover_1.getStatusFleetNodes; } });\nObject.defineProperty(exports, \"Environment\", { enumerable: true, get: function () { return discover_1.Environment; } });\nObject.defineProperty(exports, \"Protocol\", { enumerable: true, get: function () { return discover_1.Protocol; } });\nvar waku_1 = require(\"./lib/waku\");\nObject.defineProperty(exports, \"Waku\", { enumerable: true, get: function () { return waku_1.Waku; } });\nvar waku_message_1 = require(\"./lib/waku_message\");\nObject.defineProperty(exports, \"WakuMessage\", { enumerable: true, get: function () { return waku_message_1.WakuMessage; } });\nvar chat_message_1 = require(\"./lib/chat_message\");\nObject.defineProperty(exports, \"ChatMessage\", { enumerable: true, get: function () { return chat_message_1.ChatMessage; } });\nvar waku_light_push_1 = require(\"./lib/waku_light_push\");\nObject.defineProperty(exports, \"WakuLightPush\", { enumerable: true, get: function () { return waku_light_push_1.WakuLightPush; } });\nObject.defineProperty(exports, \"LightPushCodec\", { enumerable: true, get: function () { return waku_light_push_1.LightPushCodec; } });\nObject.defineProperty(exports, \"PushResponse\", { enumerable: true, get: function () { return waku_light_push_1.PushResponse; } });\nvar waku_relay_1 = require(\"./lib/waku_relay\");\nObject.defineProperty(exports, \"WakuRelay\", { enumerable: true, get: function () { return waku_relay_1.WakuRelay; } });\nObject.defineProperty(exports, \"RelayCodec\", { enumerable: true, get: function () { return waku_relay_1.RelayCodec; } });\nvar waku_store_1 = require(\"./lib/waku_store\");\nObject.defineProperty(exports, \"Direction\", { enumerable: true, get: function () { return waku_store_1.Direction; } });\nObject.defineProperty(exports, \"WakuStore\", { enumerable: true, get: function () { return waku_store_1.WakuStore; } });\nObject.defineProperty(exports, \"StoreCodec\", { enumerable: true, get: function () { return waku_store_1.StoreCodec; } });\nexports.proto = __importStar(require(\"./proto\"));\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJDQUE0RTtBQUFuRSwrR0FBQSxtQkFBbUIsT0FBQTtBQUFFLHVHQUFBLFdBQVcsT0FBQTtBQUFFLG9HQUFBLFFBQVEsT0FBQTtBQUVuRCxtQ0FBa0M7QUFBekIsNEZBQUEsSUFBSSxPQUFBO0FBQ2IsbURBQWlEO0FBQXhDLDJHQUFBLFdBQVcsT0FBQTtBQUVwQixtREFBaUQ7QUFBeEMsMkdBQUEsV0FBVyxPQUFBO0FBRXBCLHlEQUkrQjtBQUg3QixnSEFBQSxhQUFhLE9BQUE7QUFDYixpSEFBQSxjQUFjLE9BQUE7QUFDZCwrR0FBQSxZQUFZLE9BQUE7QUFHZCwrQ0FBeUQ7QUFBaEQsdUdBQUEsU0FBUyxPQUFBO0FBQUUsd0dBQUEsVUFBVSxPQUFBO0FBRTlCLCtDQUFvRTtBQUEzRCx1R0FBQSxTQUFTLE9BQUE7QUFBRSx1R0FBQSxTQUFTLE9BQUE7QUFBRSx3R0FBQSxVQUFVLE9BQUE7QUFFekMsaURBQWlDIn0="],"sourceRoot":""}