(this["webpackJsonpeth-pm-wallet-encryption"]=this["webpackJsonpeth-pm-wallet-encryption"]||[]).push([[0],{108:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return l}));var n=r(5),i=r(6),o=r(204),s=o.Root,a=o.Type,u=o.Field,c=function(){function e(t){Object(n.a)(this,e),this.payload=t}return Object(i.a)(e,[{key:"encode",value:function(){var t=e.Type.create(this.payload);return e.Type.encode(t).finish()}},{key:"encryptionPublicKey",get:function(){return this.payload.encryptionPublicKey}},{key:"ethAddress",get:function(){return this.payload.ethAddress}},{key:"signature",get:function(){return this.payload.signature}}],[{key:"decode",value:function(t){var r=e.Type.decode(t);if(r.signature&&r.encryptionPublicKey&&r.ethAddress)return new e(r);console.log("Field missing on decoded Public Key Message",r)}}]),e}();c.Type=new a("PublicKeyMessage").add(new u("encryptionPublicKey",1,"bytes")).add(new u("ethAddress",2,"bytes")).add(new u("signature",3,"bytes")),c.Root=(new s).define("messages").add(c.Type);var l=function(){function e(t){Object(n.a)(this,e),this.payload=t}return Object(i.a)(e,[{key:"encode",value:function(){var t=e.Type.create(this.payload);return e.Type.encode(t).finish()}},{key:"toAddress",get:function(){return this.payload.toAddress}},{key:"message",get:function(){return this.payload.message}}],[{key:"decode",value:function(t){var r=e.Type.decode(t);if(r.toAddress&&r.message)return new e(r);console.log("Field missing on decoded PrivateMessage",r)}}]),e}();l.Type=new a("PrivateMessage").add(new u("toAddress",1,"bytes")).add(new u("message",2,"string")),l.Root=(new s).define("messages").add(l.Type)},128:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.proto=t.StoreCodec=t.WakuStore=t.PageDirection=t.RelayCodecs=t.WakuRelay=t.PushResponse=t.LightPushCodec=t.WakuLightPush=t.getPublicKey=t.generateSymmetricKey=t.generatePrivateKey=t.WakuMessage=t.DefaultPubSubTopic=t.Waku=t.utils=t.getBootstrapNodes=void 0;var s=r(321);Object.defineProperty(t,"getBootstrapNodes",{enumerable:!0,get:function(){return s.getBootstrapNodes}}),t.utils=o(r(45));var a=r(169);Object.defineProperty(t,"Waku",{enumerable:!0,get:function(){return a.Waku}}),Object.defineProperty(t,"DefaultPubSubTopic",{enumerable:!0,get:function(){return a.DefaultPubSubTopic}});var u=r(189);Object.defineProperty(t,"WakuMessage",{enumerable:!0,get:function(){return u.WakuMessage}});var c=r(408);Object.defineProperty(t,"generatePrivateKey",{enumerable:!0,get:function(){return c.generatePrivateKey}}),Object.defineProperty(t,"generateSymmetricKey",{enumerable:!0,get:function(){return c.generateSymmetricKey}}),Object.defineProperty(t,"getPublicKey",{enumerable:!0,get:function(){return c.getPublicKey}});var l=r(405);Object.defineProperty(t,"WakuLightPush",{enumerable:!0,get:function(){return l.WakuLightPush}}),Object.defineProperty(t,"LightPushCodec",{enumerable:!0,get:function(){return l.LightPushCodec}}),Object.defineProperty(t,"PushResponse",{enumerable:!0,get:function(){return l.PushResponse}});var d=r(266);Object.defineProperty(t,"WakuRelay",{enumerable:!0,get:function(){return d.WakuRelay}}),Object.defineProperty(t,"RelayCodecs",{enumerable:!0,get:function(){return d.RelayCodecs}});var f=r(445);Object.defineProperty(t,"PageDirection",{enumerable:!0,get:function(){return f.PageDirection}}),Object.defineProperty(t,"WakuStore",{enumerable:!0,get:function(){return f.WakuStore}}),Object.defineProperty(t,"StoreCodec",{enumerable:!0,get:function(){return f.StoreCodec}}),t.proto=o(r(918))},169:function(e,t,r){"use strict";var n=r(77),i=r(1),o=r(10),s=r(9),a=r(11),u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Waku=t.DefaultPubSubTopic=t.DefaultRelayKeepAliveValueSecs=t.DefaultPingKeepAliveValueSecs=void 0;var c=r(606),l=u(r(21)),d=u(r(711)),f=u(r(824)),p=u(r(825)),v=u(r(831)),g=u(r(404)),b=u(r(398)),h=r(46),y=u(r(32)),m=r(321),P=r(255),O=r(405),k=r(189),T=r(266),S=r(193),R=r(445),j=v.default.prototype[Symbol.toStringTag];t.DefaultPingKeepAliveValueSecs=0,t.DefaultRelayKeepAliveValueSecs=300,t.DefaultPubSubTopic="/waku/2/default-waku/proto";var _=l.default("waku:waku"),w=function(){function e(r,n,i,o){var a,u=this;s(this,e),this.libp2p=n,this.relay=n.pubsub,this.store=i,this.lightPush=o,this.pingKeepAliveTimers={},this.relayKeepAliveTimers={};var c=r.pingKeepAlive||t.DefaultPingKeepAliveValueSecs,l=r.relayKeepAlive||t.DefaultRelayKeepAliveValueSecs;n.connectionManager.on("peer:connect",(function(e){u.startKeepAlive(e.remotePeer,c,l)})),n.connectionManager.on("peer:disconnect",(function(e){u.stopKeepAlive(e.remotePeer)})),null===(a=null===r||void 0===r?void 0:r.decryptionKeys)||void 0===a||a.forEach(this.addDecryptionKey)}return a(e,[{key:"dial",value:function(){var e=o(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.libp2p.dialProtocol(t,[R.StoreCodec].concat(T.RelayCodecs)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addPeerToAddressBook",value:function(e,t){var r;r="string"===typeof e?y.default.createFromB58String(e):e;var n=t.map((function(e){return"string"===typeof e?h.multiaddr(e):e}));this.libp2p.peerStore.addressBook.set(r,n)}},{key:"stop",value:function(){var e=o(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.libp2p.stop());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addDecryptionKey",value:function(e){this.relay.addDecryptionKey(e),this.store.addDecryptionKey(e)}},{key:"deleteDecryptionKey",value:function(e){this.relay.deleteDecryptionKey(e),this.store.deleteDecryptionKey(e)}},{key:"getLocalMultiaddrWithID",value:function(){var e=this.libp2p.multiaddrs.find((function(e){return e.toString().match(/127\.0\.0\.1/)}));if(!e||""===e.toString())throw"Not listening on localhost";return e+"/p2p/"+this.libp2p.peerId.toB58String()}},{key:"waitForConnectedPeer",value:function(){var e=o(i.mark((function e(){var t,r=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[[R.StoreCodec],[O.LightPushCodec],T.RelayCodecs],e.next=3,Promise.all(t.map((function(e){var t=new Array;return e.forEach((function(e){P.getPeersForProtocol(r.libp2p,e).forEach((function(e){return t.push(e)}))})),t.length>0?Promise.resolve():new Promise((function(t){r.libp2p.peerStore.on("change:protocols",(function(r){var n=r.protocols;e.forEach((function(e){n.includes(e)&&(_("Resolving for",e,n),t())}))}))}))})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"startKeepAlive",value:function(e,t,r){var n=this;this.stopKeepAlive(e);var i=e.toB58String();0!==t&&(this.pingKeepAliveTimers[i]=setInterval((function(){b.default(n.libp2p,e)}),1e3*t)),0!==r&&(this.relayKeepAliveTimers[i]=setInterval((function(){k.WakuMessage.fromBytes(new Uint8Array,S.RelayPingContentTopic).then((function(e){return n.relay.send(e)}))}),1e3*r))}},{key:"stopKeepAlive",value:function(e){var t=e.toB58String();this.pingKeepAliveTimers[t]&&(clearInterval(this.pingKeepAliveTimers[t]),delete this.pingKeepAliveTimers[t]),this.relayKeepAliveTimers[t]&&(clearInterval(this.relayKeepAliveTimers[t]),delete this.relayKeepAliveTimers[t])}}],[{key:"create",value:function(){var t=o(i.mark((function t(r){var o,s,a,u,l,b,h,y,P;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((u=Object.assign({},null===r||void 0===r?void 0:r.libp2p)).config=Object.assign({transport:n({},j,{filter:g.default.all})},null===(o=null===r||void 0===r?void 0:r.libp2p)||void 0===o?void 0:o.config),(null===r||void 0===r?void 0:r.pubSubTopic)&&(u.config.pubsub=Object.assign({pubSubTopic:r.pubSubTopic},u.config.pubsub)),u.modules=Object.assign({},null===(s=null===r||void 0===r?void 0:r.libp2p)||void 0===s?void 0:s.modules),u.modules=Object.assign({transport:[v.default]},null===(a=null===r||void 0===r?void 0:r.libp2p)||void 0===a?void 0:a.modules),u.modules=Object.assign(u.modules,{streamMuxer:[p.default],connEncryption:[new c.Noise(null===r||void 0===r?void 0:r.staticNoiseKey)],pubsub:T.WakuRelay}),!(null===r||void 0===r?void 0:r.bootstrap)){t.next=20;break}if(!0===r.bootstrap?l=m.getBootstrapNodes:Array.isArray(r.bootstrap)?l=function(){return r.bootstrap}:"function"===typeof r.bootstrap&&(l=r.bootstrap),void 0===l){t.next=20;break}return t.prev=9,t.next=12,l();case 12:b=t.sent,u.modules=Object.assign(u.modules,{peerDiscovery:[f.default]}),u.config.peerDiscovery=n({},f.default.tag,{list:b,enabled:!0}),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(9),_("Failed to retrieve bootstrap nodes",t.t0);case 20:return t.next=22,d.default.create(u);case 22:return h=t.sent,y=new R.WakuStore(h,{pubSubTopic:null===r||void 0===r?void 0:r.pubSubTopic}),P=new O.WakuLightPush(h),t.next=27,h.start();case 27:return t.abrupt("return",new e(r||{},h,y,P));case 28:case"end":return t.stop()}}),t,null,[[9,17]])})));return function(e){return t.apply(this,arguments)}}()}]),e}();t.Waku=w},188:function(e,t,r){"use strict";(function(e){var n=r(23),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WakuMessage=t.protobufPackage=void 0;var o=i(r(256)),s=i(r(53));t.protobufPackage="waku.v2";var a={};t.WakuMessage={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.default.Writer.create();return void 0!==e.payload&&t.uint32(10).bytes(e.payload),void 0!==e.contentTopic&&t.uint32(18).string(e.contentTopic),void 0!==e.version&&t.uint32(24).uint32(e.version),void 0!==e.timestamp&&t.uint32(33).double(e.timestamp),t},decode:function(e,t){for(var r=e instanceof s.default.Reader?e:new s.default.Reader(e),n=void 0===t?r.len:r.pos+t,i=Object.assign({},a);r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:i.payload=r.bytes();break;case 2:i.contentTopic=r.string();break;case 3:i.version=r.uint32();break;case 4:i.timestamp=r.double();break;default:r.skipType(7&o)}}return i},fromJSON:function(e){var t=Object.assign({},a);return void 0!==e.payload&&null!==e.payload&&(t.payload=function(e){for(var t=c(e),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}(e.payload)),void 0!==e.contentTopic&&null!==e.contentTopic?t.contentTopic=String(e.contentTopic):t.contentTopic=void 0,void 0!==e.version&&null!==e.version?t.version=Number(e.version):t.version=void 0,void 0!==e.timestamp&&null!==e.timestamp?t.timestamp=Number(e.timestamp):t.timestamp=void 0,t},toJSON:function(e){var t={};return void 0!==e.payload&&(t.payload=void 0!==e.payload?function(e){var t,r=[],i=n(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.push(String.fromCharCode(o))}}catch(s){i.e(s)}finally{i.f()}return l(r.join(""))}(e.payload):void 0),void 0!==e.contentTopic&&(t.contentTopic=e.contentTopic),void 0!==e.version&&(t.version=e.version),void 0!==e.timestamp&&(t.timestamp=e.timestamp),t},fromPartial:function(e){var t=Object.assign({},a);return void 0!==e.payload&&null!==e.payload?t.payload=e.payload:t.payload=void 0,void 0!==e.contentTopic&&null!==e.contentTopic?t.contentTopic=e.contentTopic:t.contentTopic=void 0,void 0!==e.version&&null!==e.version?t.version=e.version:t.version=void 0,void 0!==e.timestamp&&null!==e.timestamp?t.timestamp=e.timestamp:t.timestamp=void 0,t}};var u=function(){if("undefined"!==typeof u)return u;if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof e)return e;throw"Unable to locate global object"}(),c=u.atob||function(e){return u.Buffer.from(e,"base64").toString("binary")};var l=u.btoa||function(e){return u.Buffer.from(e,"binary").toString("base64")};s.default.util.Long!==o.default&&(s.default.util.Long=o.default,s.default.configure())}).call(this,r(38))},189:function(e,t,r){"use strict";var n=r(1),i=r(10),o=r(9),s=r(11),a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),u=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return u(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WakuMessage=void 0;var d=r(15),f=l(r(21)),p=r(53),v=c(r(188)),g=c(r(408)),b=f.default("waku:message"),h=function(){function e(t,r,n){o(this,e),this.proto=t,this._signaturePublicKey=r,this._signature=n}return s(e,[{key:"encode",value:function(){return v.WakuMessage.encode(this.proto).finish()}},{key:"payloadAsUtf8",get:function(){return this.proto.payload?d.Buffer.from(this.proto.payload).toString("utf-8"):""}},{key:"payload",get:function(){return this.proto.payload}},{key:"contentTopic",get:function(){return this.proto.contentTopic}},{key:"version",get:function(){return this.proto.version}},{key:"timestamp",get:function(){if(this.proto.timestamp)return new Date(1e3*this.proto.timestamp)}},{key:"signaturePublicKey",get:function(){return this._signaturePublicKey}},{key:"signature",get:function(){return this._signature}}],[{key:"fromUtf8String",value:function(){var t=i(n.mark((function t(r,i,o){var s;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=d.Buffer.from(r,"utf-8"),t.abrupt("return",e.fromBytes(s,i,o));case 2:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"fromBytes",value:function(){var t=i(n.mark((function t(r,i,o){var s,a,u,c,l,d,f,p,v,b;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=Object.assign({timestamp:new Date},o||{}),a=s.timestamp,u=s.encPublicKey,c=s.symKey,l=s.sigPrivKey,d=r,f=0,!u||!c){t.next=5;break}throw"Pass either `encPublicKey` or `symKey`, not both.";case 5:if(!u){t.next=14;break}return v=g.clearEncode(d,l),t.next=9,g.encryptAsymmetric(v.payload,u);case 9:d=t.sent,p=v.sig,f=1,t.next=21;break;case 14:if(!c){t.next=21;break}return b=g.clearEncode(d,l),t.next=18,g.encryptSymmetric(b.payload,c);case 18:d=t.sent,p=b.sig,f=1;case 21:return t.abrupt("return",new e({payload:d,timestamp:a.valueOf()/1e3,version:f,contentTopic:i},null===p||void 0===p?void 0:p.publicKey,null===p||void 0===p?void 0:p.signature));case 22:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"decode",value:function(){var t=i(n.mark((function t(r,i){var o;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=v.WakuMessage.decode(p.Reader.create(r)),t.abrupt("return",e.decodeProto(o,i));case 2:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"decodeProto",value:function(){var t=i(n.mark((function t(r,o){var s,a,u,c,l,d,f,p,v,h;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==r.payload){t.next=3;break}return b("Payload is undefined"),t.abrupt("return");case 3:if(u=r.payload,1!==r.version||!r.payload){t.next=26;break}if(void 0!==o){t.next=8;break}return b("Payload is encrypted but no private keys have been provided."),t.abrupt("return");case 8:return t.next=10,Promise.all(o.map(function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.decryptSymmetric(u,t);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),b("Failed to decrypt message using symmetric encryption",e.t0),e.prev=9,e.next=12,g.decryptAsymmetric(u,t);case 12:return e.abrupt("return",e.sent);case 15:return e.prev=15,e.t1=e.catch(9),b("Failed to decrypt message using asymmetric encryption",e.t1),e.abrupt("return");case 19:case"end":return e.stop()}}),e,null,[[0,6],[9,15]])})));return function(t){return e.apply(this,arguments)}}()));case 10:if(d=t.sent,f=function(e){return!!e},0!==(p=d.filter(f)).length){t.next=16;break}return b("Failed to decrypt payload."),t.abrupt("return");case 16:return v=p[0],t.next=19,g.clearDecode(v);case 19:if(h=t.sent){t.next=23;break}return b("Failed to decode payload."),t.abrupt("return");case 23:Object.assign(r,{payload:h.payload}),c=null===(s=h.sig)||void 0===s?void 0:s.publicKey,l=null===(a=h.sig)||void 0===a?void 0:a.signature;case 26:return t.abrupt("return",new e(r,c,l));case 27:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()}]),e}();t.WakuMessage=h},193:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RelayMaxIHaveLength=t.RelayOpportunisticGraftPeers=t.RelayOpportunisticGraftTicks=t.RelayFanoutTTL=t.RelayPruneBackoff=t.RelayPrunePeers=t.RelayHeartbeatInterval=t.RelayHeartbeatInitialDelay=t.RelayGossipFactor=t.RelayPingContentTopic=t.RelayCodecs=t.minute=t.second=void 0,t.second=1e3,t.minute=60*t.second,t.RelayCodecs=["/vac/waku/relay/2.0.0-beta2","/vac/waku/relay/2.0.0"],t.RelayPingContentTopic="/relay-ping/1/ping/null",t.RelayGossipFactor=.25,t.RelayHeartbeatInitialDelay=100,t.RelayHeartbeatInterval=t.second,t.RelayPrunePeers=16,t.RelayPruneBackoff=t.minute,t.RelayFanoutTTL=t.minute,t.RelayOpportunisticGraftTicks=60,t.RelayOpportunisticGraftPeers=2,t.RelayMaxIHaveLength=5e3},197:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return v}));var n=r(1),i=r.n(n),o=r(36),s=(r(278),r(108)),a=r(45),u=r(198);function c(e,t,r){return l.apply(this,arguments)}function l(){return(l=Object(o.a)(i.a.mark((function e(t,r,n){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(r,t,n);case 2:return o=e.sent,console.log("Asking wallet to sign Public Key Message"),console.log("Public Key Message signed"),e.abrupt("return",new s.b({encryptionPublicKey:r,ethAddress:Object(a.hexToBuf)(t),signature:Object(a.hexToBuf)(o)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e,t){return JSON.stringify({domain:{chainId:1,name:"Ethereum Private Message over Waku",version:"1"},message:{encryptionPublicKey:Object(a.bufToHex)(e),ownerAddress:t},primaryType:"PublishEncryptionPublicKey",types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"}],PublishEncryptionPublicKey:[{name:"encryptionPublicKey",type:"string"},{name:"ownerAddress",type:"string"}]}})}function f(e,t,r){return p.apply(this,arguments)}function p(){return(p=Object(o.a)(i.a.mark((function e(t,r,n){var o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=d(t,r),e.next=3,n({method:"eth_signTypedData_v3",params:[r,o],from:r});case 3:return s=e.sent,console.log("TYPED SIGNED:"+JSON.stringify(s)),e.abrupt("return",Object(a.hexToBuf)(s));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){var t=u.recoverTypedSignature_v4({data:JSON.parse(d(e.encryptionPublicKey,"0x"+Object(a.bufToHex)(e.ethAddress))),sig:"0x"+Object(a.bufToHex)(e.signature)});return console.log("Recovered",t),console.log("ethAddress","0x"+Object(a.bufToHex)(e.ethAddress)),Object(a.equalByteArrays)(t,e.ethAddress)}},236:function(e,t){},255:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPeersForProtocol=t.selectRandomPeer=void 0,t.selectRandomPeer=function(e){if(0!==e.length)return e[Math.round(Math.random()*(e.length-1))]},t.getPeersForProtocol=function(e,t){return Array.from(e.peerStore.peers.values()).filter((function(e){return e.protocols.includes(t)}))}},265:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.symmetric=t.TagSize=t.IvSize=t.SymmetricKeySize=void 0,t.SymmetricKeySize=32,t.IvSize=12,t.TagSize=16,t.symmetric={},Promise.resolve().then((function(){return o(r(896))})).then((function(e){t.symmetric=e})).catch((function(e){Promise.resolve().then((function(){return o(r(897))})).then((function(e){t.symmetric=e})).catch((function(t){throw"Could not load any symmetric crypto modules: ".concat(e,", ").concat(t)}))}))},266:function(e,t,r){"use strict";(function(e){var n=r(1),i=r(10),o=r(9),s=r(11),a=r(59),u=r(150),c=r(82),l=r(26),d=r(27),f=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),p=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),v=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return p(t,e),t},g=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WakuRelay=t.RelayCodecs=void 0;var b=g(r(21)),h=g(r(898)),y=r(70),m=r(438),P=g(r(32)),O=r(45),k=r(169),T=r(189),S=v(r(193)),R=r(193);Object.defineProperty(t,"RelayCodecs",{enumerable:!0,get:function(){return R.RelayCodecs}});var j=r(444),_=r(916),w=b.default("waku:relay"),I=function(t){l(f,t);var r=d(f);function f(e,t){var n;o(this,f),(n=r.call(this,e,Object.assign(t,{globalSignaturePolicy:m.SignaturePolicy.StrictNoSign}))).heartbeat=new _.RelayHeartbeat(a(n)),n.observers={},n.decryptionKeys=new Set;var i=S.RelayCodecs;return Object.assign(a(n),{multicodecs:i}),n.pubSubTopic=(null===t||void 0===t?void 0:t.pubSubTopic)||k.DefaultPubSubTopic,n}return s(f,[{key:"start",value:function(){u(c(f.prototype),"start",this).call(this),this.subscribe(this.pubSubTopic)}},{key:"send",value:function(){var t=i(n.mark((function t(r){var i;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.encode(),t.next=3,u(c(f.prototype),"publish",this).call(this,this.pubSubTopic,e.from(i));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"addDecryptionKey",value:function(e){this.decryptionKeys.add(O.hexToBuf(e))}},{key:"deleteDecryptionKey",value:function(e){this.decryptionKeys.delete(O.hexToBuf(e))}},{key:"addObserver",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===r.length?(this.observers[""]||(this.observers[""]=new Set),this.observers[""].add(e)):r.forEach((function(r){t.observers[r]||(t.observers[r]=new Set),t.observers[r].add(e)}))}},{key:"deleteObserver",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===r.length?this.observers[""]&&this.observers[""].delete(e):r.forEach((function(r){t.observers[r]&&t.observers[r].delete(e)}))}},{key:"getPeers",value:function(){var e=this;return j.getRelayPeers(this,this.pubSubTopic,this._options.D,(function(t){return e.score.score(t)>=e._options.scoreThresholds.publishThreshold}))}},{key:"subscribe",value:function(e){var t=this;this.on(e,(function(r){w("Message received on ".concat(e)),T.WakuMessage.decode(r.data,Array.from(t.decryptionKeys)).then((function(e){e?(t.observers[""]&&t.observers[""].forEach((function(t){t(e)})),e.contentTopic&&t.observers[e.contentTopic]&&t.observers[e.contentTopic].forEach((function(t){t(e)}))):w("Failed to decode Waku Message")})).catch((function(e){w("Failed to decode Waku Message",e)}))})),u(c(f.prototype),"subscribe",this).call(this,e)}},{key:"join",value:function(e){var t,r=this;if(!this.started)throw new Error("WakuRelayPubSub has not started");var n=this.fanout.get(e);if(n)n.forEach((function(e){r.score.score(e)<0&&n.delete(e)})),n.size<this._options.D&&j.getRelayPeers(this,e,this._options.D-n.size,(function(e){return!n.has(e)&&!r.direct.has(e)&&r.score.score(e)>=0})).forEach((function(e){return n.add(e)})),this.mesh.set(e,n),this.fanout.delete(e),this.lastpub.delete(e);else{var i=j.getRelayPeers(this,e,this._options.D,(function(e){return!r.direct.has(e)&&r.score.score(e)>=0}));this.mesh.set(e,i)}null===(t=this.mesh.get(e))||void 0===t||t.forEach((function(t){r.log("JOIN: Add mesh link to %s in %s",t,e),r._sendGraft(t,e)}))}},{key:"_publish",value:function(){var e=i(n.mark((function e(t){var r,i,o,s,a=this;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(t),this.gossipTracer.deliverMessage(t)),e.next=3,this.getMsgId(t);case 3:r=e.sent,i=y.messageIdToString(r),this.seenCache.put(i),this.messageCache.put(t),o=new Set,t.topicIDs.forEach((function(e){if(a.topics.get(e)){a.direct.forEach((function(e){o.add(e)}));var t=a.mesh.get(e);if(!t||!t.size){if(!(t=a.fanout.get(e))){var r=j.getRelayPeers(a,e,a._options.D,(function(e){return a.score.score(e)>=a._options.scoreThresholds.publishThreshold}));r.size>0?(t=r,a.fanout.set(e,r)):t=new Set}a.lastpub.set(e,a._now())}null===t||void 0===t||t.forEach((function(e){o.add(e)}))}})),s=y.createGossipRpc([h.default.utils.normalizeOutRpcMessage(t)]),o.forEach((function(e){e!==t.from&&a._sendRpc(e,s)}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_emitGossip",value:function(e,t){var r=this,n=this.messageCache.getGossipIDs(e);if(n.length){y.shuffle(n),n.length>S.RelayMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length);var i=[],o=this.topics.get(e);if(o){o.forEach((function(e){var n=r.peers.get(e);n&&!t.has(e)&&!r.direct.has(e)&&S.RelayCodecs.includes(n.protocol)&&r.score.score(e)>=r._options.scoreThresholds.gossipThreshold&&i.push(e)}));var s=this._options.Dlazy,a=S.RelayGossipFactor*i.length;a>s&&(s=a),s>i.length?s=i.length:y.shuffle(i),i.slice(0,s).forEach((function(t){var i=n;n.length>S.RelayMaxIHaveLength&&(i=y.shuffle(i.slice()).slice(0,S.RelayMaxIHaveLength)),r._pushGossip(t,{topicID:e,messageIDs:i})}))}}}},{key:"_makePrune",value:function(e,t,r){var n=this,i=S.RelayPruneBackoff/1e3,o=[];r&&j.getRelayPeers(this,t,S.RelayPrunePeers,(function(t){return t!==e&&n.score.score(t)>=0})).forEach((function(e){var t=P.default.createFromB58String(e);o.push({peerID:t.toBytes(),signedPeerRecord:n._libp2p.peerStore.addressBook.getRawEnvelope(t)})}));return{topicID:t,peers:o,backoff:i}}}]),f}(h.default);t.WakuRelay=I}).call(this,r(15).Buffer)},268:function(e,t,r){"use strict";(function(e){var n=r(23),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryRPC=t.HistoryResponse=t.HistoryQuery=t.ContentFilter=t.PagingInfo=t.Index=t.historyResponse_ErrorToJSON=t.historyResponse_ErrorFromJSON=t.HistoryResponse_Error=t.pagingInfo_DirectionToJSON=t.pagingInfo_DirectionFromJSON=t.PagingInfo_Direction=t.protobufPackage=void 0;var o,s,a=i(r(256)),u=i(r(53)),c=r(188);function l(e){switch(e){case 0:case"DIRECTION_BACKWARD_UNSPECIFIED":return o.DIRECTION_BACKWARD_UNSPECIFIED;case 1:case"DIRECTION_FORWARD":return o.DIRECTION_FORWARD;case-1:case"UNRECOGNIZED":default:return o.UNRECOGNIZED}}function d(e){switch(e){case o.DIRECTION_BACKWARD_UNSPECIFIED:return"DIRECTION_BACKWARD_UNSPECIFIED";case o.DIRECTION_FORWARD:return"DIRECTION_FORWARD";default:return"UNKNOWN"}}function f(e){switch(e){case 0:case"ERROR_NONE_UNSPECIFIED":return s.ERROR_NONE_UNSPECIFIED;case 1:case"ERROR_INVALID_CURSOR":return s.ERROR_INVALID_CURSOR;case-1:case"UNRECOGNIZED":default:return s.UNRECOGNIZED}}function p(e){switch(e){case s.ERROR_NONE_UNSPECIFIED:return"ERROR_NONE_UNSPECIFIED";case s.ERROR_INVALID_CURSOR:return"ERROR_INVALID_CURSOR";default:return"UNKNOWN"}}t.protobufPackage="waku.v2",function(e){e[e.DIRECTION_BACKWARD_UNSPECIFIED=0]="DIRECTION_BACKWARD_UNSPECIFIED",e[e.DIRECTION_FORWARD=1]="DIRECTION_FORWARD",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(o=t.PagingInfo_Direction||(t.PagingInfo_Direction={})),t.pagingInfo_DirectionFromJSON=l,t.pagingInfo_DirectionToJSON=d,function(e){e[e.ERROR_NONE_UNSPECIFIED=0]="ERROR_NONE_UNSPECIFIED",e[e.ERROR_INVALID_CURSOR=1]="ERROR_INVALID_CURSOR",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(s=t.HistoryResponse_Error||(t.HistoryResponse_Error={})),t.historyResponse_ErrorFromJSON=f,t.historyResponse_ErrorToJSON=p;var v={receivedTime:0,senderTime:0};t.Index={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.default.Writer.create();return 0!==e.digest.length&&t.uint32(10).bytes(e.digest),0!==e.receivedTime&&t.uint32(17).double(e.receivedTime),0!==e.senderTime&&t.uint32(25).double(e.senderTime),t},decode:function(e,t){var r=e instanceof u.default.Reader?e:new u.default.Reader(e),n=void 0===t?r.len:r.pos+t,i=Object.assign({},v);for(i.digest=new Uint8Array;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:i.digest=r.bytes();break;case 2:i.receivedTime=r.double();break;case 3:i.senderTime=r.double();break;default:r.skipType(7&o)}}return i},fromJSON:function(e){var t=Object.assign({},v);return t.digest=new Uint8Array,void 0!==e.digest&&null!==e.digest&&(t.digest=function(e){for(var t=O(e),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}(e.digest)),void 0!==e.receivedTime&&null!==e.receivedTime?t.receivedTime=Number(e.receivedTime):t.receivedTime=0,void 0!==e.senderTime&&null!==e.senderTime?t.senderTime=Number(e.senderTime):t.senderTime=0,t},toJSON:function(e){var t={};return void 0!==e.digest&&(t.digest=function(e){var t,r=[],i=n(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.push(String.fromCharCode(o))}}catch(s){i.e(s)}finally{i.f()}return k(r.join(""))}(void 0!==e.digest?e.digest:new Uint8Array)),void 0!==e.receivedTime&&(t.receivedTime=e.receivedTime),void 0!==e.senderTime&&(t.senderTime=e.senderTime),t},fromPartial:function(e){var t=Object.assign({},v);return void 0!==e.digest&&null!==e.digest?t.digest=e.digest:t.digest=new Uint8Array,void 0!==e.receivedTime&&null!==e.receivedTime?t.receivedTime=e.receivedTime:t.receivedTime=0,void 0!==e.senderTime&&null!==e.senderTime?t.senderTime=e.senderTime:t.senderTime=0,t}};var g={pageSize:0,direction:0};t.PagingInfo={encode:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.default.Writer.create();return 0!==e.pageSize&&r.uint32(8).uint64(e.pageSize),void 0!==e.cursor&&t.Index.encode(e.cursor,r.uint32(18).fork()).ldelim(),0!==e.direction&&r.uint32(24).int32(e.direction),r},decode:function(e,r){for(var n=e instanceof u.default.Reader?e:new u.default.Reader(e),i=void 0===r?n.len:n.pos+r,o=Object.assign({},g);n.pos<i;){var s=n.uint32();switch(s>>>3){case 1:o.pageSize=T(n.uint64());break;case 2:o.cursor=t.Index.decode(n,n.uint32());break;case 3:o.direction=n.int32();break;default:n.skipType(7&s)}}return o},fromJSON:function(e){var r=Object.assign({},g);return void 0!==e.pageSize&&null!==e.pageSize?r.pageSize=Number(e.pageSize):r.pageSize=0,void 0!==e.cursor&&null!==e.cursor?r.cursor=t.Index.fromJSON(e.cursor):r.cursor=void 0,void 0!==e.direction&&null!==e.direction?r.direction=l(e.direction):r.direction=0,r},toJSON:function(e){var r={};return void 0!==e.pageSize&&(r.pageSize=e.pageSize),void 0!==e.cursor&&(r.cursor=e.cursor?t.Index.toJSON(e.cursor):void 0),void 0!==e.direction&&(r.direction=d(e.direction)),r},fromPartial:function(e){var r=Object.assign({},g);return void 0!==e.pageSize&&null!==e.pageSize?r.pageSize=e.pageSize:r.pageSize=0,void 0!==e.cursor&&null!==e.cursor?r.cursor=t.Index.fromPartial(e.cursor):r.cursor=void 0,void 0!==e.direction&&null!==e.direction?r.direction=e.direction:r.direction=0,r}};var b={contentTopic:""};t.ContentFilter={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.default.Writer.create();return""!==e.contentTopic&&t.uint32(10).string(e.contentTopic),t},decode:function(e,t){for(var r=e instanceof u.default.Reader?e:new u.default.Reader(e),n=void 0===t?r.len:r.pos+t,i=Object.assign({},b);r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:i.contentTopic=r.string();break;default:r.skipType(7&o)}}return i},fromJSON:function(e){var t=Object.assign({},b);return void 0!==e.contentTopic&&null!==e.contentTopic?t.contentTopic=String(e.contentTopic):t.contentTopic="",t},toJSON:function(e){var t={};return void 0!==e.contentTopic&&(t.contentTopic=e.contentTopic),t},fromPartial:function(e){var t=Object.assign({},b);return void 0!==e.contentTopic&&null!==e.contentTopic?t.contentTopic=e.contentTopic:t.contentTopic="",t}};var h={};t.HistoryQuery={encode:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.default.Writer.create();void 0!==e.pubSubTopic&&r.uint32(18).string(e.pubSubTopic);var i,o=n(e.contentFilters);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.ContentFilter.encode(s,r.uint32(26).fork()).ldelim()}}catch(a){o.e(a)}finally{o.f()}return void 0!==e.pagingInfo&&t.PagingInfo.encode(e.pagingInfo,r.uint32(34).fork()).ldelim(),void 0!==e.startTime&&r.uint32(41).double(e.startTime),void 0!==e.endTime&&r.uint32(49).double(e.endTime),r},decode:function(e,r){var n=e instanceof u.default.Reader?e:new u.default.Reader(e),i=void 0===r?n.len:n.pos+r,o=Object.assign({},h);for(o.contentFilters=[];n.pos<i;){var s=n.uint32();switch(s>>>3){case 2:o.pubSubTopic=n.string();break;case 3:o.contentFilters.push(t.ContentFilter.decode(n,n.uint32()));break;case 4:o.pagingInfo=t.PagingInfo.decode(n,n.uint32());break;case 5:o.startTime=n.double();break;case 6:o.endTime=n.double();break;default:n.skipType(7&s)}}return o},fromJSON:function(e){var r=Object.assign({},h);if(r.contentFilters=[],void 0!==e.pubSubTopic&&null!==e.pubSubTopic?r.pubSubTopic=String(e.pubSubTopic):r.pubSubTopic=void 0,void 0!==e.contentFilters&&null!==e.contentFilters){var i,o=n(e.contentFilters);try{for(o.s();!(i=o.n()).done;){var s=i.value;r.contentFilters.push(t.ContentFilter.fromJSON(s))}}catch(a){o.e(a)}finally{o.f()}}return void 0!==e.pagingInfo&&null!==e.pagingInfo?r.pagingInfo=t.PagingInfo.fromJSON(e.pagingInfo):r.pagingInfo=void 0,void 0!==e.startTime&&null!==e.startTime?r.startTime=Number(e.startTime):r.startTime=void 0,void 0!==e.endTime&&null!==e.endTime?r.endTime=Number(e.endTime):r.endTime=void 0,r},toJSON:function(e){var r={};return void 0!==e.pubSubTopic&&(r.pubSubTopic=e.pubSubTopic),e.contentFilters?r.contentFilters=e.contentFilters.map((function(e){return e?t.ContentFilter.toJSON(e):void 0})):r.contentFilters=[],void 0!==e.pagingInfo&&(r.pagingInfo=e.pagingInfo?t.PagingInfo.toJSON(e.pagingInfo):void 0),void 0!==e.startTime&&(r.startTime=e.startTime),void 0!==e.endTime&&(r.endTime=e.endTime),r},fromPartial:function(e){var r=Object.assign({},h);if(r.contentFilters=[],void 0!==e.pubSubTopic&&null!==e.pubSubTopic?r.pubSubTopic=e.pubSubTopic:r.pubSubTopic=void 0,void 0!==e.contentFilters&&null!==e.contentFilters){var i,o=n(e.contentFilters);try{for(o.s();!(i=o.n()).done;){var s=i.value;r.contentFilters.push(t.ContentFilter.fromPartial(s))}}catch(a){o.e(a)}finally{o.f()}}return void 0!==e.pagingInfo&&null!==e.pagingInfo?r.pagingInfo=t.PagingInfo.fromPartial(e.pagingInfo):r.pagingInfo=void 0,void 0!==e.startTime&&null!==e.startTime?r.startTime=e.startTime:r.startTime=void 0,void 0!==e.endTime&&null!==e.endTime?r.endTime=e.endTime:r.endTime=void 0,r}};var y={error:0};t.HistoryResponse={encode:function(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.default.Writer.create(),o=n(e.messages);try{for(o.s();!(r=o.n()).done;){var s=r.value;c.WakuMessage.encode(s,i.uint32(18).fork()).ldelim()}}catch(a){o.e(a)}finally{o.f()}return void 0!==e.pagingInfo&&t.PagingInfo.encode(e.pagingInfo,i.uint32(26).fork()).ldelim(),0!==e.error&&i.uint32(32).int32(e.error),i},decode:function(e,r){var n=e instanceof u.default.Reader?e:new u.default.Reader(e),i=void 0===r?n.len:n.pos+r,o=Object.assign({},y);for(o.messages=[];n.pos<i;){var s=n.uint32();switch(s>>>3){case 2:o.messages.push(c.WakuMessage.decode(n,n.uint32()));break;case 3:o.pagingInfo=t.PagingInfo.decode(n,n.uint32());break;case 4:o.error=n.int32();break;default:n.skipType(7&s)}}return o},fromJSON:function(e){var r=Object.assign({},y);if(r.messages=[],void 0!==e.messages&&null!==e.messages){var i,o=n(e.messages);try{for(o.s();!(i=o.n()).done;){var s=i.value;r.messages.push(c.WakuMessage.fromJSON(s))}}catch(a){o.e(a)}finally{o.f()}}return void 0!==e.pagingInfo&&null!==e.pagingInfo?r.pagingInfo=t.PagingInfo.fromJSON(e.pagingInfo):r.pagingInfo=void 0,void 0!==e.error&&null!==e.error?r.error=f(e.error):r.error=0,r},toJSON:function(e){var r={};return e.messages?r.messages=e.messages.map((function(e){return e?c.WakuMessage.toJSON(e):void 0})):r.messages=[],void 0!==e.pagingInfo&&(r.pagingInfo=e.pagingInfo?t.PagingInfo.toJSON(e.pagingInfo):void 0),void 0!==e.error&&(r.error=p(e.error)),r},fromPartial:function(e){var r=Object.assign({},y);if(r.messages=[],void 0!==e.messages&&null!==e.messages){var i,o=n(e.messages);try{for(o.s();!(i=o.n()).done;){var s=i.value;r.messages.push(c.WakuMessage.fromPartial(s))}}catch(a){o.e(a)}finally{o.f()}}return void 0!==e.pagingInfo&&null!==e.pagingInfo?r.pagingInfo=t.PagingInfo.fromPartial(e.pagingInfo):r.pagingInfo=void 0,void 0!==e.error&&null!==e.error?r.error=e.error:r.error=0,r}};var m={requestId:""};t.HistoryRPC={encode:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.default.Writer.create();return""!==e.requestId&&r.uint32(10).string(e.requestId),void 0!==e.query&&t.HistoryQuery.encode(e.query,r.uint32(18).fork()).ldelim(),void 0!==e.response&&t.HistoryResponse.encode(e.response,r.uint32(26).fork()).ldelim(),r},decode:function(e,r){for(var n=e instanceof u.default.Reader?e:new u.default.Reader(e),i=void 0===r?n.len:n.pos+r,o=Object.assign({},m);n.pos<i;){var s=n.uint32();switch(s>>>3){case 1:o.requestId=n.string();break;case 2:o.query=t.HistoryQuery.decode(n,n.uint32());break;case 3:o.response=t.HistoryResponse.decode(n,n.uint32());break;default:n.skipType(7&s)}}return o},fromJSON:function(e){var r=Object.assign({},m);return void 0!==e.requestId&&null!==e.requestId?r.requestId=String(e.requestId):r.requestId="",void 0!==e.query&&null!==e.query?r.query=t.HistoryQuery.fromJSON(e.query):r.query=void 0,void 0!==e.response&&null!==e.response?r.response=t.HistoryResponse.fromJSON(e.response):r.response=void 0,r},toJSON:function(e){var r={};return void 0!==e.requestId&&(r.requestId=e.requestId),void 0!==e.query&&(r.query=e.query?t.HistoryQuery.toJSON(e.query):void 0),void 0!==e.response&&(r.response=e.response?t.HistoryResponse.toJSON(e.response):void 0),r},fromPartial:function(e){var r=Object.assign({},m);return void 0!==e.requestId&&null!==e.requestId?r.requestId=e.requestId:r.requestId="",void 0!==e.query&&null!==e.query?r.query=t.HistoryQuery.fromPartial(e.query):r.query=void 0,void 0!==e.response&&null!==e.response?r.response=t.HistoryResponse.fromPartial(e.response):r.response=void 0,r}};var P=function(){if("undefined"!==typeof P)return P;if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof e)return e;throw"Unable to locate global object"}(),O=P.atob||function(e){return P.Buffer.from(e,"base64").toString("binary")};var k=P.btoa||function(e){return P.Buffer.from(e,"binary").toString("base64")};function T(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new P.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}u.default.util.Long!==a.default&&(u.default.util.Long=a.default,u.default.configure())}).call(this,r(38))},321:function(e,t,r){"use strict";var n=r(1),i=r(23),o=r(10),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getPseudoRandomSubset=t.getBootstrapNodes=void 0;var a=s(r(569)),u=s(r(21)),c=r(70),l=u.default("waku:discovery");function d(){return(d=o(n.mark((function e(){var t,r,o,s,u,c,d,p,v=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=v.length>0&&void 0!==v[0]?v[0]:["fleets","wakuv2.prod","waku-websocket"],r=v.length>1&&void 0!==v[1]?v[1]:"https://fleets.status.im/",!((o=v.length>2&&void 0!==v[2]?v[2]:1)<=0)){e.next=5;break}return e.abrupt("return",[]);case 5:return e.next=7,a.default.get(r,{headers:{"Content-Type":"application/json"}});case 7:s=e.sent,u=s.data,c=i(t),e.prev=10,c.s();case 12:if((d=c.n()).done){e.next=20;break}if(p=d.value,void 0!==u[p]){e.next=17;break}throw l("Failed to retrieve bootstrap nodes: ".concat(p," does not exist on "),u),"Failed to retrieve bootstrap nodes: ".concat(p," does not exist on ").concat(JSON.stringify(u));case 17:u=u[p];case 18:e.next=12;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(10),c.e(e.t0);case 25:return e.prev=25,c.f(),e.finish(25);case 28:if(!Array.isArray(u)){e.next=30;break}return e.abrupt("return",f(u,o));case 30:if("string"!==typeof u){e.next=32;break}return e.abrupt("return",[u]);case 32:if("object"!==typeof u){e.next=35;break}return u=Object.values(u),e.abrupt("return",f(u,o));case 35:throw"Failed to retrieve bootstrap nodes: response format is not supported: ".concat(JSON.stringify(u));case 36:case"end":return e.stop()}}),e,null,[[10,22,25,28]])})))).apply(this,arguments)}function f(e,t){return e.length<=t?e:c.shuffle(e).slice(0,t)}t.getBootstrapNodes=function(){return d.apply(this,arguments)},t.getPseudoRandomSubset=f},405:function(e,t,r){"use strict";var n=r(1),i=r(10),o=r(9),s=r(11),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WakuLightPush=t.PushResponse=t.LightPushCodec=void 0;var u=a(r(406)),c=a(r(80)),l=a(r(57)),d=r(407);Object.defineProperty(t,"PushResponse",{enumerable:!0,get:function(){return d.PushResponse}});var f=r(255),p=r(169),v=r(850);t.LightPushCodec="/vac/waku/lightpush/2.0.0-beta1";var g=function(){function e(t,r){o(this,e),this.libp2p=t,(null===r||void 0===r?void 0:r.pubSubTopic)?this.pubSubTopic=r.pubSubTopic:this.pubSubTopic=p.DefaultPubSubTopic}return s(e,[{key:"push",value:function(){var e=i(n.mark((function e(r,i){var o,s,a,d,f,p,g,b;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===i||void 0===i?void 0:i.peerId)){e.next=6;break}if(o=this.libp2p.peerStore.get(i.peerId)){e.next=4;break}throw"Peer is unknown";case 4:e.next=7;break;case 6:o=this.randomPeer;case 7:if(o){e.next=9;break}throw"No peer available";case 9:if(o.protocols.includes(t.LightPushCodec)){e.next=11;break}throw"Peer does not register waku light push protocol";case 11:if(s=this.libp2p.connectionManager.get(o.id)){e.next=14;break}throw"Failed to get a connection to the peer";case 14:return e.next=16,s.newStream(t.LightPushCodec);case 16:return a=e.sent,d=a.stream,e.prev=18,f=(null===i||void 0===i?void 0:i.pubSubTopic)?i.pubSubTopic:this.pubSubTopic,p=v.PushRPC.createRequest(r,f),e.next=23,l.default([p.encode()],c.default.encode(),d,c.default.decode(),u.default);case 23:if(g=e.sent,e.prev=24,b=v.PushRPC.decode(g.slice()).response){e.next=29;break}return console.log("No response in PushRPC"),e.abrupt("return",null);case 29:return e.abrupt("return",b);case 32:e.prev=32,e.t0=e.catch(24),console.log("Failed to decode push reply",e.t0);case 35:e.next=40;break;case 37:e.prev=37,e.t1=e.catch(18),console.log("Failed to send waku light push request",e.t1);case 40:return e.abrupt("return",null);case 41:case"end":return e.stop()}}),e,this,[[18,37],[24,32]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"peers",get:function(){return f.getPeersForProtocol(this.libp2p,t.LightPushCodec)}},{key:"randomPeer",get:function(){return f.selectRandomPeer(this.peers)}}]),e}();t.WakuLightPush=g},407:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PushRPC=t.PushResponse=t.PushRequest=t.protobufPackage=void 0;var i=n(r(256)),o=n(r(53)),s=r(188);t.protobufPackage="waku.v2";var a={pubSubTopic:""};t.PushRequest={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.default.Writer.create();return""!==e.pubSubTopic&&t.uint32(10).string(e.pubSubTopic),void 0!==e.message&&s.WakuMessage.encode(e.message,t.uint32(18).fork()).ldelim(),t},decode:function(e,t){for(var r=e instanceof o.default.Reader?e:new o.default.Reader(e),n=void 0===t?r.len:r.pos+t,i=Object.assign({},a);r.pos<n;){var u=r.uint32();switch(u>>>3){case 1:i.pubSubTopic=r.string();break;case 2:i.message=s.WakuMessage.decode(r,r.uint32());break;default:r.skipType(7&u)}}return i},fromJSON:function(e){var t=Object.assign({},a);return void 0!==e.pubSubTopic&&null!==e.pubSubTopic?t.pubSubTopic=String(e.pubSubTopic):t.pubSubTopic="",void 0!==e.message&&null!==e.message?t.message=s.WakuMessage.fromJSON(e.message):t.message=void 0,t},toJSON:function(e){var t={};return void 0!==e.pubSubTopic&&(t.pubSubTopic=e.pubSubTopic),void 0!==e.message&&(t.message=e.message?s.WakuMessage.toJSON(e.message):void 0),t},fromPartial:function(e){var t=Object.assign({},a);return void 0!==e.pubSubTopic&&null!==e.pubSubTopic?t.pubSubTopic=e.pubSubTopic:t.pubSubTopic="",void 0!==e.message&&null!==e.message?t.message=s.WakuMessage.fromPartial(e.message):t.message=void 0,t}};var u={isSuccess:!1,info:""};t.PushResponse={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.default.Writer.create();return!0===e.isSuccess&&t.uint32(8).bool(e.isSuccess),""!==e.info&&t.uint32(18).string(e.info),t},decode:function(e,t){for(var r=e instanceof o.default.Reader?e:new o.default.Reader(e),n=void 0===t?r.len:r.pos+t,i=Object.assign({},u);r.pos<n;){var s=r.uint32();switch(s>>>3){case 1:i.isSuccess=r.bool();break;case 2:i.info=r.string();break;default:r.skipType(7&s)}}return i},fromJSON:function(e){var t=Object.assign({},u);return void 0!==e.isSuccess&&null!==e.isSuccess?t.isSuccess=Boolean(e.isSuccess):t.isSuccess=!1,void 0!==e.info&&null!==e.info?t.info=String(e.info):t.info="",t},toJSON:function(e){var t={};return void 0!==e.isSuccess&&(t.isSuccess=e.isSuccess),void 0!==e.info&&(t.info=e.info),t},fromPartial:function(e){var t=Object.assign({},u);return void 0!==e.isSuccess&&null!==e.isSuccess?t.isSuccess=e.isSuccess:t.isSuccess=!1,void 0!==e.info&&null!==e.info?t.info=e.info:t.info="",t}};var c={requestId:""};t.PushRPC={encode:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.default.Writer.create();return""!==e.requestId&&r.uint32(10).string(e.requestId),void 0!==e.request&&t.PushRequest.encode(e.request,r.uint32(18).fork()).ldelim(),void 0!==e.response&&t.PushResponse.encode(e.response,r.uint32(26).fork()).ldelim(),r},decode:function(e,r){for(var n=e instanceof o.default.Reader?e:new o.default.Reader(e),i=void 0===r?n.len:n.pos+r,s=Object.assign({},c);n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:s.requestId=n.string();break;case 2:s.request=t.PushRequest.decode(n,n.uint32());break;case 3:s.response=t.PushResponse.decode(n,n.uint32());break;default:n.skipType(7&a)}}return s},fromJSON:function(e){var r=Object.assign({},c);return void 0!==e.requestId&&null!==e.requestId?r.requestId=String(e.requestId):r.requestId="",void 0!==e.request&&null!==e.request?r.request=t.PushRequest.fromJSON(e.request):r.request=void 0,void 0!==e.response&&null!==e.response?r.response=t.PushResponse.fromJSON(e.response):r.response=void 0,r},toJSON:function(e){var r={};return void 0!==e.requestId&&(r.requestId=e.requestId),void 0!==e.request&&(r.request=e.request?t.PushRequest.toJSON(e.request):void 0),void 0!==e.response&&(r.response=e.response?t.PushResponse.toJSON(e.response):void 0),r},fromPartial:function(e){var r=Object.assign({},c);return void 0!==e.requestId&&null!==e.requestId?r.requestId=e.requestId:r.requestId="",void 0!==e.request&&null!==e.request?r.request=t.PushRequest.fromPartial(e.request):r.request=void 0,void 0!==e.response&&null!==e.response?r.response=t.PushResponse.fromPartial(e.response):r.response=void 0,r}},o.default.util.Long!==i.default&&(o.default.util.Long=i.default,o.default.configure())},408:function(e,t,r){"use strict";var n=r(1),i=r(10),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getPublicKey=t.generateSymmetricKey=t.generatePrivateKey=t.decryptSymmetric=t.encryptSymmetric=t.decryptAsymmetric=t.encryptAsymmetric=t.clearDecode=t.clearEncode=t.PrivateKeySize=void 0;var u=r(15),c=a(r(409)),l=a(r(892)),d=r(894),f=a(r(350)),p=r(45),v=r(265);function g(){return(g=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l.encrypt(p.hexToBuf(r),u.Buffer.from(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l.decrypt(u.Buffer.from(r),u.Buffer.from(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=i(n.mark((function e(t,r){var i,o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=v.symmetric.generateIv(),e.next=3,v.symmetric.encrypt(i,p.hexToBuf(r),u.Buffer.from(t));case 3:return o=e.sent,e.abrupt("return",u.Buffer.concat([o,u.Buffer.from(i)]));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=i(n.mark((function e(t,r){var i,o,s,a;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.Buffer.from(t),o=i.length-v.IvSize,s=i.slice(0,o),a=i.slice(o),e.abrupt("return",v.symmetric.decrypt(a,p.hexToBuf(r),s));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return f.publicKeyCreate(e,!1)}function P(e){for(var t=1,r=e.length;r>=256;r/=256)t++;return t}function O(e){if("undefined"!==typeof window&&window&&window.crypto){var t=new Uint8Array(e);return window.crypto.getRandomValues(t),t}return c.randomBytes(e)}t.PrivateKeySize=32,t.clearEncode=function(e,t){var r=u.Buffer.from([0]);r=function(e,t){var r=P(t),n=u.Buffer.alloc(4);return n.writeUInt32LE(t.length,0),n=n.slice(0,r),(e=u.Buffer.concat([e,n]))[0]|=r,e}(r,e),r=u.Buffer.concat([r,u.Buffer.from(e)]);var n=1+P(e)+e.length;t&&(n+=65);var i,o=256-n%256,s=u.Buffer.from(O(o));if(!function(e,t){if(e.length!==t)return!1;return!(t>3&&u.Buffer.from(e).equals(u.Buffer.alloc(e.length)))}(s,o))throw new Error("failed to generate random padding of size "+o);if(r=u.Buffer.concat([r,s]),t){r[0]|=4;var a=d.keccak256(r),c=f.ecdsaSign(p.hexToBuf(a),t);r=u.Buffer.concat([r,c.signature,u.Buffer.from([c.recid])]),i={signature:u.Buffer.from(c.signature),publicKey:m(t)}}return{payload:r,sig:i}},t.clearDecode=function(e){var t,r=u.Buffer.from(e),n=1,i=3&r.readUIntLE(0,1);if(0!==i){var o=r.readUIntLE(n,i);n+=i;var s=r.slice(n,n+o),a=4==(4&r.readUIntLE(0,1));if(a){var c=function(e){return e.slice(e.length-65,e.length)}(r),l=function(e,t){var r=t.slice(64).readIntBE(0,1);return f.ecdsaRecover(t.slice(0,64),r,p.hexToBuf(e),!1)}(function(e,t){if(t)return d.keccak256(e.slice(0,e.length-65));return d.keccak256(e)}(r,a),c);t={signature:c,publicKey:l}}return{payload:s,sig:t}}},t.encryptAsymmetric=function(e,t){return g.apply(this,arguments)},t.decryptAsymmetric=function(e,t){return b.apply(this,arguments)},t.encryptSymmetric=function(e,t){return h.apply(this,arguments)},t.decryptSymmetric=function(e,t){return y.apply(this,arguments)},t.generatePrivateKey=function(){return O(t.PrivateKeySize)},t.generateSymmetricKey=function(){return O(v.SymmetricKeySize)},t.getPublicKey=m},444:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRelayPeers=void 0;var n=r(70),i=r(266);t.getRelayPeers=function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},s=e.topics.get(t);if(!s)return new Set;var a=[];return s.forEach((function(t){var r=e.peers.get(t);r&&i.RelayCodecs.includes(r.protocol)&&o(t)&&a.push(t)})),a=n.shuffle(a),r>0&&a.length>r&&(a=a.slice(0,r)),new Set(a)}},445:function(e,t,r){"use strict";var n=r(1),i=r(10),o=r(9),s=r(11),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WakuStore=t.PageDirection=t.DefaultPageSize=t.StoreCodec=void 0;var u=a(r(21)),c=a(r(406)),l=a(r(80)),d=a(r(57)),f=r(268),p=r(255),v=r(45),g=r(169),b=r(189),h=r(917);Object.defineProperty(t,"PageDirection",{enumerable:!0,get:function(){return h.PageDirection}});var y=u.default("waku:store");t.StoreCodec="/vac/waku/store/2.0.0-beta3",t.DefaultPageSize=10;var m=function(){function e(t,r){o(this,e),this.libp2p=t,(null===r||void 0===r?void 0:r.pubSubTopic)?this.pubSubTopic=r.pubSubTopic:this.pubSubTopic=g.DefaultPubSubTopic,this.decryptionKeys=new Set}return s(e,[{key:"queryHistory",value:function(){var e=i(n.mark((function e(r,o){var s,a,u,p,g,m,P,O,k,T,S,R,j,_;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===o||void 0===o?void 0:o.timeFilter)&&(g=o.timeFilter.startTime.getTime()/1e3,m=o.timeFilter.endTime.getTime()/1e3),P=Object.assign({pubSubTopic:this.pubSubTopic,pageDirection:h.PageDirection.BACKWARD,pageSize:t.DefaultPageSize},o,{startTime:g,endTime:m},{contentTopics:r}),y("Querying history with the following options",o),!P.peerId){e.next=9;break}if(O=this.libp2p.peerStore.get(P.peerId)){e.next=7;break}throw"Failed to retrieve connection details for provided peer in peer store: ".concat(P.peerId.toB58String());case 7:e.next=12;break;case 9:if(O=this.randomPeer){e.next=12;break}throw"Failed to find known peer that registers waku store protocol";case 12:if(O.protocols.includes(t.StoreCodec)){e.next=14;break}throw"Peer does not register waku store protocol: ".concat(O.id.toB58String());case 14:if(k=this.libp2p.connectionManager.get(O.id)){e.next=17;break}throw"Failed to get a connection to the peer";case 17:T=Array.from(this.decryptionKeys.values()),P.decryptionKeys&&P.decryptionKeys.forEach((function(e){T.push(v.hexToBuf(e))})),S=[],R=void 0,j=n.mark((function e(){var r,o,v,g,m,O,j,_,w,I;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.newStream(t.StoreCodec);case 2:return r=e.sent,o=r.stream,v=Object.assign(P,{cursor:R}),g=h.HistoryRPC.createQuery(v),y("Querying store peer",k.remoteAddr.toString()),e.next=9,d.default([g.encode()],l.default.encode(),o,l.default.decode(),c.default);case 9:if(m=e.sent,O=h.HistoryRPC.decode(m.slice()),j=O.response){e.next=14;break}throw"History response misses response field";case 14:if(!j.error||j.error!==f.HistoryResponse_Error.ERROR_INVALID_CURSOR){e.next=16;break}throw"History response contains an Error: INVALID CURSOR";case 16:if(j.messages&&j.messages.length){e.next=19;break}return console.log("No messages present in HistoryRPC response"),e.abrupt("return",{v:S});case 19:return y("".concat(j.messages.length," messages retrieved for pubsub topic ").concat(P.pubSubTopic)),_=[],e.next=23,Promise.all(j.messages.map(function(){var e=i(n.mark((function e(t){var r;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.WakuMessage.decodeProto(t,T);case 2:(r=e.sent)&&(S.push(r),_.push(r));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 23:if(P.callback&&P.callback(_),w=null===(s=j.pagingInfo)||void 0===s?void 0:s.pageSize,I=null===(u=null===(a=g.query)||void 0===a?void 0:a.pagingInfo)||void 0===u?void 0:u.pageSize,!(w&&I&&w<I)){e.next=28;break}return e.abrupt("return",{v:S});case 28:if(void 0!==(R=null===(p=j.pagingInfo)||void 0===p?void 0:p.cursor)){e.next=32;break}return console.log("No cursor returned by peer."),e.abrupt("return",{v:S});case 32:case"end":return e.stop()}}),e)}));case 22:return e.delegateYield(j(),"t0",24);case 24:if("object"!==typeof(_=e.t0)){e.next=27;break}return e.abrupt("return",_.v);case 27:e.next=22;break;case 29:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"addDecryptionKey",value:function(e){this.decryptionKeys.add(v.hexToBuf(e))}},{key:"deleteDecryptionKey",value:function(e){this.decryptionKeys.delete(v.hexToBuf(e))}},{key:"peers",get:function(){return p.getPeersForProtocol(this.libp2p,t.StoreCodec)}},{key:"randomPeer",get:function(){return p.selectRandomPeer(this.peers)}}]),e}();t.WakuStore=m},45:function(e,t,r){"use strict";(function(e){function r(t){return"string"===typeof t?e.from(t.replace(/^0x/i,""),"hex"):e.from(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.equalByteArrays=t.bufToHex=t.hexToBuf=void 0,t.hexToBuf=r,t.bufToHex=function(t){return e.from(t).toString("hex")},t.equalByteArrays=function(t,n){var i,o;return i="string"===typeof t?r(t):e.from(t),o="string"===typeof n?r(n):e.from(n),0===i.compare(o)}}).call(this,r(15).Buffer)},453:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return O}));var n=r(1),i=r.n(n),o=r(36),s=r(58),a=r(934),u=r(935),c=r(936),l=r(940),d=r(939),f=r(941),p=r(0),v=r(128),g=r(45),b=r(108),h=r(66),y=r(198),m=r(18),P=Object(a.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));function O(e){var t=e.waku,r=e.recipients,n=P(),a=Object(p.useState)(""),v=Object(s.a)(a,2),g=v[0],b=v[1],h=Object(p.useState)(),y=Object(s.a)(h,2),O=y[0],k=y[1],S=Array.from(r.keys()).map((function(e){return Object(m.jsx)(u.a,{value:e,children:e},e)})),R=function(){var e=Object(o.a)(i.a.mark((function e(n){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==n.key||n.altKey||n.ctrlKey||n.shiftKey){e.next=11;break}if(t){e.next=3;break}return e.abrupt("return");case 3:if(g){e.next=5;break}return e.abrupt("return");case 5:if(O){e.next=7;break}return e.abrupt("return");case 7:if(o=r.get(g)){e.next=10;break}return e.abrupt("return");case 10:T(t,g,o,O,(function(e){e&&(console.log("callback called with",e),k(""))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[Object(m.jsxs)(c.a,{className:n.formControl,children:[Object(m.jsx)(l.a,{id:"select-recipient-label",children:"Recipient"}),Object(m.jsx)(d.a,{labelId:"select-recipient",id:"select-recipient",value:g,onChange:function(e){b(e.target.value)},children:S})]}),Object(m.jsx)(f.a,{id:"message-input",label:"Message",variant:"filled",onChange:function(e){k(e.target.value)},onKeyDown:R,value:O})]})}function k(){return(k=Object(o.a)(i.a.mark((function t(r,n,o){var s,a,u,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=new b.a({toAddress:Object(g.hexToBuf)(o),message:r}),a=s.encode(),u=y.encrypt(e.from(n).toString("base64"),{data:Object(g.bufToHex)(a)},"x25519-xsalsa20-poly1305"),c=e.from(JSON.stringify(u),"utf8"),t.abrupt("return",v.WakuMessage.fromBytes(c,h.a));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(e,t,r,n,i){(function(e,t,r){return k.apply(this,arguments)})(n,r,t).then((function(t){console.log("pushing"),e.lightPush.push(t).then((function(e){console.log("Message sent",e),i(!!e&&e.isSuccess)})).catch((function(e){console.error("Failed to send message",e),i(!1)}))})).catch((function(e){console.error("Cannot encode & encrypt message",e),i(!1)}))}}).call(this,r(15).Buffer)},454:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return o}));var n=r(932),i=(r(0),r(18));function o(t){var r=t.setEncPublicKey,o=t.providerRequest,s=t.address;return Object(i.jsx)(n.a,{variant:"contained",color:"primary",onClick:function(){o&&s&&(console.log("Getting Encryption Public Key from Wallet"),o({method:"eth_getEncryptionPublicKey",params:[s]}).then((function(t){console.log("Encryption Public key:",t),"string"===typeof t?r(e.from(t,"base64")):console.error("Could not get encryption key")})).catch((function(e){4001===e.code?console.log("We can't encrypt anything without the key."):console.error(e)})))},disabled:!o||!s,children:"Get Encryption Public Key from Wallet"})}}).call(this,r(15).Buffer)},474:function(e,t,r){},475:function(e,t,r){},503:function(e,t){},505:function(e,t){},520:function(e,t){},521:function(e,t){},545:function(e,t){},547:function(e,t){},567:function(e,t){},611:function(e,t){},66:function(e,t,r){"use strict";(function(e){r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return d})),r.d(t,"e",(function(){return f})),r.d(t,"d",(function(){return v})),r.d(t,"c",(function(){return g}));var n=r(1),i=r.n(n),o=r(36),s=r(128),a=r(108),u=r(197),c=r(45),l="/eth-pm-wallet/1/encryption-public-key/proto",d="/eth-pm-wallet/1/private-message/proto";function f(){return p.apply(this,arguments)}function p(){return(p=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Waku.create({bootstrap:!0});case 2:return t=e.sent,e.next=5,new Promise((function(e,r){setTimeout(r,1e4),t.libp2p.connectionManager.on("peer:connect",(function(){e(null)}))}));case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t,r){if(console.log("Public Key Message received:",r),r.payload){var n=a.b.decode(r.payload);if(n&&(!e||!Object(c.equalByteArrays)(n.ethAddress,e))){var i=Object(u.b)(n);console.log("Is Public Key Message valid?",i),i&&t((function(e){return e.set(Object(c.bufToHex)(n.ethAddress),n.encryptionPublicKey),new Map(e)}))}}}function g(e,t,r,n){return b.apply(this,arguments)}function b(){return(b=Object(o.a)(i.a.mark((function t(r,n,o,s){var u,l,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Private Message received:",s),s.payload){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,o({method:"eth_decrypt",params:[s.payloadAsUtf8,n]}).catch((function(e){return console.log(e.message)}));case 5:if(u=t.sent,console.log("Decrypted Payload:",u),l=a.a.decode(e.from(u,"hex"))){t.next=11;break}return console.log("Failed to decode Private Message"),t.abrupt("return");case 11:if(Object(c.equalByteArrays)(l.toAddress,n)){t.next=13;break}return t.abrupt("return");case 13:d=s.timestamp?s.timestamp:new Date,console.log("Message decrypted:",l.message),r((function(e){var t=e.slice();return t.push({text:l.message,timestamp:d}),t}));case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}).call(this,r(15).Buffer)},666:function(e,t){},667:function(e,t){},764:function(e,t){},815:function(e,t){},834:function(e,t){},850:function(e,t,r){"use strict";var n=r(9),i=r(11),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PushRPC=void 0;var u=r(53),c=r(446),l=a(r(407)),d=function(){function e(t){n(this,e),this.proto=t}return i(e,[{key:"encode",value:function(){return l.PushRPC.encode(this.proto).finish()}},{key:"query",get:function(){return this.proto.request}},{key:"response",get:function(){return this.proto.response}}],[{key:"createRequest",value:function(t,r){return new e({requestId:c.v4(),request:{message:t.proto,pubSubTopic:r},response:void 0})}},{key:"decode",value:function(t){return new e(l.PushRPC.decode(u.Reader.create(t)))}}]),e}();t.PushRPC=d},875:function(e,t){},876:function(e,t){},896:function(e,t,r){"use strict";(function(e){var n=r(1),i=r(10);Object.defineProperty(t,"__esModule",{value:!0}),t.generateIv=t.decrypt=t.encrypt=void 0;var o=r(265),s=window.crypto||window.msCrypto,a=s.subtle||s.webkitSubtle,u={name:"AES-GCM",length:128};if(void 0===a)throw new Error("Failed to load Subtle CryptoAPI");function c(){return(c=i(n.mark((function t(r,i,o){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a.importKey("raw",i,u,!1,["encrypt"]).then((function(e){return a.encrypt(Object.assign({iv:r},u),e,o)})).then(e.from));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function l(){return(l=i(n.mark((function t(r,i,o){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a.importKey("raw",i,u,!1,["decrypt"]).then((function(e){return a.decrypt(Object.assign({iv:r},u),e,o)})).then(e.from));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}t.encrypt=function(e,t,r){return c.apply(this,arguments)},t.decrypt=function(e,t,r){return l.apply(this,arguments)},t.generateIv=function(){var e=new Uint8Array(o.IvSize);return s.getRandomValues(e),e}}).call(this,r(15).Buffer)},897:function(e,t,r){"use strict";(function(e){var n=r(1),i=r(10);Object.defineProperty(t,"__esModule",{value:!0}),t.generateIv=t.decrypt=t.encrypt=void 0;var o=r(409),s=r(265),a="aes-256-gcm";function u(){return(u=i(n.mark((function t(r,i,s){var u,c,l,d;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=o.createCipheriv(a,i,r),c=u.update(s),l=u.final(),d=u.getAuthTag(),t.abrupt("return",e.concat([c,l,d]));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function c(){return(c=i(n.mark((function t(r,i,u){var c,l,d,f,p,v;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=u.length-s.TagSize,l=u.slice(0,c),d=u.slice(c),(f=o.createDecipheriv(a,i,r)).setAuthTag(d),p=f.update(l),v=f.final(),t.abrupt("return",e.concat([p,v]));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}t.encrypt=function(e,t,r){return u.apply(this,arguments)},t.decrypt=function(e,t,r){return c.apply(this,arguments)},t.generateIv=function(){return o.randomBytes(s.IvSize)}}).call(this,r(15).Buffer)},916:function(e,t,r){"use strict";var n=r(9),i=r(11),o=r(26),s=r(27),a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),u=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return u(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RelayHeartbeat=void 0;var l=r(440),d=r(70),f=c(r(193)),p=r(444),v=function(e){o(r,e);var t=s(r);function r(e){return n(this,r),t.call(this,e)}return i(r,[{key:"start",value:function(){var e=this;if(!this._heartbeatTimer){var t=this._heartbeat.bind(this),r=setTimeout((function(){var r;t(),null===(r=e._heartbeatTimer)||void 0===r||r.runPeriodically(t,f.RelayHeartbeatInterval)}),f.RelayHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:function(t,r){e._heartbeatTimer._intervalId=setInterval(t,r)},cancel:function(){var t;clearTimeout(r),clearInterval(null===(t=e._heartbeatTimer)||void 0===t?void 0:t._intervalId)}}}}},{key:"stop",value:function(){this._heartbeatTimer&&(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}},{key:"_heartbeat",value:function(){var e=this,t=this.gossipsub._options,r=t.D,n=t.Dlo,i=t.Dhi,o=t.Dscore,s=t.Dout;this.gossipsub.heartbeatTicks++;var a=new Map,u=function(t){var r=a.get(t);return void 0===r&&(r=e.gossipsub.score.score(t),a.set(t,r)),r},c=new Map,l=new Map,v=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((function(t,a){var g=function(r){e.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",r,a),e.gossipsub.score.prune(r,a),e.gossipsub._addBackoff(r,a),t.delete(r);var n=l.get(r);n?n.push(a):l.set(r,[a])},b=function(r){e.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",r,a),e.gossipsub.score.graft(r,a),t.add(r);var n=c.get(r);n?n.push(a):c.set(r,[a])};if(t.forEach((function(t){var r=u(t);r<0&&(e.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",t,r,a),g(t),v.set(t,!0))})),t.size<n){var h=e.gossipsub.backoff.get(a),y=r-t.size;p.getRelayPeers(e.gossipsub,a,y,(function(r){return!t.has(r)&&!e.gossipsub.direct.has(r)&&(!h||!h.has(r))&&u(r)>=0})).forEach(b)}if(t.size>i){var m=Array.from(t);m.sort((function(e,t){return u(t)-u(e)})),m=m.slice(0,o).concat(d.shuffle(m.slice(o)));var P=0;if(m.slice(0,r).forEach((function(t){e.gossipsub.outbound.get(t)&&P++})),P<s){var O=function(e){for(var t=m[e],r=e;r>0;r--)m[r]=m[r-1];m[0]=t};if(P>0)for(var k=P,T=1;T<r&&k>0;T++)e.gossipsub.outbound.get(m[T])&&(O(T),k--);for(var S=r-P,R=r;R<m.length&&S>0;R++)e.gossipsub.outbound.get(m[R])&&(O(R),S--)}m.slice(r).forEach(g)}if(t.size>=n){var j=0;if(t.forEach((function(t){e.gossipsub.outbound.get(t)&&j++})),j<s){var _=s-j,w=e.gossipsub.backoff.get(a);p.getRelayPeers(e.gossipsub,a,_,(function(r){return!t.has(r)&&!e.gossipsub.direct.has(r)&&(!w||!w.has(r))&&u(r)>=0})).forEach(b)}}if(e.gossipsub.heartbeatTicks%f.RelayOpportunisticGraftTicks===0&&t.size>1){var I=Array.from(t).sort((function(e,t){return u(e)-u(t)})),x=Math.floor(t.size/2),D=u(I[x]);if(D<e.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){var E=e.gossipsub.backoff.get(a);p.getRelayPeers(e.gossipsub,a,f.RelayOpportunisticGraftPeers,(function(r){return t.has(r)&&!e.gossipsub.direct.has(r)&&(!E||!E.has(r))&&u(r)>D})).forEach((function(t){e.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",t,a),b(t)}))}}e.gossipsub._emitGossip(a,t)}));var g=this.gossipsub._now();this.gossipsub.lastpub.forEach((function(t,r){t+f.RelayFanoutTTL<g&&(e.gossipsub.fanout.delete(r),e.gossipsub.lastpub.delete(r))})),this.gossipsub.fanout.forEach((function(t,n){var i=e.gossipsub.topics.get(n);if(t.forEach((function(r){(!(null===i||void 0===i?void 0:i.has(r))||u(r)<e.gossipsub._options.scoreThresholds.publishThreshold)&&t.delete(r)})),t.size<r){var o=r-t.size;p.getRelayPeers(e.gossipsub,n,o,(function(r){return!t.has(r)&&!e.gossipsub.direct.has(r)&&u(r)>=e.gossipsub._options.scoreThresholds.publishThreshold})).forEach((function(e){t.add(e)}))}e.gossipsub._emitGossip(n,t)})),this.gossipsub._sendGraftPrune(c,l,v),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}}]),r}(l.Heartbeat);t.RelayHeartbeat=v},917:function(e,t,r){"use strict";var n=r(9),i=r(11),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryRPC=t.PageDirection=void 0;var u,c=r(53),l=r(446),d=a(r(268));!function(e){e.BACKWARD="backward",e.FORWARD="forward"}(u=t.PageDirection||(t.PageDirection={}));var f=function(){function e(t){n(this,e),this.proto=t}return i(e,[{key:"encode",value:function(){return d.HistoryRPC.encode(this.proto).finish()}},{key:"query",get:function(){return this.proto.query}},{key:"response",get:function(){return this.proto.response}}],[{key:"createQuery",value:function(t){var r=function(e){switch(e){case u.BACKWARD:return d.PagingInfo_Direction.DIRECTION_BACKWARD_UNSPECIFIED;case u.FORWARD:return d.PagingInfo_Direction.DIRECTION_FORWARD;default:return d.PagingInfo_Direction.DIRECTION_BACKWARD_UNSPECIFIED}}(t.pageDirection),n={pageSize:t.pageSize,cursor:t.cursor,direction:r},i=t.contentTopics.map((function(e){return{contentTopic:e}}));return new e({requestId:l.v4(),query:{pubSubTopic:t.pubSubTopic,contentFilters:i,pagingInfo:n,startTime:t.startTime,endTime:t.endTime},response:void 0})}},{key:"decode",value:function(t){return new e(d.HistoryRPC.decode(c.Reader.create(t)))}}]),e}();t.HistoryRPC=f},918:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryRPC=t.HistoryResponse=t.HistoryQuery=t.ContentFilter=t.PagingInfo_Direction=t.PagingInfo=t.Index=t.WakuMessage=void 0;var n=r(188);Object.defineProperty(t,"WakuMessage",{enumerable:!0,get:function(){return n.WakuMessage}});var i=r(268);Object.defineProperty(t,"Index",{enumerable:!0,get:function(){return i.Index}}),Object.defineProperty(t,"PagingInfo",{enumerable:!0,get:function(){return i.PagingInfo}}),Object.defineProperty(t,"PagingInfo_Direction",{enumerable:!0,get:function(){return i.PagingInfo_Direction}}),Object.defineProperty(t,"ContentFilter",{enumerable:!0,get:function(){return i.ContentFilter}}),Object.defineProperty(t,"HistoryQuery",{enumerable:!0,get:function(){return i.HistoryQuery}}),Object.defineProperty(t,"HistoryResponse",{enumerable:!0,get:function(){return i.HistoryResponse}}),Object.defineProperty(t,"HistoryRPC",{enumerable:!0,get:function(){return i.HistoryRPC}})},930:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),o=r(37),s=r.n(o),a=(r(474),r(58)),u=(r(278),r(475),r(476),r(980)),c=r(981),l=r(982),d=r(207),f=r(460),p=r(934),v=r(979),g=r(205),b=r(978),h=r(983),y=r(458),m=r.n(y),P=r(1),O=r.n(P),k=r(36),T=r(932),S=r(197),R=r(128),j=r(66),_=r(18);function w(e){var t=e.encryptionPublicKey,r=e.address,n=e.waku,i=e.providerRequest;return Object(_.jsx)(T.a,{variant:"contained",color:"primary",onClick:function(){t&&r&&n&&i&&(console.log("Creating Public Key Message"),Object(S.a)(r,t,i).then((function(e){console.log("Public Key Message created"),function(e){return I.apply(this,arguments)}(e).then((function(e){console.log("Public Key Message encoded"),n.lightPush.push(e).then((function(e){return console.log("Public Key Message pushed",e)})).catch((function(e){console.error("Failed to send Public Key Message",e)}))})).catch((function(){console.log("Failed to encode Public Key Message in Waku Message")}))})).catch((function(e){console.error("Failed to create public key message",e)})))},disabled:!t||!n||!r||!i,children:"Broadcast Encryption Public Key"})}function I(){return(I=Object(k.a)(O.a.mark((function e(t){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.encode(),e.next=3,R.WakuMessage.fromBytes(r,j.b);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=r(973),D=r(933),E=r(974);function N(e){var t=e.messages;return Object(_.jsx)(x.a,{dense:!0,children:C(t)})}function C(e){return e.map((function(e){var t="<".concat(A(e.timestamp),"> ").concat(e.text);return Object(_.jsx)(D.a,{children:Object(_.jsx)(E.a,{primary:t},A(e.timestamp))})}))}function A(e){return e.toLocaleString([],{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!1})}var K=r(453),M=Object(p.a)({root:{display:"flex",alignItems:"left",flexDirection:"column",margin:"5px"}});function B(e){var t=e.waku,r=e.recipients,n=e.messages,i=M();return Object(_.jsxs)("div",{className:i.root,children:[Object(_.jsx)(K.a,{recipients:r,waku:t}),Object(_.jsx)(N,{messages:n})]})}var q=r(454),F=r(459);function W(e){var t=e.setAddress,r=e.setProvider;return Object(_.jsx)(T.a,{variant:"contained",color:"primary",onClick:function(){try{window.ethereum.request({method:"eth_requestAccounts"}).then((function(e){var n=new F.a.providers.Web3Provider(window.ethereum);t(e[0]),r(n)}))}catch(e){console.error("No web3 provider available")}},children:"Connect Wallet"})}var H=Object(f.a)({palette:{primary:{main:g.a[500]},secondary:{main:b.a[600]}}}),J=Object(p.a)({root:{textAlign:"center",display:"flex",flexDirection:"column",minHeight:"100vh"},appBar:{},container:{display:"flex",flex:1},main:{flex:1,margin:"10px"},wakuStatus:{marginRight:H.spacing(2)},title:{flexGrow:1},peers:{}});var z=function(){var e,t,r,i=Object(n.useState)(),o=Object(a.a)(i,2),s=o[0],f=o[1],p=Object(n.useState)(),g=Object(a.a)(p,2),b=g[0],y=g[1],P=Object(n.useState)(),O=Object(a.a)(P,2),k=O[0],T=O[1],S=Object(n.useState)(new Map),R=Object(a.a)(S,2),I=R[0],x=R[1],D=Object(n.useState)([]),E=Object(a.a)(D,2),N=E[0],C=E[1],A=Object(n.useState)(),K=Object(a.a)(A,2),M=K[0],F=K[1],z=Object(n.useState)({relayPeers:0,lightPushPeers:0}),U=Object(a.a)(z,2),L=U[0],G=U[1],V=J();Object(n.useEffect)((function(){s||Object(j.e)().then((function(e){console.log("waku: ready"),f(e)})).catch((function(e){console.error("Failed to initiate Waku",e)}))}),[s]),Object(n.useEffect)((function(){if(s){var e=j.d.bind({},M,x);return s.relay.addObserver(e,[j.b]),function(){s&&s.relay.deleteObserver(e,[j.b])}}}),[s,M]),Object(n.useEffect)((function(){var e;if(s&&M&&(null===b||void 0===b||null===(e=b.provider)||void 0===e?void 0:e.request)){var t=j.c.bind({},C,M,b.provider.request);return s.relay.addObserver(t,[j.a]),function(){s&&t&&s.relay.deleteObserver(t,[j.a])}}}),[s,M,null===b||void 0===b||null===(e=b.provider)||void 0===e?void 0:e.request]),Object(n.useEffect)((function(){if(s){var e=setInterval((function(){G({relayPeers:s.relay.getPeers().size,lightPushPeers:s.lightPush.peers.length})}),1e3);return function(){return clearInterval(e)}}}),[s]);var Q="";return M&&(Q=M.substr(0,6)+"..."+M.substr(M.length-4,4)),Object(_.jsx)(v.a,{theme:H,children:Object(_.jsxs)("div",{className:V.root,children:[Object(_.jsx)(u.a,{className:V.appBar,position:"static",children:Object(_.jsxs)(c.a,{children:[Object(_.jsx)(l.a,{edge:"start",className:V.wakuStatus,"aria-label":"waku-status",children:Object(_.jsx)(m.a,{color:s?void 0:"disabled",style:s?{color:h.a[500]}:{}})}),Object(_.jsxs)(d.a,{className:V.peers,"aria-label":"connected-peers",children:["Peers: ",L.relayPeers," relay, ",L.lightPushPeers," ","light push"]}),Object(_.jsx)(d.a,{variant:"h6",className:V.title,children:"Ethereum Private Message with Wallet Encryption"}),Object(_.jsx)(d.a,{children:Q})]})}),Object(_.jsx)("div",{className:V.container,children:Object(_.jsxs)("main",{className:V.main,children:[Object(_.jsxs)("fieldset",{children:[Object(_.jsx)("legend",{children:"Wallet"}),Object(_.jsx)(W,{setProvider:y,setAddress:F})]}),Object(_.jsxs)("fieldset",{children:[Object(_.jsx)("legend",{children:"Encryption Keys"}),Object(_.jsx)(q.a,{setEncPublicKey:T,providerRequest:null===b||void 0===b||null===(t=b.provider)||void 0===t?void 0:t.request,address:M}),Object(_.jsx)(w,{address:M,encryptionPublicKey:k,waku:s,providerRequest:null===b||void 0===b||null===(r=b.provider)||void 0===r?void 0:r.request})]}),Object(_.jsxs)("fieldset",{children:[Object(_.jsx)("legend",{children:"Messaging"}),Object(_.jsx)(B,{recipients:I,waku:s,messages:N})]})]})})]})})};s.a.render(Object(_.jsx)(i.a.StrictMode,{children:Object(_.jsx)(z,{})}),document.getElementById("root"))}},[[930,1,2]]]);
//# sourceMappingURL=main.18acd360.chunk.js.map